{"ast":null,"code":"import React,{useState,useEffect,useRef,useCallback}from'react';// @ts-ignore - Fabric.js import\nimport*as fabric from'fabric';import toast from'react-hot-toast';// Import modular components\nimport Toolbar from'./editor/Toolbar';import PropertiesPanel from'./editor/PropertiesPanel';import LayersPanel from'./editor/LayersPanel';import Canvas from'./editor/Canvas';import AIModal from'./editor/AIModal';import PlaceholderSystem from'./editor/PlaceholderSystem';import TemplateCategories from'./editor/TemplateCategories';import BrandAssignment from'./editor/BrandAssignment';import DataBindingSystem from'./editor/DataBindingSystem';import TemplatePreview from'./editor/TemplatePreview';import UsageGuide from'./editor/UsageGuide';import AdvancedTools from'./editor/AdvancedTools';import{aiTemplateService}from'../../services/aiTemplateService';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const CanvaLikeEditor=_ref=>{let{initialTemplate,onSave,onClose}=_ref;// Canvas state\nconst[canvas,setCanvas]=useState(null);const[selectedObject,setSelectedObject]=useState(null);const[layers,setLayers]=useState([]);// Tool states\nconst[activeTool,setActiveTool]=useState('select');const[zoom,setZoom]=useState(1);// Object properties\nconst[textColor,setTextColor]=useState('#000000');const[fillColor,setFillColor]=useState('#3B82F6');const[strokeColor,setStrokeColor]=useState('#000000');const[strokeWidth,setStrokeWidth]=useState(2);const[fontSize,setFontSize]=useState(24);const[fontFamily,setFontFamily]=useState('Arial');const[opacity,setOpacity]=useState(1);const[rotation,setRotation]=useState(0);const[scaleX,setScaleX]=useState(1);const[scaleY,setScaleY]=useState(1);// Shadow properties\nconst[shadowColor,setShadowColor]=useState('#000000');const[shadowBlur,setShadowBlur]=useState(0);const[shadowOffsetX,setShadowOffsetX]=useState(0);const[shadowOffsetY,setShadowOffsetY]=useState(0);// Border properties\nconst[borderRadius,setBorderRadius]=useState(0);// Template state\nconst[templateName,setTemplateName]=useState('Yeni Åžablon');// History for undo/redo\nconst[history,setHistory]=useState([]);const[historyIndex,setHistoryIndex]=useState(-1);// AI state\nconst[showAIModal,setShowAIModal]=useState(false);const[isAIGenerating,setIsAIGenerating]=useState(false);// Usage guide state\nconst[showUsageGuide,setShowUsageGuide]=useState(false);// Template system state\nconst[activePanel,setActivePanel]=useState('layers');const[selectedCategory,setSelectedCategory]=useState('ecommerce');const[selectedSubcategory,setSelectedSubcategory]=useState('');const[placeholders,setPlaceholders]=useState([]);const[selectedBrands,setSelectedBrands]=useState([]);const[previewData,setPreviewData]=useState({});const[templateId,setTemplateId]=useState(\"template-\".concat(Date.now()));// Auto-save\nconst autoSaveIntervalRef=useRef(undefined);// Canvas dimensions\nconst canvasWidth=720;const canvasHeight=1280;// Initialize canvas\nconst handleCanvasReady=useCallback(fabricCanvas=>{setCanvas(fabricCanvas);saveToHistory(fabricCanvas);},[]);// Save to history for undo/redo\nconst saveToHistory=useCallback(fabricCanvas=>{const state=JSON.stringify(fabricCanvas.toJSON());setHistory(prev=>{const newHistory=prev.slice(0,historyIndex+1);newHistory.push(state);return newHistory.slice(-50);// Keep last 50 states\n});setHistoryIndex(prev=>prev+1);},[historyIndex]);// Update layers when canvas changes\nconst updateLayers=useCallback(fabricCanvas=>{const objects=fabricCanvas.getObjects();const newLayers=objects.map((obj,index)=>({id:obj.id||\"layer-\".concat(index),name:obj.name||\"\".concat(obj.type,\" \").concat(index+1),type:obj.type||'unknown',visible:obj.visible!==false,locked:obj.selectable===false,opacity:obj.opacity||1,order:index}));setLayers(newLayers);},[]);// Handle object selection\nconst handleObjectSelect=useCallback(object=>{setSelectedObject(object);if(object){setTextColor(object.fill||'#000000');setFillColor(object.fill||'#3B82F6');setStrokeColor(object.stroke||'#000000');setStrokeWidth(object.strokeWidth||2);setFontSize(object.fontSize||24);setFontFamily(object.fontFamily||'Arial');setOpacity(object.opacity||1);setRotation(object.angle||0);setScaleX(object.scaleX||1);setScaleY(object.scaleY||1);}},[]);const handleObjectDeselect=useCallback(()=>{setSelectedObject(null);},[]);const handleObjectModified=useCallback(()=>{if(canvas){updateLayers(canvas);saveToHistory(canvas);}},[canvas,updateLayers,saveToHistory]);const handleObjectAdded=useCallback(()=>{if(canvas){updateLayers(canvas);saveToHistory(canvas);}},[canvas,updateLayers,saveToHistory]);const handleObjectRemoved=useCallback(()=>{if(canvas){updateLayers(canvas);saveToHistory(canvas);}},[canvas,updateLayers,saveToHistory]);// Toolbar handlers\nconst handleSave=useCallback(()=>{if(!canvas)return;const templateData={name:templateName,canvas_data:canvas.toJSON(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()};onSave===null||onSave===void 0?void 0:onSave(templateData);toast.success('Åžablon kaydedildi!');},[canvas,templateName,onSave]);const handleCanvasExport=useCallback(()=>{if(!canvas)return;const dataURL=canvas.toDataURL({format:'png',quality:1,multiplier:2});const link=document.createElement('a');link.download=\"\".concat(templateName,\".png\");link.href=dataURL;link.click();toast.success('Åžablon dÄ±ÅŸa aktarÄ±ldÄ±!');},[canvas,templateName]);const handleUndo=useCallback(()=>{if(historyIndex>0&&canvas){const newIndex=historyIndex-1;setHistoryIndex(newIndex);canvas.loadFromJSON(history[newIndex],()=>{canvas.renderAll();updateLayers(canvas);});}},[historyIndex,history,canvas,updateLayers]);const handleRedo=useCallback(()=>{if(historyIndex<history.length-1&&canvas){const newIndex=historyIndex+1;setHistoryIndex(newIndex);canvas.loadFromJSON(history[newIndex],()=>{canvas.renderAll();updateLayers(canvas);});}},[historyIndex,history,canvas,updateLayers]);const handleZoomIn=useCallback(()=>{setZoom(prev=>Math.min(prev*1.2,5));},[]);const handleZoomOut=useCallback(()=>{setZoom(prev=>Math.max(prev/1.2,0.1));},[]);const handleDelete=useCallback(()=>{if(canvas&&selectedObject){canvas.remove(selectedObject);canvas.renderAll();setSelectedObject(null);}},[canvas,selectedObject]);const handleCopy=useCallback(async()=>{if(canvas&&selectedObject){try{const cloned=await selectedObject.clone();cloned.set({left:(selectedObject.left||0)+20,top:(selectedObject.top||0)+20});canvas.add(cloned);canvas.setActiveObject(cloned);canvas.renderAll();}catch(error){console.error('Copy error:',error);}}},[canvas,selectedObject]);// AI handlers\nconst handleAIGenerate=useCallback(()=>{setShowAIModal(true);},[]);const handleAIGenerateTemplate=useCallback(async(prompt,style)=>{setIsAIGenerating(true);setShowAIModal(false);try{const result=await aiTemplateService.generateTemplate({prompt,style});if(result.success&&result.template&&canvas){// AI template'i canvas'a yÃ¼kle\ncanvas.loadFromJSON(result.template.canvas_data,()=>{canvas.renderAll();updateLayers(canvas);setTemplateName(result.template.name);toast.success('AI ÅŸablonu baÅŸarÄ±yla oluÅŸturuldu!');});}else{toast.error(result.error||'AI ÅŸablonu oluÅŸturulamadÄ±');}}catch(error){console.error('AI generation error:',error);toast.error('AI servisi hatasÄ±');}finally{setIsAIGenerating(false);}},[canvas,updateLayers]);// Property change handlers\nconst handlePropertyChange=useCallback((property,value)=>{if(selectedObject&&canvas){selectedObject[property]=value;canvas.renderAll();}},[selectedObject,canvas]);const handleColorChange=useCallback((type,color)=>{if(selectedObject&&canvas){if(type==='text'||type==='fill'){selectedObject.set('fill',color);setTextColor(color);setFillColor(color);}else if(type==='stroke'){selectedObject.set('stroke',color);setStrokeColor(color);}canvas.renderAll();}},[selectedObject,canvas]);const handleFontSizeChange=useCallback(size=>{if(selectedObject&&canvas){selectedObject.set('fontSize',size);setFontSize(size);canvas.renderAll();}},[selectedObject,canvas]);const handleFontFamilyChange=useCallback(family=>{if(selectedObject&&canvas){selectedObject.set('fontFamily',family);setFontFamily(family);canvas.renderAll();}},[selectedObject,canvas]);const handleOpacityChange=useCallback(opacity=>{if(selectedObject&&canvas){selectedObject.set('opacity',opacity);setOpacity(opacity);canvas.renderAll();}},[selectedObject,canvas]);const handleRotationChange=useCallback(rotation=>{if(selectedObject&&canvas){selectedObject.set('angle',rotation);setRotation(rotation);canvas.renderAll();}},[selectedObject,canvas]);const handleScaleChange=useCallback((scaleX,scaleY)=>{if(selectedObject&&canvas){selectedObject.set('scaleX',scaleX);selectedObject.set('scaleY',scaleY);setScaleX(scaleX);setScaleY(scaleY);canvas.renderAll();}},[selectedObject,canvas]);// Shadow handlers\nconst handleShadowChange=useCallback((property,value)=>{if(selectedObject&&canvas){selectedObject.set(property,value);canvas.renderAll();}},[selectedObject,canvas]);// Border radius handler\nconst handleBorderRadiusChange=useCallback(radius=>{if(selectedObject&&canvas){selectedObject.set('rx',radius);selectedObject.set('ry',radius);setBorderRadius(radius);canvas.renderAll();}},[selectedObject,canvas]);// Layer handlers\nconst handleLayerSelect=useCallback(layerId=>{if(canvas){const object=canvas.getObjects().find(obj=>(obj.id||'')===layerId);if(object){canvas.setActiveObject(object);canvas.renderAll();}}},[canvas]);const handleLayerToggleVisibility=useCallback(layerId=>{if(canvas){const object=canvas.getObjects().find(obj=>(obj.id||'')===layerId);if(object){object.set('visible',!object.visible);canvas.renderAll();updateLayers(canvas);}}},[canvas,updateLayers]);const handleLayerToggleLock=useCallback(layerId=>{if(canvas){const object=canvas.getObjects().find(obj=>(obj.id||'')===layerId);if(object){object.set('selectable',object.selectable===false);canvas.renderAll();updateLayers(canvas);}}},[canvas,updateLayers]);const handleLayerDelete=useCallback(layerId=>{if(canvas){const object=canvas.getObjects().find(obj=>(obj.id||'')===layerId);if(object){canvas.remove(object);canvas.renderAll();updateLayers(canvas);}}},[canvas,updateLayers]);const handleLayerDuplicate=useCallback(async layerId=>{if(canvas){const object=canvas.getObjects().find(obj=>(obj.id||'')===layerId);if(object){try{const cloned=await object.clone();cloned.set({left:(object.left||0)+20,top:(object.top||0)+20});canvas.add(cloned);canvas.renderAll();updateLayers(canvas);}catch(error){console.error('Duplicate error:',error);}}}},[canvas,updateLayers]);const handleLayerMoveUp=useCallback(layerId=>{if(canvas){const object=canvas.getObjects().find(obj=>(obj.id||'')===layerId);if(object){object.bringForward();canvas.renderAll();updateLayers(canvas);}}},[canvas,updateLayers]);const handleLayerMoveDown=useCallback(layerId=>{if(canvas){const object=canvas.getObjects().find(obj=>(obj.id||'')===layerId);if(object){object.sendBackwards();canvas.renderAll();updateLayers(canvas);}}},[canvas,updateLayers]);const handleLayerRename=useCallback((layerId,newName)=>{if(canvas){const object=canvas.getObjects().find(obj=>(obj.id||'')===layerId);if(object){object.name=newName;updateLayers(canvas);}}},[canvas,updateLayers]);// Template system handlers\nconst handleCategorySelect=useCallback(categoryId=>{setSelectedCategory(categoryId);setActivePanel('categories');},[]);const handleSubcategorySelect=useCallback(subcategory=>{setSelectedSubcategory(subcategory);toast.success(\"\".concat(subcategory,\" alt kategorisi se\\xE7ildi\"));},[]);const handlePlaceholderAdd=useCallback(placeholder=>{setPlaceholders(prev=>[...prev,placeholder]);toast.success('Placeholder eklendi');},[]);const handlePlaceholderEdit=useCallback((id,placeholder)=>{setPlaceholders(prev=>prev.map(p=>p.id===id?placeholder:p));toast.success('Placeholder gÃ¼ncellendi');},[]);const handlePlaceholderDelete=useCallback(id=>{setPlaceholders(prev=>prev.filter(p=>p.id!==id));toast.success('Placeholder silindi');},[]);const handleBrandSelect=useCallback(brandIds=>{setSelectedBrands(brandIds);},[]);const handleTemplateAssign=useCallback((templateId,brandIds)=>{toast.success(\"\\u015Eablon \".concat(brandIds.length,\" markaya atand\\u0131\"));},[]);const handleDataChange=useCallback(data=>{setPreviewData(data);},[]);const handlePreview=useCallback(data=>{setPreviewData(data);setActivePanel('preview');},[]);const handleExport=useCallback(format=>{toast.success(\"\".concat(format.toUpperCase(),\" format\\u0131nda d\\u0131\\u015Fa aktar\\u0131ld\\u0131\"));},[]);const handleShare=useCallback(()=>{toast.success('PaylaÅŸÄ±labilir link oluÅŸturuldu');},[]);// Keyboard shortcuts\nuseEffect(()=>{const handleKeyDown=e=>{// Prevent default browser shortcuts when canvas is focused\nif(e.ctrlKey||e.metaKey){switch(e.key.toLowerCase()){case'z':e.preventDefault();if(e.shiftKey){handleRedo();}else{handleUndo();}break;case'a':e.preventDefault();if(canvas){canvas.discardActiveObject();canvas.setActiveObject(new fabric.ActiveSelection(canvas.getObjects(),{canvas:canvas}));canvas.requestRenderAll();}break;case's':e.preventDefault();handleSave();break;case'c':e.preventDefault();handleCopy();break;case'v':e.preventDefault();// Paste functionality would go here\nbreak;}}else if(e.key==='Delete'||e.key==='Backspace'){e.preventDefault();if(canvas&&canvas.getActiveObject()){const activeObject=canvas.getActiveObject();if(activeObject){canvas.remove(activeObject);canvas.requestRenderAll();updateLayers(canvas);if(canvas)saveToHistory(canvas);}}}};document.addEventListener('keydown',handleKeyDown);return()=>{document.removeEventListener('keydown',handleKeyDown);};},[canvas,handleUndo,handleRedo,handleSave,handleCopy,updateLayers,saveToHistory]);// Auto-save\nuseEffect(()=>{if(canvas){autoSaveIntervalRef.current=setInterval(()=>{const templateData={name:templateName,canvas_data:canvas.toJSON(),auto_saved:true};localStorage.setItem('template_draft',JSON.stringify(templateData));},30000);// Auto-save every 30 seconds\n}return()=>{if(autoSaveIntervalRef.current){clearInterval(autoSaveIntervalRef.current);}};},[canvas,templateName]);// Load initial template\nuseEffect(()=>{if(initialTemplate&&canvas){canvas.loadFromJSON(initialTemplate.canvas_data,()=>{canvas.renderAll();updateLayers(canvas);});setTemplateName(initialTemplate.name||'Yeni Åžablon');}},[initialTemplate,canvas,updateLayers]);return/*#__PURE__*/_jsxs(\"div\",{className:\"h-screen flex flex-col bg-gray-50\",children:[/*#__PURE__*/_jsx(Toolbar,{activeTool:activeTool,onToolChange:setActiveTool,onSave:handleSave,onExport:handleCanvasExport,onUndo:handleUndo,onRedo:handleRedo,onZoomIn:handleZoomIn,onZoomOut:handleZoomOut,onDelete:handleDelete,onCopy:handleCopy,onAIGenerate:handleAIGenerate,onShowUsageGuide:()=>setShowUsageGuide(true),zoom:zoom,canUndo:historyIndex>0,canRedo:historyIndex<history.length-1,hasSelection:!!selectedObject}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 flex overflow-hidden\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-12 bg-gray-100 border-r border-gray-200 flex flex-col\",children:[{id:'layers',label:'Katmanlar',icon:'ðŸ“„'},{id:'categories',label:'Kategoriler',icon:'ðŸ“'},{id:'placeholders',label:'Alanlar',icon:'ðŸ”—'},{id:'brands',label:'Markalar',icon:'ðŸ¢'},{id:'data',label:'Veri',icon:'ðŸ“Š'},{id:'preview',label:'Ã–nizleme',icon:'ðŸ‘ï¸'},{id:'advanced',label:'GeliÅŸmiÅŸ',icon:'ðŸŽ¨'}].map(panel=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActivePanel(panel.id),className:\"p-3 border-b border-gray-200 hover:bg-gray-200 transition-colors \".concat(activePanel===panel.id?'bg-blue-100 text-blue-700':'text-gray-600'),title:panel.label,children:/*#__PURE__*/_jsx(\"span\",{className:\"text-lg\",children:panel.icon})},panel.id))}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-80\",children:[activePanel==='layers'&&/*#__PURE__*/_jsx(LayersPanel,{layers:layers,selectedLayerId:selectedObject?selectedObject.id||null:null,onLayerSelect:handleLayerSelect,onLayerToggleVisibility:handleLayerToggleVisibility,onLayerToggleLock:handleLayerToggleLock,onLayerDelete:handleLayerDelete,onLayerDuplicate:handleLayerDuplicate,onLayerMoveUp:handleLayerMoveUp,onLayerMoveDown:handleLayerMoveDown,onLayerRename:handleLayerRename}),activePanel==='categories'&&/*#__PURE__*/_jsx(TemplateCategories,{selectedCategory:selectedCategory,onCategorySelect:handleCategorySelect,onSubcategorySelect:handleSubcategorySelect}),activePanel==='placeholders'&&/*#__PURE__*/_jsx(PlaceholderSystem,{onAddPlaceholder:handlePlaceholderAdd,onEditPlaceholder:handlePlaceholderEdit,onDeletePlaceholder:handlePlaceholderDelete,placeholders:placeholders}),activePanel==='brands'&&/*#__PURE__*/_jsx(BrandAssignment,{selectedBrands:selectedBrands,onBrandSelect:handleBrandSelect,onTemplateAssign:handleTemplateAssign,templateId:templateId}),activePanel==='data'&&/*#__PURE__*/_jsx(DataBindingSystem,{templateId:templateId,onDataChange:handleDataChange,onPreview:handlePreview}),activePanel==='preview'&&/*#__PURE__*/_jsx(TemplatePreview,{templateData:initialTemplate,previewData:previewData,onExport:handleExport,onShare:handleShare}),activePanel==='advanced'&&/*#__PURE__*/_jsx(AdvancedTools,{onToolSelect:setActiveTool,onColorChange:color=>handleColorChange('fill',color),onGradientChange:gradient=>console.log('Gradient:',gradient),onFilterApply:filter=>console.log('Filter:',filter),onTransform:transform=>console.log('Transform:',transform),onEffectApply:effect=>console.log('Effect:',effect)})]})]}),/*#__PURE__*/_jsx(Canvas,{width:canvasWidth,height:canvasHeight,backgroundColor:\"#ffffff\",zoom:zoom,onObjectSelect:handleObjectSelect,onObjectDeselect:handleObjectDeselect,onObjectModified:handleObjectModified,onObjectAdded:handleObjectAdded,onObjectRemoved:handleObjectRemoved,activeTool:activeTool,onCanvasReady:handleCanvasReady,initialData:initialTemplate===null||initialTemplate===void 0?void 0:initialTemplate.canvas_data}),/*#__PURE__*/_jsx(PropertiesPanel,{selectedObject:selectedObject,activeTool:activeTool,onPropertyChange:handlePropertyChange,textColor:textColor,fillColor:fillColor,strokeColor:strokeColor,strokeWidth:strokeWidth,fontSize:fontSize,fontFamily:fontFamily,opacity:opacity,rotation:rotation,scaleX:scaleX,scaleY:scaleY,onColorChange:handleColorChange,onFontSizeChange:handleFontSizeChange,onFontFamilyChange:handleFontFamilyChange,onOpacityChange:handleOpacityChange,onRotationChange:handleRotationChange,onScaleChange:handleScaleChange,shadowColor:shadowColor,shadowBlur:shadowBlur,shadowOffsetX:shadowOffsetX,shadowOffsetY:shadowOffsetY,borderRadius:borderRadius,onShadowChange:handleShadowChange,onBorderRadiusChange:handleBorderRadiusChange})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white border-t border-gray-200 px-4 py-2\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-sm font-medium text-gray-700\",children:\"\\u015Eablon Ad\\u0131:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:templateName,onChange:e=>setTemplateName(e.target.value),className:\"flex-1 px-3 py-1 border border-gray-300 rounded text-sm\",placeholder:\"\\u015Eablon ad\\u0131n\\u0131 girin...\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"px-4 py-1 text-sm text-gray-600 hover:text-gray-800\",children:\"Kapat\"})]})}),/*#__PURE__*/_jsx(AIModal,{isOpen:showAIModal,onClose:()=>setShowAIModal(false),onGenerate:handleAIGenerateTemplate,isGenerating:isAIGenerating}),showUsageGuide&&/*#__PURE__*/_jsx(UsageGuide,{onClose:()=>setShowUsageGuide(false)})]});};export default CanvaLikeEditor;","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","fabric","toast","Toolbar","PropertiesPanel","LayersPanel","Canvas","AIModal","PlaceholderSystem","TemplateCategories","BrandAssignment","DataBindingSystem","TemplatePreview","UsageGuide","AdvancedTools","aiTemplateService","jsx","_jsx","jsxs","_jsxs","CanvaLikeEditor","_ref","initialTemplate","onSave","onClose","canvas","setCanvas","selectedObject","setSelectedObject","layers","setLayers","activeTool","setActiveTool","zoom","setZoom","textColor","setTextColor","fillColor","setFillColor","strokeColor","setStrokeColor","strokeWidth","setStrokeWidth","fontSize","setFontSize","fontFamily","setFontFamily","opacity","setOpacity","rotation","setRotation","scaleX","setScaleX","scaleY","setScaleY","shadowColor","setShadowColor","shadowBlur","setShadowBlur","shadowOffsetX","setShadowOffsetX","shadowOffsetY","setShadowOffsetY","borderRadius","setBorderRadius","templateName","setTemplateName","history","setHistory","historyIndex","setHistoryIndex","showAIModal","setShowAIModal","isAIGenerating","setIsAIGenerating","showUsageGuide","setShowUsageGuide","activePanel","setActivePanel","selectedCategory","setSelectedCategory","selectedSubcategory","setSelectedSubcategory","placeholders","setPlaceholders","selectedBrands","setSelectedBrands","previewData","setPreviewData","templateId","setTemplateId","concat","Date","now","autoSaveIntervalRef","undefined","canvasWidth","canvasHeight","handleCanvasReady","fabricCanvas","saveToHistory","state","JSON","stringify","toJSON","prev","newHistory","slice","push","updateLayers","objects","getObjects","newLayers","map","obj","index","id","name","type","visible","locked","selectable","order","handleObjectSelect","object","fill","stroke","angle","handleObjectDeselect","handleObjectModified","handleObjectAdded","handleObjectRemoved","handleSave","templateData","canvas_data","created_at","toISOString","updated_at","success","handleCanvasExport","dataURL","toDataURL","format","quality","multiplier","link","document","createElement","download","href","click","handleUndo","newIndex","loadFromJSON","renderAll","handleRedo","length","handleZoomIn","Math","min","handleZoomOut","max","handleDelete","remove","handleCopy","cloned","clone","set","left","top","add","setActiveObject","error","console","handleAIGenerate","handleAIGenerateTemplate","prompt","style","result","generateTemplate","template","handlePropertyChange","property","value","handleColorChange","color","handleFontSizeChange","size","handleFontFamilyChange","family","handleOpacityChange","handleRotationChange","handleScaleChange","handleShadowChange","handleBorderRadiusChange","radius","handleLayerSelect","layerId","find","handleLayerToggleVisibility","handleLayerToggleLock","handleLayerDelete","handleLayerDuplicate","handleLayerMoveUp","bringForward","handleLayerMoveDown","sendBackwards","handleLayerRename","newName","handleCategorySelect","categoryId","handleSubcategorySelect","subcategory","handlePlaceholderAdd","placeholder","handlePlaceholderEdit","p","handlePlaceholderDelete","filter","handleBrandSelect","brandIds","handleTemplateAssign","handleDataChange","data","handlePreview","handleExport","toUpperCase","handleShare","handleKeyDown","e","ctrlKey","metaKey","key","toLowerCase","preventDefault","shiftKey","discardActiveObject","ActiveSelection","requestRenderAll","getActiveObject","activeObject","addEventListener","removeEventListener","current","setInterval","auto_saved","localStorage","setItem","clearInterval","className","children","onToolChange","onExport","onUndo","onRedo","onZoomIn","onZoomOut","onDelete","onCopy","onAIGenerate","onShowUsageGuide","canUndo","canRedo","hasSelection","label","icon","panel","onClick","title","selectedLayerId","onLayerSelect","onLayerToggleVisibility","onLayerToggleLock","onLayerDelete","onLayerDuplicate","onLayerMoveUp","onLayerMoveDown","onLayerRename","onCategorySelect","onSubcategorySelect","onAddPlaceholder","onEditPlaceholder","onDeletePlaceholder","onBrandSelect","onTemplateAssign","onDataChange","onPreview","onShare","onToolSelect","onColorChange","onGradientChange","gradient","log","onFilterApply","onTransform","transform","onEffectApply","effect","width","height","backgroundColor","onObjectSelect","onObjectDeselect","onObjectModified","onObjectAdded","onObjectRemoved","onCanvasReady","initialData","onPropertyChange","onFontSizeChange","onFontFamilyChange","onOpacityChange","onRotationChange","onScaleChange","onShadowChange","onBorderRadiusChange","onChange","target","isOpen","onGenerate","isGenerating"],"sources":["C:/Users/ilker/Desktop/aibrands/frontend/src/components/template/CanvaLikeEditor.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback } from 'react';\r\n// @ts-ignore - Fabric.js import\r\nimport * as fabric from 'fabric';\r\nimport toast from 'react-hot-toast';\r\n\r\n// Import modular components\r\nimport Toolbar from './editor/Toolbar';\r\nimport PropertiesPanel from './editor/PropertiesPanel';\r\nimport LayersPanel from './editor/LayersPanel';\r\nimport Canvas from './editor/Canvas';\r\nimport AIModal from './editor/AIModal';\r\nimport PlaceholderSystem from './editor/PlaceholderSystem';\r\nimport TemplateCategories from './editor/TemplateCategories';\r\nimport BrandAssignment from './editor/BrandAssignment';\r\nimport DataBindingSystem from './editor/DataBindingSystem';\r\nimport TemplatePreview from './editor/TemplatePreview';\r\nimport UsageGuide from './editor/UsageGuide';\r\nimport AdvancedTools from './editor/AdvancedTools';\r\nimport { aiTemplateService } from '../../services/aiTemplateService';\r\n\r\ninterface CanvaLikeEditorProps {\r\n  initialTemplate?: any;\r\n  onSave?: (template: any) => void;\r\n  onClose?: () => void;\r\n}\r\n\r\ninterface Layer {\r\n  id: string;\r\n  name: string;\r\n  type: string;\r\n  visible: boolean;\r\n  locked: boolean;\r\n  opacity: number;\r\n  order: number;\r\n}\r\n\r\nconst CanvaLikeEditor: React.FC<CanvaLikeEditorProps> = ({\r\n  initialTemplate,\r\n  onSave,\r\n  onClose\r\n}) => {\r\n  // Canvas state\r\n  const [canvas, setCanvas] = useState<fabric.Canvas | null>(null);\r\n  const [selectedObject, setSelectedObject] = useState<fabric.Object | null>(null);\r\n  const [layers, setLayers] = useState<Layer[]>([]);\r\n  \r\n  // Tool states\r\n  const [activeTool, setActiveTool] = useState<string>('select');\r\n  const [zoom, setZoom] = useState(1);\r\n  \r\n  // Object properties\r\n  const [textColor, setTextColor] = useState('#000000');\r\n  const [fillColor, setFillColor] = useState('#3B82F6');\r\n  const [strokeColor, setStrokeColor] = useState('#000000');\r\n  const [strokeWidth, setStrokeWidth] = useState(2);\r\n  const [fontSize, setFontSize] = useState(24);\r\n  const [fontFamily, setFontFamily] = useState('Arial');\r\n  const [opacity, setOpacity] = useState(1);\r\n  const [rotation, setRotation] = useState(0);\r\n  const [scaleX, setScaleX] = useState(1);\r\n  const [scaleY, setScaleY] = useState(1);\r\n  \r\n  // Shadow properties\r\n  const [shadowColor, setShadowColor] = useState('#000000');\r\n  const [shadowBlur, setShadowBlur] = useState(0);\r\n  const [shadowOffsetX, setShadowOffsetX] = useState(0);\r\n  const [shadowOffsetY, setShadowOffsetY] = useState(0);\r\n  \r\n  // Border properties\r\n  const [borderRadius, setBorderRadius] = useState(0);\r\n  \r\n  // Template state\r\n  const [templateName, setTemplateName] = useState('Yeni Åžablon');\r\n  \r\n  // History for undo/redo\r\n  const [history, setHistory] = useState<string[]>([]);\r\n  const [historyIndex, setHistoryIndex] = useState(-1);\r\n  \r\n  // AI state\r\n  const [showAIModal, setShowAIModal] = useState(false);\r\n  const [isAIGenerating, setIsAIGenerating] = useState(false);\r\n  \r\n  // Usage guide state\r\n  const [showUsageGuide, setShowUsageGuide] = useState(false);\r\n  \r\n  // Template system state\r\n  const [activePanel, setActivePanel] = useState<'layers' | 'categories' | 'placeholders' | 'brands' | 'data' | 'preview' | 'advanced'>('layers');\r\n  const [selectedCategory, setSelectedCategory] = useState('ecommerce');\r\n  const [selectedSubcategory, setSelectedSubcategory] = useState('');\r\n  const [placeholders, setPlaceholders] = useState<any[]>([]);\r\n  const [selectedBrands, setSelectedBrands] = useState<number[]>([]);\r\n  const [previewData, setPreviewData] = useState<Record<string, any>>({});\r\n  const [templateId, setTemplateId] = useState(`template-${Date.now()}`);\r\n  \r\n  // Auto-save\r\n  const autoSaveIntervalRef = useRef<NodeJS.Timeout | undefined>(undefined);\r\n\r\n  // Canvas dimensions\r\n  const canvasWidth = 720;\r\n  const canvasHeight = 1280;\r\n\r\n  // Initialize canvas\r\n  const handleCanvasReady = useCallback((fabricCanvas: fabric.Canvas) => {\r\n    setCanvas(fabricCanvas);\r\n    saveToHistory(fabricCanvas);\r\n  }, []);\r\n\r\n  // Save to history for undo/redo\r\n  const saveToHistory = useCallback((fabricCanvas: fabric.Canvas) => {\r\n    const state = JSON.stringify(fabricCanvas.toJSON());\r\n    setHistory(prev => {\r\n      const newHistory = prev.slice(0, historyIndex + 1);\r\n      newHistory.push(state);\r\n      return newHistory.slice(-50); // Keep last 50 states\r\n    });\r\n    setHistoryIndex(prev => prev + 1);\r\n  }, [historyIndex]);\r\n\r\n  // Update layers when canvas changes\r\n  const updateLayers = useCallback((fabricCanvas: fabric.Canvas) => {\r\n    const objects = fabricCanvas.getObjects();\r\n    const newLayers: Layer[] = objects.map((obj, index) => ({\r\n      id: (obj as any).id || `layer-${index}`,\r\n      name: (obj as any).name || `${obj.type} ${index + 1}`,\r\n      type: obj.type || 'unknown',\r\n      visible: obj.visible !== false,\r\n      locked: obj.selectable === false,\r\n      opacity: obj.opacity || 1,\r\n      order: index\r\n    }));\r\n    setLayers(newLayers);\r\n  }, []);\r\n\r\n  // Handle object selection\r\n  const handleObjectSelect = useCallback((object: any) => {\r\n    setSelectedObject(object);\r\n    if (object) {\r\n      setTextColor(object.fill || '#000000');\r\n      setFillColor(object.fill || '#3B82F6');\r\n      setStrokeColor(object.stroke || '#000000');\r\n      setStrokeWidth(object.strokeWidth || 2);\r\n      setFontSize(object.fontSize || 24);\r\n      setFontFamily(object.fontFamily || 'Arial');\r\n      setOpacity(object.opacity || 1);\r\n      setRotation(object.angle || 0);\r\n      setScaleX(object.scaleX || 1);\r\n      setScaleY(object.scaleY || 1);\r\n    }\r\n  }, []);\r\n\r\n  const handleObjectDeselect = useCallback(() => {\r\n    setSelectedObject(null);\r\n  }, []);\r\n\r\n  const handleObjectModified = useCallback(() => {\r\n    if (canvas) {\r\n      updateLayers(canvas);\r\n      saveToHistory(canvas);\r\n    }\r\n  }, [canvas, updateLayers, saveToHistory]);\r\n\r\n  const handleObjectAdded = useCallback(() => {\r\n    if (canvas) {\r\n      updateLayers(canvas);\r\n      saveToHistory(canvas);\r\n    }\r\n  }, [canvas, updateLayers, saveToHistory]);\r\n\r\n  const handleObjectRemoved = useCallback(() => {\r\n    if (canvas) {\r\n      updateLayers(canvas);\r\n      saveToHistory(canvas);\r\n    }\r\n  }, [canvas, updateLayers, saveToHistory]);\r\n\r\n  // Toolbar handlers\r\n  const handleSave = useCallback(() => {\r\n    if (!canvas) return;\r\n    \r\n    const templateData = {\r\n      name: templateName,\r\n      canvas_data: canvas.toJSON(),\r\n      created_at: new Date().toISOString(),\r\n      updated_at: new Date().toISOString()\r\n    };\r\n    \r\n    onSave?.(templateData);\r\n    toast.success('Åžablon kaydedildi!');\r\n  }, [canvas, templateName, onSave]);\r\n\r\n  const handleCanvasExport = useCallback(() => {\r\n    if (!canvas) return;\r\n    \r\n    const dataURL = canvas.toDataURL({\r\n      format: 'png',\r\n      quality: 1,\r\n      multiplier: 2\r\n    });\r\n    \r\n    const link = document.createElement('a');\r\n    link.download = `${templateName}.png`;\r\n    link.href = dataURL;\r\n    link.click();\r\n    \r\n    toast.success('Åžablon dÄ±ÅŸa aktarÄ±ldÄ±!');\r\n  }, [canvas, templateName]);\r\n\r\n  const handleUndo = useCallback(() => {\r\n    if (historyIndex > 0 && canvas) {\r\n      const newIndex = historyIndex - 1;\r\n      setHistoryIndex(newIndex);\r\n      canvas.loadFromJSON(history[newIndex], () => {\r\n        canvas.renderAll();\r\n        updateLayers(canvas);\r\n      });\r\n    }\r\n  }, [historyIndex, history, canvas, updateLayers]);\r\n\r\n  const handleRedo = useCallback(() => {\r\n    if (historyIndex < history.length - 1 && canvas) {\r\n      const newIndex = historyIndex + 1;\r\n      setHistoryIndex(newIndex);\r\n      canvas.loadFromJSON(history[newIndex], () => {\r\n        canvas.renderAll();\r\n        updateLayers(canvas);\r\n      });\r\n    }\r\n  }, [historyIndex, history, canvas, updateLayers]);\r\n\r\n  const handleZoomIn = useCallback(() => {\r\n    setZoom(prev => Math.min(prev * 1.2, 5));\r\n  }, []);\r\n\r\n  const handleZoomOut = useCallback(() => {\r\n    setZoom(prev => Math.max(prev / 1.2, 0.1));\r\n  }, []);\r\n\r\n  const handleDelete = useCallback(() => {\r\n    if (canvas && selectedObject) {\r\n      canvas.remove(selectedObject);\r\n      canvas.renderAll();\r\n      setSelectedObject(null);\r\n    }\r\n  }, [canvas, selectedObject]);\r\n\r\n  const handleCopy = useCallback(async () => {\r\n    if (canvas && selectedObject) {\r\n      try {\r\n        const cloned = await selectedObject.clone();\r\n        cloned.set({\r\n          left: (selectedObject.left || 0) + 20,\r\n          top: (selectedObject.top || 0) + 20\r\n        });\r\n        canvas.add(cloned);\r\n        canvas.setActiveObject(cloned);\r\n        canvas.renderAll();\r\n      } catch (error) {\r\n        console.error('Copy error:', error);\r\n      }\r\n    }\r\n  }, [canvas, selectedObject]);\r\n\r\n  // AI handlers\r\n  const handleAIGenerate = useCallback(() => {\r\n    setShowAIModal(true);\r\n  }, []);\r\n\r\n  const handleAIGenerateTemplate = useCallback(async (prompt: string, style: string) => {\r\n    setIsAIGenerating(true);\r\n    setShowAIModal(false);\r\n    \r\n    try {\r\n      const result = await aiTemplateService.generateTemplate({ prompt, style });\r\n      \r\n      if (result.success && result.template && canvas) {\r\n        // AI template'i canvas'a yÃ¼kle\r\n        canvas.loadFromJSON(result.template.canvas_data, () => {\r\n          canvas.renderAll();\r\n          updateLayers(canvas);\r\n          setTemplateName(result.template.name);\r\n          toast.success('AI ÅŸablonu baÅŸarÄ±yla oluÅŸturuldu!');\r\n        });\r\n      } else {\r\n        toast.error(result.error || 'AI ÅŸablonu oluÅŸturulamadÄ±');\r\n      }\r\n    } catch (error) {\r\n      console.error('AI generation error:', error);\r\n      toast.error('AI servisi hatasÄ±');\r\n    } finally {\r\n      setIsAIGenerating(false);\r\n    }\r\n  }, [canvas, updateLayers]);\r\n\r\n  // Property change handlers\r\n  const handlePropertyChange = useCallback((property: string, value: any) => {\r\n    if (selectedObject && canvas) {\r\n      (selectedObject as any)[property] = value;\r\n      canvas.renderAll();\r\n    }\r\n  }, [selectedObject, canvas]);\r\n\r\n  const handleColorChange = useCallback((type: 'text' | 'fill' | 'stroke', color: string) => {\r\n    if (selectedObject && canvas) {\r\n      if (type === 'text' || type === 'fill') {\r\n        selectedObject.set('fill', color);\r\n        setTextColor(color);\r\n        setFillColor(color);\r\n      } else if (type === 'stroke') {\r\n        selectedObject.set('stroke', color);\r\n        setStrokeColor(color);\r\n      }\r\n      canvas.renderAll();\r\n    }\r\n  }, [selectedObject, canvas]);\r\n\r\n  const handleFontSizeChange = useCallback((size: number) => {\r\n    if (selectedObject && canvas) {\r\n      selectedObject.set('fontSize', size);\r\n      setFontSize(size);\r\n      canvas.renderAll();\r\n    }\r\n  }, [selectedObject, canvas]);\r\n\r\n  const handleFontFamilyChange = useCallback((family: string) => {\r\n    if (selectedObject && canvas) {\r\n      selectedObject.set('fontFamily', family);\r\n      setFontFamily(family);\r\n      canvas.renderAll();\r\n    }\r\n  }, [selectedObject, canvas]);\r\n\r\n  const handleOpacityChange = useCallback((opacity: number) => {\r\n    if (selectedObject && canvas) {\r\n      selectedObject.set('opacity', opacity);\r\n      setOpacity(opacity);\r\n      canvas.renderAll();\r\n    }\r\n  }, [selectedObject, canvas]);\r\n\r\n  const handleRotationChange = useCallback((rotation: number) => {\r\n    if (selectedObject && canvas) {\r\n      selectedObject.set('angle', rotation);\r\n      setRotation(rotation);\r\n      canvas.renderAll();\r\n    }\r\n  }, [selectedObject, canvas]);\r\n\r\n  const handleScaleChange = useCallback((scaleX: number, scaleY: number) => {\r\n    if (selectedObject && canvas) {\r\n      selectedObject.set('scaleX', scaleX);\r\n      selectedObject.set('scaleY', scaleY);\r\n      setScaleX(scaleX);\r\n      setScaleY(scaleY);\r\n      canvas.renderAll();\r\n    }\r\n  }, [selectedObject, canvas]);\r\n\r\n  // Shadow handlers\r\n  const handleShadowChange = useCallback((property: string, value: any) => {\r\n    if (selectedObject && canvas) {\r\n      selectedObject.set(property, value);\r\n      canvas.renderAll();\r\n    }\r\n  }, [selectedObject, canvas]);\r\n\r\n  // Border radius handler\r\n  const handleBorderRadiusChange = useCallback((radius: number) => {\r\n    if (selectedObject && canvas) {\r\n      selectedObject.set('rx', radius);\r\n      selectedObject.set('ry', radius);\r\n      setBorderRadius(radius);\r\n      canvas.renderAll();\r\n    }\r\n  }, [selectedObject, canvas]);\r\n\r\n  // Layer handlers\r\n  const handleLayerSelect = useCallback((layerId: string) => {\r\n    if (canvas) {\r\n      const object = canvas.getObjects().find(obj => ((obj as any).id || '') === layerId);\r\n      if (object) {\r\n        canvas.setActiveObject(object);\r\n        canvas.renderAll();\r\n      }\r\n    }\r\n  }, [canvas]);\r\n\r\n  const handleLayerToggleVisibility = useCallback((layerId: string) => {\r\n    if (canvas) {\r\n      const object = canvas.getObjects().find(obj => ((obj as any).id || '') === layerId);\r\n      if (object) {\r\n        object.set('visible', !object.visible);\r\n        canvas.renderAll();\r\n        updateLayers(canvas);\r\n      }\r\n    }\r\n  }, [canvas, updateLayers]);\r\n\r\n  const handleLayerToggleLock = useCallback((layerId: string) => {\r\n    if (canvas) {\r\n      const object = canvas.getObjects().find(obj => ((obj as any).id || '') === layerId);\r\n      if (object) {\r\n        object.set('selectable', object.selectable === false);\r\n        canvas.renderAll();\r\n        updateLayers(canvas);\r\n      }\r\n    }\r\n  }, [canvas, updateLayers]);\r\n\r\n  const handleLayerDelete = useCallback((layerId: string) => {\r\n    if (canvas) {\r\n      const object = canvas.getObjects().find(obj => ((obj as any).id || '') === layerId);\r\n      if (object) {\r\n        canvas.remove(object);\r\n        canvas.renderAll();\r\n        updateLayers(canvas);\r\n      }\r\n    }\r\n  }, [canvas, updateLayers]);\r\n\r\n  const handleLayerDuplicate = useCallback(async (layerId: string) => {\r\n    if (canvas) {\r\n      const object = canvas.getObjects().find(obj => ((obj as any).id || '') === layerId);\r\n      if (object) {\r\n        try {\r\n          const cloned = await object.clone();\r\n          cloned.set({\r\n            left: (object.left || 0) + 20,\r\n            top: (object.top || 0) + 20\r\n          });\r\n          canvas.add(cloned);\r\n          canvas.renderAll();\r\n          updateLayers(canvas);\r\n        } catch (error) {\r\n          console.error('Duplicate error:', error);\r\n        }\r\n      }\r\n    }\r\n  }, [canvas, updateLayers]);\r\n\r\n  const handleLayerMoveUp = useCallback((layerId: string) => {\r\n    if (canvas) {\r\n      const object = canvas.getObjects().find(obj => ((obj as any).id || '') === layerId);\r\n      if (object) {\r\n        (object as any).bringForward();\r\n        canvas.renderAll();\r\n        updateLayers(canvas);\r\n      }\r\n    }\r\n  }, [canvas, updateLayers]);\r\n\r\n  const handleLayerMoveDown = useCallback((layerId: string) => {\r\n    if (canvas) {\r\n      const object = canvas.getObjects().find(obj => ((obj as any).id || '') === layerId);\r\n      if (object) {\r\n        (object as any).sendBackwards();\r\n        canvas.renderAll();\r\n        updateLayers(canvas);\r\n      }\r\n    }\r\n  }, [canvas, updateLayers]);\r\n\r\n  const handleLayerRename = useCallback((layerId: string, newName: string) => {\r\n    if (canvas) {\r\n      const object = canvas.getObjects().find(obj => ((obj as any).id || '') === layerId);\r\n      if (object) {\r\n        (object as any).name = newName;\r\n        updateLayers(canvas);\r\n      }\r\n    }\r\n  }, [canvas, updateLayers]);\r\n\r\n  // Template system handlers\r\n  const handleCategorySelect = useCallback((categoryId: string) => {\r\n    setSelectedCategory(categoryId);\r\n    setActivePanel('categories');\r\n  }, []);\r\n\r\n  const handleSubcategorySelect = useCallback((subcategory: string) => {\r\n    setSelectedSubcategory(subcategory);\r\n    toast.success(`${subcategory} alt kategorisi seÃ§ildi`);\r\n  }, []);\r\n\r\n  const handlePlaceholderAdd = useCallback((placeholder: any) => {\r\n    setPlaceholders(prev => [...prev, placeholder]);\r\n    toast.success('Placeholder eklendi');\r\n  }, []);\r\n\r\n  const handlePlaceholderEdit = useCallback((id: string, placeholder: any) => {\r\n    setPlaceholders(prev => prev.map(p => p.id === id ? placeholder : p));\r\n    toast.success('Placeholder gÃ¼ncellendi');\r\n  }, []);\r\n\r\n  const handlePlaceholderDelete = useCallback((id: string) => {\r\n    setPlaceholders(prev => prev.filter(p => p.id !== id));\r\n    toast.success('Placeholder silindi');\r\n  }, []);\r\n\r\n  const handleBrandSelect = useCallback((brandIds: number[]) => {\r\n    setSelectedBrands(brandIds);\r\n  }, []);\r\n\r\n  const handleTemplateAssign = useCallback((templateId: string, brandIds: number[]) => {\r\n    toast.success(`Åžablon ${brandIds.length} markaya atandÄ±`);\r\n  }, []);\r\n\r\n  const handleDataChange = useCallback((data: Record<string, any>) => {\r\n    setPreviewData(data);\r\n  }, []);\r\n\r\n  const handlePreview = useCallback((data: Record<string, any>) => {\r\n    setPreviewData(data);\r\n    setActivePanel('preview');\r\n  }, []);\r\n\r\n  const handleExport = useCallback((format: 'png' | 'jpg' | 'pdf') => {\r\n    toast.success(`${format.toUpperCase()} formatÄ±nda dÄ±ÅŸa aktarÄ±ldÄ±`);\r\n  }, []);\r\n\r\n  const handleShare = useCallback(() => {\r\n    toast.success('PaylaÅŸÄ±labilir link oluÅŸturuldu');\r\n  }, []);\r\n\r\n  // Keyboard shortcuts\r\n  useEffect(() => {\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      // Prevent default browser shortcuts when canvas is focused\r\n      if (e.ctrlKey || e.metaKey) {\r\n        switch (e.key.toLowerCase()) {\r\n          case 'z':\r\n            e.preventDefault();\r\n            if (e.shiftKey) {\r\n              handleRedo();\r\n            } else {\r\n              handleUndo();\r\n            }\r\n            break;\r\n          case 'a':\r\n            e.preventDefault();\r\n            if (canvas) {\r\n              canvas.discardActiveObject();\r\n              canvas.setActiveObject(new fabric.ActiveSelection(canvas.getObjects(), {\r\n                canvas: canvas,\r\n              }));\r\n              canvas.requestRenderAll();\r\n            }\r\n            break;\r\n          case 's':\r\n            e.preventDefault();\r\n            handleSave();\r\n            break;\r\n          case 'c':\r\n            e.preventDefault();\r\n            handleCopy();\r\n            break;\r\n          case 'v':\r\n            e.preventDefault();\r\n            // Paste functionality would go here\r\n            break;\r\n        }\r\n      } else if (e.key === 'Delete' || e.key === 'Backspace') {\r\n        e.preventDefault();\r\n        if (canvas && canvas.getActiveObject()) {\r\n          const activeObject = canvas.getActiveObject();\r\n          if (activeObject) {\r\n            canvas.remove(activeObject);\r\n            canvas.requestRenderAll();\r\n            updateLayers(canvas);\r\n            if (canvas) saveToHistory(canvas);\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    document.addEventListener('keydown', handleKeyDown);\r\n    return () => {\r\n      document.removeEventListener('keydown', handleKeyDown);\r\n    };\r\n  }, [canvas, handleUndo, handleRedo, handleSave, handleCopy, updateLayers, saveToHistory]);\r\n\r\n  // Auto-save\r\n  useEffect(() => {\r\n    if (canvas) {\r\n      autoSaveIntervalRef.current = setInterval(() => {\r\n        const templateData = {\r\n          name: templateName,\r\n          canvas_data: canvas.toJSON(),\r\n          auto_saved: true\r\n        };\r\n        localStorage.setItem('template_draft', JSON.stringify(templateData));\r\n      }, 30000); // Auto-save every 30 seconds\r\n    }\r\n\r\n    return () => {\r\n      if (autoSaveIntervalRef.current) {\r\n        clearInterval(autoSaveIntervalRef.current);\r\n      }\r\n    };\r\n  }, [canvas, templateName]);\r\n\r\n  // Load initial template\r\n  useEffect(() => {\r\n    if (initialTemplate && canvas) {\r\n      canvas.loadFromJSON(initialTemplate.canvas_data, () => {\r\n        canvas.renderAll();\r\n        updateLayers(canvas);\r\n      });\r\n      setTemplateName(initialTemplate.name || 'Yeni Åžablon');\r\n    }\r\n  }, [initialTemplate, canvas, updateLayers]);\r\n\r\n  return (\r\n    <div className=\"h-screen flex flex-col bg-gray-50\">\r\n      {/* Top Toolbar */}\r\n      <Toolbar\r\n        activeTool={activeTool}\r\n        onToolChange={setActiveTool}\r\n        onSave={handleSave}\r\n          onExport={handleCanvasExport}\r\n        onUndo={handleUndo}\r\n        onRedo={handleRedo}\r\n        onZoomIn={handleZoomIn}\r\n        onZoomOut={handleZoomOut}\r\n        onDelete={handleDelete}\r\n        onCopy={handleCopy}\r\n        onAIGenerate={handleAIGenerate}\r\n        onShowUsageGuide={() => setShowUsageGuide(true)}\r\n        zoom={zoom}\r\n        canUndo={historyIndex > 0}\r\n        canRedo={historyIndex < history.length - 1}\r\n        hasSelection={!!selectedObject}\r\n      />\r\n\r\n      {/* Main Content Area */}\r\n      <div className=\"flex-1 flex overflow-hidden\">\r\n        {/* Left Sidebar - Dynamic Panels */}\r\n        <div className=\"flex\">\r\n          {/* Panel Tabs */}\r\n          <div className=\"w-12 bg-gray-100 border-r border-gray-200 flex flex-col\">\r\n            {[\r\n              { id: 'layers', label: 'Katmanlar', icon: 'ðŸ“„' },\r\n              { id: 'categories', label: 'Kategoriler', icon: 'ðŸ“' },\r\n              { id: 'placeholders', label: 'Alanlar', icon: 'ðŸ”—' },\r\n              { id: 'brands', label: 'Markalar', icon: 'ðŸ¢' },\r\n              { id: 'data', label: 'Veri', icon: 'ðŸ“Š' },\r\n              { id: 'preview', label: 'Ã–nizleme', icon: 'ðŸ‘ï¸' },\r\n              { id: 'advanced', label: 'GeliÅŸmiÅŸ', icon: 'ðŸŽ¨' }\r\n            ].map(panel => (\r\n              <button\r\n                key={panel.id}\r\n                onClick={() => setActivePanel(panel.id as any)}\r\n                className={`p-3 border-b border-gray-200 hover:bg-gray-200 transition-colors ${\r\n                  activePanel === panel.id ? 'bg-blue-100 text-blue-700' : 'text-gray-600'\r\n                }`}\r\n                title={panel.label}\r\n              >\r\n                <span className=\"text-lg\">{panel.icon}</span>\r\n              </button>\r\n            ))}\r\n          </div>\r\n\r\n          {/* Panel Content */}\r\n          <div className=\"w-80\">\r\n            {activePanel === 'layers' && (\r\n              <LayersPanel\r\n                layers={layers}\r\n                selectedLayerId={selectedObject ? (selectedObject as any).id || null : null}\r\n                onLayerSelect={handleLayerSelect}\r\n                onLayerToggleVisibility={handleLayerToggleVisibility}\r\n                onLayerToggleLock={handleLayerToggleLock}\r\n                onLayerDelete={handleLayerDelete}\r\n                onLayerDuplicate={handleLayerDuplicate}\r\n                onLayerMoveUp={handleLayerMoveUp}\r\n                onLayerMoveDown={handleLayerMoveDown}\r\n                onLayerRename={handleLayerRename}\r\n              />\r\n            )}\r\n            {activePanel === 'categories' && (\r\n              <TemplateCategories\r\n                selectedCategory={selectedCategory}\r\n                onCategorySelect={handleCategorySelect}\r\n                onSubcategorySelect={handleSubcategorySelect}\r\n              />\r\n            )}\r\n            {activePanel === 'placeholders' && (\r\n              <PlaceholderSystem\r\n                onAddPlaceholder={handlePlaceholderAdd}\r\n                onEditPlaceholder={handlePlaceholderEdit}\r\n                onDeletePlaceholder={handlePlaceholderDelete}\r\n                placeholders={placeholders}\r\n              />\r\n            )}\r\n            {activePanel === 'brands' && (\r\n              <BrandAssignment\r\n                selectedBrands={selectedBrands}\r\n                onBrandSelect={handleBrandSelect}\r\n                onTemplateAssign={handleTemplateAssign}\r\n                templateId={templateId}\r\n              />\r\n            )}\r\n            {activePanel === 'data' && (\r\n              <DataBindingSystem\r\n                templateId={templateId}\r\n                onDataChange={handleDataChange}\r\n                onPreview={handlePreview}\r\n              />\r\n            )}\r\n            {activePanel === 'preview' && (\r\n              <TemplatePreview\r\n                templateData={initialTemplate}\r\n                previewData={previewData}\r\n                onExport={handleExport}\r\n                onShare={handleShare}\r\n              />\r\n            )}\r\n            {activePanel === 'advanced' && (\r\n              <AdvancedTools\r\n                onToolSelect={setActiveTool}\r\n                onColorChange={(color) => handleColorChange('fill', color)}\r\n                onGradientChange={(gradient) => console.log('Gradient:', gradient)}\r\n                onFilterApply={(filter) => console.log('Filter:', filter)}\r\n                onTransform={(transform) => console.log('Transform:', transform)}\r\n                onEffectApply={(effect) => console.log('Effect:', effect)}\r\n              />\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Center - Canvas */}\r\n        <Canvas\r\n          width={canvasWidth}\r\n          height={canvasHeight}\r\n          backgroundColor=\"#ffffff\"\r\n          zoom={zoom}\r\n          onObjectSelect={handleObjectSelect}\r\n          onObjectDeselect={handleObjectDeselect}\r\n          onObjectModified={handleObjectModified}\r\n          onObjectAdded={handleObjectAdded}\r\n          onObjectRemoved={handleObjectRemoved}\r\n          activeTool={activeTool}\r\n          onCanvasReady={handleCanvasReady}\r\n          initialData={initialTemplate?.canvas_data}\r\n        />\r\n\r\n        {/* Right Sidebar - Properties */}\r\n        <PropertiesPanel\r\n          selectedObject={selectedObject}\r\n          activeTool={activeTool}\r\n          onPropertyChange={handlePropertyChange}\r\n          textColor={textColor}\r\n          fillColor={fillColor}\r\n          strokeColor={strokeColor}\r\n          strokeWidth={strokeWidth}\r\n          fontSize={fontSize}\r\n          fontFamily={fontFamily}\r\n          opacity={opacity}\r\n          rotation={rotation}\r\n          scaleX={scaleX}\r\n          scaleY={scaleY}\r\n          onColorChange={handleColorChange}\r\n          onFontSizeChange={handleFontSizeChange}\r\n          onFontFamilyChange={handleFontFamilyChange}\r\n          onOpacityChange={handleOpacityChange}\r\n          onRotationChange={handleRotationChange}\r\n          onScaleChange={handleScaleChange}\r\n          shadowColor={shadowColor}\r\n          shadowBlur={shadowBlur}\r\n          shadowOffsetX={shadowOffsetX}\r\n          shadowOffsetY={shadowOffsetY}\r\n          borderRadius={borderRadius}\r\n          onShadowChange={handleShadowChange}\r\n          onBorderRadiusChange={handleBorderRadiusChange}\r\n        />\r\n      </div>\r\n\r\n      {/* Template Name Input */}\r\n      <div className=\"bg-white border-t border-gray-200 px-4 py-2\">\r\n        <div className=\"flex items-center gap-4\">\r\n          <label className=\"text-sm font-medium text-gray-700\">Åžablon AdÄ±:</label>\r\n          <input\r\n            type=\"text\"\r\n            value={templateName}\r\n            onChange={(e) => setTemplateName(e.target.value)}\r\n            className=\"flex-1 px-3 py-1 border border-gray-300 rounded text-sm\"\r\n            placeholder=\"Åžablon adÄ±nÄ± girin...\"\r\n          />\r\n          <button\r\n            onClick={onClose}\r\n            className=\"px-4 py-1 text-sm text-gray-600 hover:text-gray-800\"\r\n          >\r\n            Kapat\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n                  {/* AI Modal */}\r\n                  <AIModal\r\n                    isOpen={showAIModal}\r\n                    onClose={() => setShowAIModal(false)}\r\n                    onGenerate={handleAIGenerateTemplate}\r\n                    isGenerating={isAIGenerating}\r\n                  />\r\n\r\n                  {/* Usage Guide */}\r\n                  {showUsageGuide && (\r\n                    <UsageGuide\r\n                      onClose={() => setShowUsageGuide(false)}\r\n                    />\r\n                  )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CanvaLikeEditor;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}