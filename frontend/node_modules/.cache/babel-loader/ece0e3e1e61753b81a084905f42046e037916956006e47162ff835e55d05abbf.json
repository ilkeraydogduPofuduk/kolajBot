{"ast":null,"code":"import React,{useState,useEffect,useCallback,useRef}from'react';import{productsAPI}from'../../api/products';import{brandsAPI}from'../../api/brands';import{settingsAPI}from'../../api/settings';import{useUrlConfig}from'../../hooks/useUrlConfig';import MissingFieldsModal from'../../components/modals/MissingFieldsModal';import{Upload,Image as ImageIcon,Eye,Search,Filter,Grid,List,Plus,RefreshCw,CheckCircle,AlertCircle,X}from'lucide-react';import toast from'react-hot-toast';import{notificationService}from'../../services/notificationService';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MediaGallery=()=>{const{getImageURL}=useUrlConfig();const[products,setProducts]=useState([]);const[brands,setBrands]=useState([]);const[filterOptions,setFilterOptions]=useState({product_types:[],colors:[],size_ranges:[]});const[loading,setLoading]=useState(true);const[uploading,setUploading]=useState(false);const[uploadProgress,setUploadProgress]=useState(0);const[uploadStatus,setUploadStatus]=useState('');const[pollingActive,setPollingActive]=useState(false);const pollingActiveRef=useRef(false);// Upload recovery system\nconst[uploadJobId,setUploadJobId]=useState(null);const[uploadRecovery,setUploadRecovery]=useState({isRecovering:false,jobId:null,progress:0});const[uploadLimit,setUploadLimit]=useState(200);// Optimize edildi: 100 -> 200\nconst[maxFileSizeMB,setMaxFileSizeMB]=useState(20);// Optimize edildi: 10 -> 20 MB\nconst[totalUploadSizeMB,setTotalUploadSizeMB]=useState(1000);// Optimize edildi: 500 -> 1000 MB\n// State'leri sessionStorage'dan restore et\nconst[selectedBrand,setSelectedBrand]=useState(()=>{const saved=sessionStorage.getItem('mediaGallery_selectedBrand');return saved?parseInt(saved):null;});const[searchTerm,setSearchTerm]=useState(()=>sessionStorage.getItem('mediaGallery_searchTerm')||'');const[viewMode,setViewMode]=useState(()=>{const saved=sessionStorage.getItem('mediaGallery_viewMode');return saved||'grid';});const[page,setPage]=useState(()=>{const saved=sessionStorage.getItem('mediaGallery_page');return saved?parseInt(saved):1;});// Yeni filtreleme state'leri - çoklu seçim için array\nconst[filterProductType,setFilterProductType]=useState(()=>{const saved=sessionStorage.getItem('mediaGallery_filterProductType');return saved?JSON.parse(saved):[];});const[filterColor,setFilterColor]=useState(()=>{const saved=sessionStorage.getItem('mediaGallery_filterColor');return saved?JSON.parse(saved):[];});const[filterSizeRange,setFilterSizeRange]=useState(()=>{const saved=sessionStorage.getItem('mediaGallery_filterSizeRange');return saved?JSON.parse(saved):[];});// Price filters removed\nconst[filterIncomplete,setFilterIncomplete]=useState(()=>sessionStorage.getItem('mediaGallery_filterIncomplete')==='true');const[filterHasSecondProduct,setFilterHasSecondProduct]=useState(()=>sessionStorage.getItem('mediaGallery_filterHasSecondProduct')==='true');const[filterComplete,setFilterComplete]=useState(()=>sessionStorage.getItem('mediaGallery_filterComplete')==='true');const[showFilters,setShowFilters]=useState(false);// Date grouping states\nconst[groupByDate,setGroupByDate]=useState(()=>sessionStorage.getItem('mediaGallery_groupByDate')==='true');const[dateGroups,setDateGroups]=useState({});const[selectedFiles,setSelectedFiles]=useState([]);const[showUploadModal,setShowUploadModal]=useState(false);const[totalPages,setTotalPages]=useState(1);const[incompleteProducts,setIncompleteProducts]=useState([]);const[showMissingFieldsModal,setShowMissingFieldsModal]=useState(false);const[saving,setSaving]=useState(false);const[apiError,setApiError]=useState(null);// Debounce için timer ref\nconst searchTimerRef=useRef(null);// State değişikliklerini sessionStorage'a kaydet\nuseEffect(()=>{if(selectedBrand)sessionStorage.setItem('mediaGallery_selectedBrand',selectedBrand.toString());sessionStorage.setItem('mediaGallery_searchTerm',searchTerm);sessionStorage.setItem('mediaGallery_viewMode',viewMode);sessionStorage.setItem('mediaGallery_page',page.toString());sessionStorage.setItem('mediaGallery_filterProductType',JSON.stringify(filterProductType));sessionStorage.setItem('mediaGallery_filterColor',JSON.stringify(filterColor));sessionStorage.setItem('mediaGallery_filterSizeRange',JSON.stringify(filterSizeRange));// Price filters removed\nsessionStorage.setItem('mediaGallery_filterIncomplete',filterIncomplete.toString());sessionStorage.setItem('mediaGallery_filterHasSecondProduct',filterHasSecondProduct.toString());sessionStorage.setItem('mediaGallery_filterComplete',filterComplete.toString());sessionStorage.setItem('mediaGallery_groupByDate',groupByDate.toString());},[selectedBrand,searchTerm,viewMode,page,filterProductType,filterColor,filterSizeRange,filterIncomplete,filterHasSecondProduct,filterComplete,groupByDate]);// Upload settings yükle\nconst loadUploadSettings=useCallback(async()=>{try{const settings=await settingsAPI.getSettings();const maxFileCountSetting=settings.settings.find(s=>s.key==='max_file_count');if(maxFileCountSetting){setUploadLimit(parseInt(maxFileCountSetting.value)||100);}const maxFileSizeSetting=settings.settings.find(s=>s.key==='max_file_size_mb');if(maxFileSizeSetting){setMaxFileSizeMB(parseInt(maxFileSizeSetting.value)||10);}const totalUploadSizeSetting=settings.settings.find(s=>s.key==='total_upload_size_mb');if(totalUploadSizeSetting){setTotalUploadSizeMB(parseInt(totalUploadSizeSetting.value)||500);}}catch(error){console.error('Upload settings yüklenemedi:',error);}},[]);// Refresh fonksiyonu - manuel yenileme i�in\nconst refreshProducts=useCallback(async()=>{setLoading(true);try{const filters={};if(filterProductType.length>0)filters.product_type=filterProductType;if(filterColor.length>0)filters.color=filterColor;if(filterSizeRange.length>0)filters.size_range=filterSizeRange;if(filterIncomplete)filters.incomplete=true;if(filterComplete)filters.complete=true;if(filterHasSecondProduct)filters.has_second_product=true;const response=await productsAPI.getProducts(page,20,selectedBrand||undefined,searchTerm||undefined,Object.keys(filters).length>0?filters:undefined);setProducts(response.products);setTotalPages(response.total_pages);setApiError(null);// Group by date if enabled\nif(groupByDate){groupProductsByDate(response.products||[]);}}catch(error){var _error$response,_error$response$data;const detail=error===null||error===void 0?void 0:(_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.detail;const message=detail&&typeof detail==='string'&&detail.trim().length>0?detail:'Urun listesi sunucudan alinirken bir hata olustu (HTTP 500). Lutfen sistem yoneticinize haber verin.';setApiError(message);toast.error('Urunler yuklenirken hata olustu');console.error('Error loading products:',error);}finally{setLoading(false);}},[page,selectedBrand,searchTerm,filterProductType,filterColor,filterSizeRange,filterIncomplete,filterHasSecondProduct,groupByDate]);// Group products by date\nconst groupProductsByDate=useCallback(products=>{const groups={};products.forEach(product=>{if(product.created_at){const date=new Date(product.created_at);const dateKey=date.toLocaleDateString('tr-TR',{year:'numeric',month:'long',day:'numeric'});if(!groups[dateKey]){groups[dateKey]=[];}groups[dateKey].push(product);}});// Sort groups by date (newest first)\nconst sortedGroups={};Object.keys(groups).sort((a,b)=>{const dateA=new Date(groups[a][0].created_at);const dateB=new Date(groups[b][0].created_at);return dateB.getTime()-dateA.getTime();}).forEach(key=>{sortedGroups[key]=groups[key];});setDateGroups(sortedGroups);},[]);const loadBrands=useCallback(async()=>{try{// ✅ Sadece ürünü olan markaları getir\nconst response=await brandsAPI.getBrandsWithProducts();setBrands(response.brands);// ✅ Otomatik marka seçme - kullanıcı manuel seçsin\n// İlk yüklemede tüm ürünleri göster\n}catch(error){toast.error('Markalar yüklenirken hata oluştu');console.error('Error loading brands:',error);}},[]);const loadFilterOptions=useCallback(async()=>{try{const options=await productsAPI.getFilterOptions();setFilterOptions(options);}catch(error){console.error('Error loading filter options:',error);setApiError(prev=>prev!==null&&prev!==void 0?prev:'Filtre se�enekleri sunucudan alinamadi. Lutfen sistem yoneticinize haber verin.');}},[]);const handleRetry=useCallback(()=>{setApiError(null);loadBrands();loadFilterOptions();refreshProducts();},[loadBrands,loadFilterOptions,refreshProducts]);// Upload settings yükle\nuseEffect(()=>{loadUploadSettings();checkForUploadRecovery();},[loadUploadSettings]);// Upload recovery system\nconst checkForUploadRecovery=useCallback(()=>{const savedUploadJob=localStorage.getItem('uploadJobId');const savedUploadProgress=localStorage.getItem('uploadProgress');if(savedUploadJob&&savedUploadProgress){setUploadRecovery({isRecovering:true,jobId:savedUploadJob,progress:parseInt(savedUploadProgress)});// Resume upload monitoring\nresumeUploadMonitoring(savedUploadJob);}},[]);const resumeUploadMonitoring=useCallback(async jobId=>{try{setUploading(true);setUploadProgress(parseInt(localStorage.getItem('uploadProgress')||'0'));setUploadStatus('Yükleme devam ediyor...');// Start polling for upload status\nconst interval=setInterval(async()=>{try{const response=await fetch(\"/api/upload/status/\".concat(jobId));const data=await response.json();if(data.status==='completed'){clearInterval(interval);setUploading(false);setUploadProgress(100);setUploadStatus('Yükleme tamamlandı!');// Clear recovery data\nlocalStorage.removeItem('uploadJobId');localStorage.removeItem('uploadProgress');setUploadRecovery({isRecovering:false,jobId:null,progress:0});// Reload products\nwindow.location.reload();// Simple reload for now\ntoast.success('Yükleme başarıyla tamamlandı!');}else if(data.status==='failed'){clearInterval(interval);setUploading(false);setUploadStatus('Yükleme başarısız!');// Clear recovery data\nlocalStorage.removeItem('uploadJobId');localStorage.removeItem('uploadProgress');setUploadRecovery({isRecovering:false,jobId:null,progress:0});toast.error('Yükleme başarısız oldu!');}else if(data.progress){setUploadProgress(data.progress);localStorage.setItem('uploadProgress',data.progress.toString());}}catch(error){console.error('Upload status check error:',error);}},2000);}catch(error){console.error('Upload recovery error:',error);setUploadRecovery({isRecovering:false,jobId:null,progress:0});}},[]);const cancelUploadRecovery=useCallback(()=>{localStorage.removeItem('uploadJobId');localStorage.removeItem('uploadProgress');setUploadRecovery({isRecovering:false,jobId:null,progress:0});setUploading(false);setUploadProgress(0);setUploadStatus('');},[]);// Cleanup polling on unmount\nuseEffect(()=>{return()=>{setPollingActive(false);pollingActiveRef.current=false;};},[]);useEffect(()=>{const fetchProducts=async()=>{try{setLoading(true);// Filtreleri backend'e g�nder (sadece dolu olanlar�)\nconst filters={};if(filterProductType.length>0)filters.product_type=filterProductType;if(filterColor.length>0)filters.color=filterColor;if(filterSizeRange.length>0)filters.size_range=filterSizeRange;// Price filters removed\nif(filterIncomplete)filters.incomplete=true;if(filterComplete)filters.complete=true;if(filterHasSecondProduct)filters.has_second_product=true;// Backend'den filtrelenmi� �r�nleri al\nconst response=await productsAPI.getProducts(page,20,selectedBrand||undefined,searchTerm||undefined,Object.keys(filters).length>0?filters:undefined);// UNKNOWN ve DEFAULT de�erlerini frontend'de de filtrele\nconst filteredProducts=response.products.filter(product=>product.code!=='UNKNOWN'&&product.code!=='DEFAULT_CODE'&&product.color!=='UNKNOWN'&&product.color!=='DEFAULT');setProducts(filteredProducts);setTotalPages(response.total_pages);setApiError(null);}catch(error){var _error$response2,_error$response2$data;const detail=error===null||error===void 0?void 0:(_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.detail;const message=detail&&typeof detail==='string'?detail:'Urun listesi sunucudan alinirken bir hata olustu (HTTP 500). Lutfen sistem yoneticinize haber verin.';setApiError(message);toast.error('Urunler yuklenirken hata olustu');console.error('Error loading products:',error);}finally{setLoading(false);}};// Sayfa değişikliklerinde direkt yükle\nif(page!==1){fetchProducts();return;}// Arama veya filtreler için debounce uygula\nif(searchTimerRef.current){clearTimeout(searchTimerRef.current);}searchTimerRef.current=setTimeout(()=>{fetchProducts();},500);// 500ms delay - kullanıcı yazmayı bitirince arama yap\nreturn()=>{if(searchTimerRef.current){clearTimeout(searchTimerRef.current);}};},[page,searchTerm,filterProductType,filterColor,filterSizeRange,filterIncomplete,filterHasSecondProduct,selectedBrand]);useEffect(()=>{loadBrands();loadFilterOptions();},[loadBrands,loadFilterOptions]);const validateFiles=files=>{// Dosya sayısı kontrolü\nif(files.length>uploadLimit){return{valid:false,message:\"Maksimum \".concat(uploadLimit,\" dosya se\\xE7ebilirsiniz. \").concat(files.length,\" dosya se\\xE7tiniz. \\u0130lk \").concat(uploadLimit,\" dosya kabul edilecek.\"),validFiles:files.slice(0,uploadLimit)};}// Dosya boyutu kontrolü\nconst oversizedFiles=[];const validFiles=[];let totalSizeMB=0;for(const file of files){const fileSizeMB=file.size/(1024*1024);if(fileSizeMB>maxFileSizeMB){oversizedFiles.push(\"\".concat(file.name,\" (\").concat(fileSizeMB.toFixed(2),\" MB)\"));}else{validFiles.push(file);totalSizeMB+=fileSizeMB;}}if(oversizedFiles.length>0){return{valid:false,message:\"Baz\\u0131 dosyalar \\xE7ok b\\xFCy\\xFCk (maksimum \".concat(maxFileSizeMB,\" MB):\\n\").concat(oversizedFiles.join('\\n'),\"\\n\\nBu dosyalar y\\xFCklenmeyecek.\"),validFiles};}// Toplam boyut kontrolü\nif(totalSizeMB>totalUploadSizeMB){return{valid:false,message:\"Toplam dosya boyutu \\xE7ok b\\xFCy\\xFCk: \".concat(totalSizeMB.toFixed(2),\" MB. Maksimum: \").concat(totalUploadSizeMB,\" MB. L\\xFCtfen daha az dosya se\\xE7in.\"),validFiles:[]};}return{valid:true,validFiles};};const handleFileSelect=event=>{const files=Array.from(event.target.files||[]);const validation=validateFiles(files);if(!validation.valid){toast.error(validation.message||'Dosya seçimi geçersiz');if(validation.validFiles.length>0){setSelectedFiles(validation.validFiles);setShowUploadModal(true);}return;}setSelectedFiles(validation.validFiles);setShowUploadModal(true);};const handleUpload=async()=>{if(!selectedFiles.length){notificationService.error('Lütfen yüklenecek dosyaları seçin');return;}try{setUploading(true);setUploadProgress(0);setUploadStatus(\"\".concat(selectedFiles.length,\" dosya y\\xFCkleniyor...\"));// Start upload and get job ID\nconst response=await productsAPI.uploadProductImages(selectedFiles);if(response.job_id){// Save job ID for recovery\nlocalStorage.setItem('uploadJobId',response.job_id.toString());localStorage.setItem('uploadProgress','0');setUploadJobId(response.job_id.toString());setPollingActive(true);pollingActiveRef.current=true;// Poll for progress using job ID\nconst pollProgress=async()=>{// Check polling state at the start of each poll\nif(!pollingActiveRef.current)return;// Stop polling if flag is false\ntry{const statusResponse=await productsAPI.getUploadJobStatus(response.job_id);const{status,processed_files,total_files,failed_files}=statusResponse;// Calculate progress percentage\nconst progressPercent=total_files>0?Math.round(processed_files/total_files*100):0;setUploadProgress(progressPercent);if(status==='completed'){setUploadStatus(\"Y\\xFCkleme tamamland\\u0131! \".concat(processed_files,\" dosya i\\u015Flendi\"));setPollingActive(false);// Stop polling\npollingActiveRef.current=false;// Clear recovery data\nlocalStorage.removeItem('uploadJobId');localStorage.removeItem('uploadProgress');setUploadJobId(null);// Handle results\nif(response.incomplete_products&&response.incomplete_products.length>0){setIncompleteProducts(response.incomplete_products);setShowMissingFieldsModal(true);setShowUploadModal(false);notificationService.warning(\"K\\u0131smi ba\\u015Far\\u0131: \".concat(response.products_created,\" \\xFCr\\xFCn olu\\u015Fturuldu, \").concat(response.incomplete_products.length,\" \\xFCr\\xFCn eksik bilgi nedeniyle olu\\u015Fturulamad\\u0131\"));}else{notificationService.success(\"\".concat(response.products_created,\" \\xFCr\\xFCn ba\\u015Far\\u0131yla olu\\u015Fturuldu\"));setSelectedFiles([]);setShowUploadModal(false);refreshProducts();// Listeyi yenile\n}setUploading(false);}else if(status==='failed'){setUploadStatus('Yükleme başarısız oldu');setPollingActive(false);// Stop polling\npollingActiveRef.current=false;// Clear recovery data\nlocalStorage.removeItem('uploadJobId');localStorage.removeItem('uploadProgress');setUploadJobId(null);notificationService.error('Yükleme işlemi başarısız oldu');setUploading(false);}else{// Still processing, update status and continue polling\nsetUploadStatus(\"\".concat(processed_files,\"/\").concat(total_files,\" dosya i\\u015Flendi (\").concat(failed_files,\" hata)\"));if(pollingActiveRef.current){setTimeout(pollProgress,2000);// Poll every 2 seconds\n}}}catch(error){console.error('Progress polling error:',error);setUploadStatus('Yükleme durumu kontrol edilemiyor');if(pollingActiveRef.current){setTimeout(pollProgress,5000);// Retry after 5 seconds\n}}};// Start polling\npollProgress();}else{// Fallback for immediate response (no job ID)\nsetUploadProgress(100);setUploadStatus('Yükleme tamamlandı!');if(response.success){if(response.incomplete_products&&response.incomplete_products.length>0){setIncompleteProducts(response.incomplete_products);setShowMissingFieldsModal(true);setShowUploadModal(false);notificationService.warning(\"K\\u0131smi ba\\u015Far\\u0131: \".concat(response.products_created,\" \\xFCr\\xFCn olu\\u015Fturuldu, \").concat(response.incomplete_products.length,\" \\xFCr\\xFCn eksik bilgi nedeniyle olu\\u015Fturulamad\\u0131\"));}else{notificationService.success(\"\".concat(response.products_created,\" \\xFCr\\xFCn ba\\u015Far\\u0131yla olu\\u015Fturuldu\"));setSelectedFiles([]);setShowUploadModal(false);refreshProducts();}}else{notificationService.error('Bilinmeyen hata oluştu');}setUploading(false);}}catch(error){var _error$response3,_error$response3$data;const errorMsg=((_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.detail)||'Bilinmeyen hata';notificationService.custom(errorMsg,'error',5000);console.error('Upload error:',error);setUploading(false);setUploadProgress(0);setUploadStatus('');setPollingActive(false);// Stop polling on error\npollingActiveRef.current=false;}};const clearAllFilters=()=>{setFilterProductType([]);setFilterColor([]);setFilterSizeRange([]);setFilterIncomplete(false);setFilterComplete(false);setFilterHasSecondProduct(false);setSearchTerm('');setPage(1);};const handleCompleteMissingFields=async completionData=>{try{const response=await productsAPI.completeProductsBulk(completionData);if(response.success){toast.success(\"\".concat(response.updated_count,\" \\xFCr\\xFCn bilgileri tamamland\\u0131\"));setShowMissingFieldsModal(false);setIncompleteProducts([]);refreshProducts();// Listeyi yenile\n}else{toast.error('Bilgi tamamlama başarısız');}}catch(error){toast.error('Bilgi tamamlama sırasında hata oluştu');console.error('Complete error:',error);}};const getProductStatusIcon=product=>{if(product.is_processed){return/*#__PURE__*/_jsx(CheckCircle,{className:\"w-4 h-4 text-green-500\"});}else{return null;// No icon for unprocessed products\n}};const getProductStatusText=product=>{if(product.is_processed){return'Hazır';}else{return'İşleniyor';}};const getCoverImage=product=>{const images=product.images||[];// SADECE ETİKET OLMAYAN GÖRSELLERİ AL\nconst nonTagImages=images.filter(img=>{// Etiket görsellerini kesinlikle hariç tut\nif(img.image_type==='tag'||img.image_type==='collage')return false;const filename=img.filename||img.original_filename||'';// Dosya adında 'tag' veya 'etiket' varsa hariç tut\nif(/tag|etiket/i.test(filename))return false;// Dosya adında sayı OLMAYAN dosyalar etiket olabilir - hariç tut\nif(!/\\d+\\.(jpg|jpeg|png)$/i.test(filename))return false;return true;});if(nonTagImages.length===0){return null;}// EN KÜÇÜK SAYILI GÖRSELİ BUL (COVER OLSUN OLMASIN)\nconst sortedByNumber=[...nonTagImages].sort((a,b)=>{const filenameA=a.filename||a.original_filename||'';const filenameB=b.filename||b.original_filename||'';// Dosya adından sayıyı çıkar\nconst matchA=filenameA.match(/(\\d+)\\.(jpg|jpeg|png)$/i);const matchB=filenameB.match(/(\\d+)\\.(jpg|jpeg|png)$/i);const numberA=matchA?parseInt(matchA[1]):999999;const numberB=matchB?parseInt(matchB[1]):999999;return numberA-numberB;});// EN KÜÇÜK SAYILI OLANINI DÖN\nreturn sortedByNumber[0]||null;};if(apiError){return/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center justify-center min-h-screen px-6 text-center space-y-4\",children:[/*#__PURE__*/_jsx(AlertCircle,{className:\"w-12 h-12 text-red-500\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold text-gray-800\",children:\"Veriler yuklenemedi\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 max-w-xl\",children:apiError})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleRetry,className:\"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors\",children:\"Tekrar dene\"})]});}if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center min-h-screen\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Medya galerisi y\\xFCkleniyor...\"})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[uploadRecovery.isRecovering&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-2 bg-blue-100 rounded-full\",children:/*#__PURE__*/_jsx(RefreshCw,{className:\"w-5 h-5 text-blue-600 animate-spin\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-blue-800 mb-1\",children:\"Y\\xFCkleme Devam Ediyor\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-blue-700 text-sm mb-3\",children:\"\\xD6nceki y\\xFCkleme i\\u015Flemi devam ediyor. \\u0130\\u015Flem tamamlanana kadar bekleyin.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 bg-blue-200 rounded-full h-2\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-blue-600 h-2 rounded-full transition-all duration-300\",style:{width:\"\".concat(uploadRecovery.progress,\"%\")}})}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm font-medium text-blue-800\",children:[uploadRecovery.progress,\"%\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:cancelUploadRecovery,className:\"btn btn-sm btn-ghost text-blue-600 hover:text-blue-800\",children:\"\\u0130ptal Et\"})]})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-gradient-to-r from-slate-50 to-blue-50 border border-slate-200 rounded-lg p-5\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start gap-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0 pt-0.5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center\",children:/*#__PURE__*/_jsx(AlertCircle,{className:\"w-5 h-5 text-blue-600\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-sm font-semibold text-gray-900 mb-1\",children:\"Depolama Bilgisi\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600 leading-relaxed\",children:[\"\\xDCr\\xFCn g\\xF6rselleri ve kolajlar \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-900\",children:\"24 saat\"}),\" boyunca \\xFCcretsiz olarak saklanmaktad\\u0131r. Daha uzun s\\xFCre depolama i\\xE7in premium paketlerimizi inceleyebilirsiniz.\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0\",children:/*#__PURE__*/_jsx(\"button\",{className:\"px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white text-xs font-medium rounded transition-colors duration-200\",children:\"Premium\"})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-gray-900\",children:\"\\xDCr\\xFCnler\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"\\xDCr\\xFCn g\\xF6rsellerini y\\xF6netin ve AI ile i\\u015Fleyin\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{var _document$getElementB;return(_document$getElementB=document.getElementById('file-upload'))===null||_document$getElementB===void 0?void 0:_document$getElementB.click();},className:\"btn btn-primary flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Upload,{size:18}),\"G\\xF6rsel Y\\xFCkle\"]}),/*#__PURE__*/_jsx(\"input\",{id:\"file-upload\",type:\"file\",multiple:true,accept:\"image/*\",onChange:handleFileSelect,className:\"hidden\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm border border-gray-200 p-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-sm font-semibold text-gray-700\",children:\"Arama & Filtreleme\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowFilters(!showFilters),className:\"flex items-center gap-2 px-3 py-1.5 text-sm rounded-lg transition-colors \".concat(showFilters?'bg-blue-100 text-blue-700':'bg-gray-100 text-gray-700 hover:bg-gray-200'),children:[/*#__PURE__*/_jsx(Filter,{size:16}),showFilters?'Filtreleri Gizle':'Gelişmiş Filtreler']}),(filterProductType.length>0||filterColor.length>0||filterSizeRange.length>0||filterIncomplete||filterComplete||filterHasSecondProduct)&&/*#__PURE__*/_jsxs(\"button\",{onClick:clearAllFilters,className:\"flex items-center gap-2 px-3 py-1.5 text-sm bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors\",children:[/*#__PURE__*/_jsx(X,{size:16}),\"T\\xFCm\\xFCn\\xFC Temizle\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-5 gap-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative md:col-span-2\",children:[/*#__PURE__*/_jsx(Search,{className:\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400\",size:16}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\xDCr\\xFCn ara...\",value:searchTerm,onChange:e=>{setSearchTerm(e.target.value);setPage(1);},className:\"w-full pl-9 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"})]}),/*#__PURE__*/_jsxs(\"select\",{value:selectedBrand||'',onChange:e=>{setSelectedBrand(Number(e.target.value)||null);setPage(1);},className:\"px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"T\\xFCm Markalar\"}),brands.map(brand=>/*#__PURE__*/_jsx(\"option\",{value:brand.id,children:brand.name},brand.id))]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setViewMode('grid'),className:\"p-2 rounded-lg \".concat(viewMode==='grid'?'bg-blue-100 text-blue-600':'text-gray-400 hover:text-gray-600'),title:\"Grid g\\xF6r\\xFCn\\xFCm\",children:/*#__PURE__*/_jsx(Grid,{size:16})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setViewMode('list'),className:\"p-2 rounded-lg \".concat(viewMode==='list'?'bg-blue-100 text-blue-600':'text-gray-400 hover:text-gray-600'),title:\"Liste g\\xF6r\\xFCn\\xFCm\",children:/*#__PURE__*/_jsx(List,{size:16})}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setGroupByDate(!groupByDate),className:\"px-3 py-2 rounded-lg text-xs font-medium transition-colors \".concat(groupByDate?'bg-green-100 text-green-700 hover:bg-green-200':'bg-gray-100 text-gray-600 hover:bg-gray-200'),title:\"Tarihe g\\xF6re grupla\",children:[\"\\uD83D\\uDCC5 \",groupByDate?'Gruplu':'Grup']}),/*#__PURE__*/_jsx(\"button\",{onClick:refreshProducts,className:\"p-2 rounded-lg text-gray-600 hover:bg-gray-100\",title:\"Yenile\",children:/*#__PURE__*/_jsx(RefreshCw,{size:16})})]})]}),showFilters&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 pt-4 border-t border-gray-200\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-4 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs font-medium text-gray-700 mb-1\",children:\"\\xDCr\\xFCn Tipi\"}),/*#__PURE__*/_jsx(\"div\",{className:\"max-h-32 overflow-y-auto border border-gray-300 rounded-lg p-2 space-y-1\",children:filterOptions.product_types.map(type=>/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center space-x-2 text-sm\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:filterProductType.includes(type),onChange:e=>{if(e.target.checked){setFilterProductType([...filterProductType,type]);}else{setFilterProductType(filterProductType.filter(t=>t!==type));}setPage(1);},className:\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"}),/*#__PURE__*/_jsx(\"span\",{children:type})]},type))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs font-medium text-gray-700 mb-1\",children:\"Renk\"}),/*#__PURE__*/_jsx(\"div\",{className:\"max-h-32 overflow-y-auto border border-gray-300 rounded-lg p-2 space-y-1\",children:filterOptions.colors.map(color=>/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center space-x-2 text-sm\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:filterColor.includes(color),onChange:e=>{if(e.target.checked){setFilterColor([...filterColor,color]);}else{setFilterColor(filterColor.filter(c=>c!==color));}setPage(1);},className:\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"}),/*#__PURE__*/_jsx(\"span\",{children:color})]},color))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs font-medium text-gray-700 mb-1\",children:\"Beden\"}),/*#__PURE__*/_jsx(\"div\",{className:\"max-h-32 overflow-y-auto border border-gray-300 rounded-lg p-2 space-y-1\",children:filterOptions.size_ranges.map(size=>/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center space-x-2 text-sm\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:filterSizeRange.includes(size),onChange:e=>{if(e.target.checked){setFilterSizeRange([...filterSizeRange,size]);}else{setFilterSizeRange(filterSizeRange.filter(s=>s!==size));}setPage(1);},className:\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"}),/*#__PURE__*/_jsx(\"span\",{children:size})]},size))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col gap-2\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center gap-2 text-sm text-gray-700 cursor-pointer\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:filterIncomplete,onChange:e=>{setFilterIncomplete(e.target.checked);setPage(1);},className:\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Eksik Bilgiler\"})]}),/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center gap-2 text-sm text-gray-700 cursor-pointer\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:filterComplete,onChange:e=>{setFilterComplete(e.target.checked);setPage(1);},className:\"rounded border-gray-300 text-green-600 focus:ring-green-500\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Tam Bilgiler\"})]}),/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center gap-2 text-sm text-gray-700 cursor-pointer\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:filterHasSecondProduct,onChange:e=>{setFilterHasSecondProduct(e.target.checked);setPage(1);},className:\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\xC7ift \\xDCr\\xFCn\"})]})]})]})})]}),products.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-12\",children:[/*#__PURE__*/_jsx(ImageIcon,{className:\"w-16 h-16 text-gray-300 mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900 mb-2\",children:\"Hen\\xFCz \\xFCr\\xFCn yok\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-4\",children:\"\\u0130lk \\xFCr\\xFCn g\\xF6rsellerinizi y\\xFCkleyerek ba\\u015Flay\\u0131n\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{var _document$getElementB2;return(_document$getElementB2=document.getElementById('file-upload'))===null||_document$getElementB2===void 0?void 0:_document$getElementB2.click();},className:\"btn btn-primary\",children:[/*#__PURE__*/_jsx(Plus,{size:18,className:\"mr-2\"}),\"G\\xF6rsel Y\\xFCkle\"]})]}):groupByDate&&Object.keys(dateGroups).length>0?/*#__PURE__*/// Date grouped view\n_jsx(\"div\",{className:\"space-y-8\",children:Object.entries(dateGroups).map(_ref=>{let[date,dateProducts]=_ref;return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-gradient-to-r from-blue-50 to-indigo-50 px-6 py-4 border-b border-gray-200\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-semibold text-gray-800\",children:[\"\\uD83D\\uDCC5 \",date]}),/*#__PURE__*/_jsxs(\"span\",{className:\"bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full\",children:[dateProducts.length,\" \\xFCr\\xFCn\"]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"p-6\",children:/*#__PURE__*/_jsx(\"div\",{className:viewMode==='grid'?'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 2xl:grid-cols-4 gap-6':'space-y-4',children:dateProducts.map(product=>{var _product$brand,_product$brand2;const coverImage=getCoverImage(product);return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow \".concat(viewMode==='list'?'flex':''),children:[/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(viewMode==='list'?'w-48 h-48 flex-shrink-0':'h-64',\" bg-gray-100 relative overflow-hidden\"),children:coverImage?/*#__PURE__*/_jsx(\"img\",{src:getImageURL(coverImage.file_path),alt:product.name,className:\"w-full h-full object-contain bg-white\",loading:\"lazy\",onError:e=>{e.target.src='data:image/svg+xml,%3Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"100\" height=\"100\"%3E%3Crect fill=\"%23f3f4f6\" width=\"100\" height=\"100\"/%3E%3Ctext x=\"50%25\" y=\"50%25\" text-anchor=\"middle\" dy=\".3em\" fill=\"%239ca3af\"%3ENo Image%3C/text%3E%3C/svg%3E';}}):/*#__PURE__*/_jsx(\"div\",{className:\"w-full h-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(ImageIcon,{className:\"w-8 h-8 text-gray-400\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 \".concat(viewMode==='list'?'flex-1':''),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between mb-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-semibold text-blue-600 mb-1 truncate\",title:product.brand_name||((_product$brand=product.brand)===null||_product$brand===void 0?void 0:_product$brand.name),children:product.brand_name||((_product$brand2=product.brand)===null||_product$brand2===void 0?void 0:_product$brand2.name)||'Marka Yok'}),/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium text-gray-900 truncate\",title:product.code,children:product.code.length>20?\"\".concat(product.code.substring(0,20),\"...\"):product.code}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 truncate\",title:product.color,children:product.color&&product.color.length>15?\"\".concat(product.color.substring(0,15),\"...\"):product.color})]}),getProductStatusIcon(product)]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between text-sm text-gray-500 mb-3\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[(product.images||[]).length,\" g\\xF6rsel\"]}),/*#__PURE__*/_jsx(\"span\",{children:getProductStatusText(product)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-1.5 mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm \".concat(!product.product_type?'text-red-500 font-medium':'text-gray-600'),children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-700\",children:\"Tip:\"}),\" \",product.product_type||'❌ Eksik']}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm \".concat(!product.size_range?'text-red-500 font-medium':'text-gray-600'),children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-700\",children:\"Beden:\"}),\" \",product.size_range||'❌ Eksik']}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm \".concat(!product.price?'text-red-500 font-medium':'text-gray-600'),children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-700\",children:\"Fiyat:\"}),\" \",product.price?\"$\".concat(product.price):'❌ Eksik']})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center gap-2\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:()=>window.location.href=\"/admin/products/\".concat(product.id),className:\"btn btn-sm btn-secondary flex items-center gap-1\",children:[/*#__PURE__*/_jsx(Eye,{size:14}),\"Detay\"]})})]})]},product.id);})})})]},date);})}):/*#__PURE__*/// Regular view (non-grouped)\n_jsx(\"div\",{className:viewMode==='grid'?'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 2xl:grid-cols-4 gap-6':'space-y-4',children:products.map(product=>{var _product$images;const coverImage=getCoverImage(product);return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow \".concat(viewMode==='list'?'flex':''),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(viewMode==='list'?'w-48 h-48 flex-shrink-0':'h-64',\" bg-gray-100 relative overflow-hidden\"),children:[coverImage?/*#__PURE__*/_jsx(\"img\",{src:getImageURL(coverImage.file_path),alt:product.name,className:\"w-full h-full object-contain bg-white\",loading:\"lazy\",onError:e=>{e.target.src='data:image/svg+xml,%3Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"100\" height=\"100\"%3E%3Crect fill=\"%23f3f4f6\" width=\"100\" height=\"100\"/%3E%3Ctext x=\"50%25\" y=\"50%25\" text-anchor=\"middle\" dy=\".3em\" fill=\"%239ca3af\"%3ENo Image%3C/text%3E%3C/svg%3E';}}):/*#__PURE__*/_jsx(\"div\",{className:\"w-full h-full flex items-center justify-center bg-gray-100\",children:/*#__PURE__*/_jsx(ImageIcon,{size:48,className:\"text-gray-400\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute top-2 right-2 bg-black bg-opacity-75 text-white text-xs px-2 py-1 rounded-full\",children:[((_product$images=product.images)===null||_product$images===void 0?void 0:_product$images.length)||0,\" g\\xF6rsel\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute top-2 left-2 flex flex-col gap-1\",children:[(!product.product_type||!product.color||!product.size_range||!product.price)&&/*#__PURE__*/_jsx(\"span\",{className:\"bg-red-500 text-white text-xs px-2 py-1 rounded-full font-medium\",children:\"\\u274C Eksik\"}),product.product_type&&product.color&&product.size_range&&product.price&&/*#__PURE__*/_jsx(\"span\",{className:\"bg-green-500 text-white text-xs px-2 py-1 rounded-full font-medium\",children:\"\\u2705 Tam\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 \".concat(viewMode==='list'?'flex-1 flex flex-col justify-between':''),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-gray-900 text-lg mb-1\",children:product.code}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 text-sm mb-2\",children:product.name}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500\",children:product.brand_name})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-1 mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm \".concat(!product.product_type?'text-red-500 font-medium':'text-gray-600'),children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-700\",children:\"Tip:\"}),\" \",product.product_type||'❌ Eksik']}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm \".concat(!product.color?'text-red-500 font-medium':'text-gray-600'),children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-700\",children:\"Renk:\"}),\" \",product.color||'❌ Eksik']}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm \".concat(!product.size_range?'text-red-500 font-medium':'text-gray-600'),children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-700\",children:\"Beden:\"}),\" \",product.size_range||'❌ Eksik']}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm \".concat(!product.price?'text-red-500 font-medium':'text-gray-600'),children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-700\",children:\"Fiyat:\"}),\" \",product.price?\"$\".concat(product.price):'❌ Eksik']})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center gap-2\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:()=>window.location.href=\"/admin/products/\".concat(product.id),className:\"btn btn-sm btn-secondary flex items-center gap-1\",children:[/*#__PURE__*/_jsx(Eye,{size:14}),\"Detay\"]})})]})]},product.id);})}),totalPages>1&&/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setPage(Math.max(1,page-1)),disabled:page===1,className:\"btn btn-sm btn-secondary\",children:\"\\xD6nceki\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-gray-600\",children:[\"Sayfa \",page,\" / \",totalPages]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setPage(Math.min(totalPages,page+1)),disabled:page===totalPages,className:\"btn btn-sm btn-secondary\",children:\"Sonraki\"})]})}),showUploadModal&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg p-6 w-full max-w-md\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900 mb-4\",children:\"G\\xF6rsel Y\\xFCkle\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 p-3 bg-blue-50 rounded-lg\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-medium text-blue-900 mb-2\",children:\"Y\\xFCkleme Limitleri:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-blue-700 space-y-1\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"\\u2022 Maksimum dosya say\\u0131s\\u0131: \",uploadLimit,\" \",/*#__PURE__*/_jsx(\"span\",{className:\"text-green-600\",children:\"\\u26A1\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"\\u2022 Maksimum dosya boyutu: \",maxFileSizeMB,\" MB \",/*#__PURE__*/_jsx(\"span\",{className:\"text-green-600\",children:\"\\u26A1\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"\\u2022 Toplam y\\xFCkleme boyutu: \",totalUploadSizeMB,\" MB \",/*#__PURE__*/_jsx(\"span\",{className:\"text-green-600\",children:\"\\u26A1\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-green-600 font-medium mt-2\",children:\"\\uD83D\\uDE80 Optimize edilmi\\u015F performans!\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 p-3 bg-green-50 rounded-lg\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start gap-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-green-600\",children:\"\\u2139\\uFE0F\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-green-800\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-medium\",children:\"Otomatik Marka Tespiti\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-1\",children:\"Marka bilgisi etiketlerden otomatik olarak tespit edilecek. Sadece yetkili oldu\\u011Funuz markalar y\\xFCklenecek.\"})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600 mb-2\",children:[selectedFiles.length,\" dosya se\\xE7ildi\",(()=>{const totalSizeMB=selectedFiles.reduce((sum,file)=>sum+file.size/(1024*1024),0);return/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-500\",children:[' ',\"(Toplam: \",totalSizeMB.toFixed(2),\" MB)\"]});})()]}),/*#__PURE__*/_jsxs(\"div\",{className:\"max-h-32 overflow-y-auto border border-gray-200 rounded-lg p-2\",children:[selectedFiles.slice(0,10).map((file,index)=>{const fileSizeMB=file.size/(1024*1024);const isOversized=fileSizeMB>maxFileSizeMB;return/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs truncate \".concat(isOversized?'text-red-600':'text-gray-500'),children:[file.name,\" (\",fileSizeMB.toFixed(2),\" MB)\",isOversized&&/*#__PURE__*/_jsx(\"span\",{className:\"text-red-600 font-medium\",children:\" - \\xC7OK B\\xDCY\\xDCK!\"})]},index);}),selectedFiles.length>10&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-400 italic\",children:[\"... ve \",selectedFiles.length-10,\" dosya daha\"]})]})]}),uploading&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-600\",children:uploadStatus}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm font-medium text-blue-600\",children:[uploadProgress,\"%\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full bg-gray-200 rounded-full h-2.5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-blue-600 h-2.5 rounded-full transition-all duration-300\",style:{width:\"\".concat(uploadProgress,\"%\")}})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end gap-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowUploadModal(false),className:\"btn btn-secondary\",disabled:uploading,children:\"\\u0130ptal\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleUpload,className:\"btn btn-primary\",disabled:uploading||selectedFiles.length>uploadLimit,children:uploading?'Yükleniyor...':'Yükle'})]})]})}),showMissingFieldsModal&&/*#__PURE__*/_jsx(MissingFieldsModal,{incompleteProducts:incompleteProducts,onComplete:handleCompleteMissingFields,onCancel:()=>{setShowMissingFieldsModal(false);setIncompleteProducts([]);}})]});};export default MediaGallery;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useRef","productsAPI","brandsAPI","settingsAPI","useUrlConfig","MissingFieldsModal","Upload","Image","ImageIcon","Eye","Search","Filter","Grid","List","Plus","RefreshCw","CheckCircle","AlertCircle","X","toast","notificationService","jsx","_jsx","jsxs","_jsxs","MediaGallery","getImageURL","products","setProducts","brands","setBrands","filterOptions","setFilterOptions","product_types","colors","size_ranges","loading","setLoading","uploading","setUploading","uploadProgress","setUploadProgress","uploadStatus","setUploadStatus","pollingActive","setPollingActive","pollingActiveRef","uploadJobId","setUploadJobId","uploadRecovery","setUploadRecovery","isRecovering","jobId","progress","uploadLimit","setUploadLimit","maxFileSizeMB","setMaxFileSizeMB","totalUploadSizeMB","setTotalUploadSizeMB","selectedBrand","setSelectedBrand","saved","sessionStorage","getItem","parseInt","searchTerm","setSearchTerm","viewMode","setViewMode","page","setPage","filterProductType","setFilterProductType","JSON","parse","filterColor","setFilterColor","filterSizeRange","setFilterSizeRange","filterIncomplete","setFilterIncomplete","filterHasSecondProduct","setFilterHasSecondProduct","filterComplete","setFilterComplete","showFilters","setShowFilters","groupByDate","setGroupByDate","dateGroups","setDateGroups","selectedFiles","setSelectedFiles","showUploadModal","setShowUploadModal","totalPages","setTotalPages","incompleteProducts","setIncompleteProducts","showMissingFieldsModal","setShowMissingFieldsModal","saving","setSaving","apiError","setApiError","searchTimerRef","setItem","toString","stringify","loadUploadSettings","settings","getSettings","maxFileCountSetting","find","s","key","value","maxFileSizeSetting","totalUploadSizeSetting","error","console","refreshProducts","filters","length","product_type","color","size_range","incomplete","complete","has_second_product","response","getProducts","undefined","Object","keys","total_pages","groupProductsByDate","_error$response","_error$response$data","detail","data","message","trim","groups","forEach","product","created_at","date","Date","dateKey","toLocaleDateString","year","month","day","push","sortedGroups","sort","a","b","dateA","dateB","getTime","loadBrands","getBrandsWithProducts","loadFilterOptions","options","getFilterOptions","prev","handleRetry","checkForUploadRecovery","savedUploadJob","localStorage","savedUploadProgress","resumeUploadMonitoring","interval","setInterval","fetch","concat","json","status","clearInterval","removeItem","window","location","reload","success","cancelUploadRecovery","current","fetchProducts","filteredProducts","filter","code","_error$response2","_error$response2$data","clearTimeout","setTimeout","validateFiles","files","valid","validFiles","slice","oversizedFiles","totalSizeMB","file","fileSizeMB","size","name","toFixed","join","handleFileSelect","event","Array","from","target","validation","handleUpload","uploadProductImages","job_id","pollProgress","statusResponse","getUploadJobStatus","processed_files","total_files","failed_files","progressPercent","Math","round","incomplete_products","warning","products_created","_error$response3","_error$response3$data","errorMsg","custom","clearAllFilters","handleCompleteMissingFields","completionData","completeProductsBulk","updated_count","getProductStatusIcon","is_processed","className","getProductStatusText","getCoverImage","images","nonTagImages","img","image_type","filename","original_filename","test","sortedByNumber","filenameA","filenameB","matchA","match","matchB","numberA","numberB","children","onClick","style","width","_document$getElementB","document","getElementById","click","id","type","multiple","accept","onChange","placeholder","e","Number","map","brand","title","checked","includes","t","c","_document$getElementB2","entries","_ref","dateProducts","_product$brand","_product$brand2","coverImage","src","file_path","alt","onError","brand_name","substring","price","href","_product$images","max","disabled","min","reduce","sum","index","isOversized","onComplete","onCancel"],"sources":["C:/Users/ilker/Desktop/aibrands/frontend/src/pages/admin/MediaGallery.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { productsAPI, Product, ProductImage, IncompleteProduct } from '../../api/products';\nimport { brandsAPI, Brand } from '../../api/brands';\nimport { settingsAPI } from '../../api/settings';\nimport { useUrlConfig } from '../../hooks/useUrlConfig';\nimport MissingFieldsModal from '../../components/modals/MissingFieldsModal';\nimport { \n  Upload, \n  Image as ImageIcon, \n  Eye, \n  Search,\n  Filter,\n  Grid,\n  List,\n  Plus,\n  RefreshCw,\n  CheckCircle,\n  AlertCircle,\n  DollarSign,\n  X\n} from 'lucide-react';\nimport toast from 'react-hot-toast';\nimport { notificationService } from '../../services/notificationService';\n\nconst MediaGallery: React.FC = () => {\n  const { getImageURL } = useUrlConfig();\n  const [products, setProducts] = useState<Product[]>([]);\n  const [brands, setBrands] = useState<Brand[]>([]);\n  const [filterOptions, setFilterOptions] = useState<{\n    product_types: string[];\n    colors: string[];\n    size_ranges: string[];\n  }>({ product_types: [], colors: [], size_ranges: [] });\n  const [loading, setLoading] = useState(true);\n  const [uploading, setUploading] = useState(false);\n  const [uploadProgress, setUploadProgress] = useState(0);\n  const [uploadStatus, setUploadStatus] = useState('');\n  const [pollingActive, setPollingActive] = useState(false);\n  const pollingActiveRef = useRef(false);\n  \n  // Upload recovery system\n  const [uploadJobId, setUploadJobId] = useState<string | null>(null);\n  const [uploadRecovery, setUploadRecovery] = useState<{\n    isRecovering: boolean;\n    jobId: string | null;\n    progress: number;\n  }>({ isRecovering: false, jobId: null, progress: 0 });\n  const [uploadLimit, setUploadLimit] = useState<number>(200); // Optimize edildi: 100 -> 200\n  const [maxFileSizeMB, setMaxFileSizeMB] = useState<number>(20); // Optimize edildi: 10 -> 20 MB\n  const [totalUploadSizeMB, setTotalUploadSizeMB] = useState<number>(1000); // Optimize edildi: 500 -> 1000 MB\n  \n  \n  // State'leri sessionStorage'dan restore et\n  const [selectedBrand, setSelectedBrand] = useState<number | null>(() => {\n    const saved = sessionStorage.getItem('mediaGallery_selectedBrand');\n    return saved ? parseInt(saved) : null;\n  });\n  const [searchTerm, setSearchTerm] = useState(() => sessionStorage.getItem('mediaGallery_searchTerm') || '');\n  const [viewMode, setViewMode] = useState<'grid' | 'list'>(() => {\n    const saved = sessionStorage.getItem('mediaGallery_viewMode');\n    return (saved as 'grid' | 'list') || 'grid';\n  });\n  const [page, setPage] = useState(() => {\n    const saved = sessionStorage.getItem('mediaGallery_page');\n    return saved ? parseInt(saved) : 1;\n  });\n  \n  // Yeni filtreleme state'leri - çoklu seçim için array\n  const [filterProductType, setFilterProductType] = useState<string[]>(() => {\n    const saved = sessionStorage.getItem('mediaGallery_filterProductType');\n    return saved ? JSON.parse(saved) : [];\n  });\n  const [filterColor, setFilterColor] = useState<string[]>(() => {\n    const saved = sessionStorage.getItem('mediaGallery_filterColor');\n    return saved ? JSON.parse(saved) : [];\n  });\n  const [filterSizeRange, setFilterSizeRange] = useState<string[]>(() => {\n    const saved = sessionStorage.getItem('mediaGallery_filterSizeRange');\n    return saved ? JSON.parse(saved) : [];\n  });\n  // Price filters removed\n  const [filterIncomplete, setFilterIncomplete] = useState(() => sessionStorage.getItem('mediaGallery_filterIncomplete') === 'true');\n  const [filterHasSecondProduct, setFilterHasSecondProduct] = useState(() => sessionStorage.getItem('mediaGallery_filterHasSecondProduct') === 'true');\n  const [filterComplete, setFilterComplete] = useState(() => sessionStorage.getItem('mediaGallery_filterComplete') === 'true');\n  const [showFilters, setShowFilters] = useState(false);\n  \n  // Date grouping states\n  const [groupByDate, setGroupByDate] = useState(() => sessionStorage.getItem('mediaGallery_groupByDate') === 'true');\n  const [dateGroups, setDateGroups] = useState<{[key: string]: Product[]}>({});\n  \n  const [selectedFiles, setSelectedFiles] = useState<File[]>([]);\n  const [showUploadModal, setShowUploadModal] = useState(false);\n  const [totalPages, setTotalPages] = useState(1);\n  const [incompleteProducts, setIncompleteProducts] = useState<IncompleteProduct[]>([]);\n  const [showMissingFieldsModal, setShowMissingFieldsModal] = useState(false);\n  \n  const [saving, setSaving] = useState(false);\n  const [apiError, setApiError] = useState<string | null>(null);\n\n  // Debounce için timer ref\n  const searchTimerRef = useRef<NodeJS.Timeout | null>(null);\n  \n  // State değişikliklerini sessionStorage'a kaydet\n  useEffect(() => {\n    if (selectedBrand) sessionStorage.setItem('mediaGallery_selectedBrand', selectedBrand.toString());\n    sessionStorage.setItem('mediaGallery_searchTerm', searchTerm);\n    sessionStorage.setItem('mediaGallery_viewMode', viewMode);\n    sessionStorage.setItem('mediaGallery_page', page.toString());\n    sessionStorage.setItem('mediaGallery_filterProductType', JSON.stringify(filterProductType));\n    sessionStorage.setItem('mediaGallery_filterColor', JSON.stringify(filterColor));\n    sessionStorage.setItem('mediaGallery_filterSizeRange', JSON.stringify(filterSizeRange));\n    // Price filters removed\n    sessionStorage.setItem('mediaGallery_filterIncomplete', filterIncomplete.toString());\n    sessionStorage.setItem('mediaGallery_filterHasSecondProduct', filterHasSecondProduct.toString());\n    sessionStorage.setItem('mediaGallery_filterComplete', filterComplete.toString());\n    sessionStorage.setItem('mediaGallery_groupByDate', groupByDate.toString());\n  }, [selectedBrand, searchTerm, viewMode, page, filterProductType, filterColor, filterSizeRange, filterIncomplete, filterHasSecondProduct, filterComplete, groupByDate]);\n\n  // Upload settings yükle\n  const loadUploadSettings = useCallback(async () => {\n    try {\n      const settings = await settingsAPI.getSettings();\n      \n      const maxFileCountSetting = settings.settings.find(s => s.key === 'max_file_count');\n      if (maxFileCountSetting) {\n        setUploadLimit(parseInt(maxFileCountSetting.value) || 100);\n      }\n      \n      const maxFileSizeSetting = settings.settings.find(s => s.key === 'max_file_size_mb');\n      if (maxFileSizeSetting) {\n        setMaxFileSizeMB(parseInt(maxFileSizeSetting.value) || 10);\n      }\n      \n      const totalUploadSizeSetting = settings.settings.find(s => s.key === 'total_upload_size_mb');\n      if (totalUploadSizeSetting) {\n        setTotalUploadSizeMB(parseInt(totalUploadSizeSetting.value) || 500);\n      }\n    } catch (error) {\n      console.error('Upload settings yüklenemedi:', error);\n    }\n  }, []);\n\n  // Refresh fonksiyonu - manuel yenileme i�in\n  const refreshProducts = useCallback(async () => {\n    setLoading(true);\n    try {\n      const filters: any = {};\n      if (filterProductType.length > 0) filters.product_type = filterProductType;\n      if (filterColor.length > 0) filters.color = filterColor;\n      if (filterSizeRange.length > 0) filters.size_range = filterSizeRange;\n      if (filterIncomplete) filters.incomplete = true;\n      if (filterComplete) filters.complete = true;\n      if (filterHasSecondProduct) filters.has_second_product = true;\n\n      const response = await productsAPI.getProducts(\n        page,\n        20,\n        selectedBrand || undefined,\n        searchTerm || undefined,\n        Object.keys(filters).length > 0 ? filters : undefined\n      );\n\n      setProducts(response.products);\n      setTotalPages(response.total_pages);\n      setApiError(null);\n      \n      // Group by date if enabled\n      if (groupByDate) {\n        groupProductsByDate(response.products || []);\n      }\n    } catch (error: any) {\n      const detail = error?.response?.data?.detail;\n      const message = detail && typeof detail === 'string' && detail.trim().length > 0\n        ? detail\n        : 'Urun listesi sunucudan alinirken bir hata olustu (HTTP 500). Lutfen sistem yoneticinize haber verin.';\n      setApiError(message);\n      toast.error('Urunler yuklenirken hata olustu');\n      console.error('Error loading products:', error);\n    } finally {\n      setLoading(false);\n    }\n  }, [page, selectedBrand, searchTerm, filterProductType, filterColor, filterSizeRange, filterIncomplete, filterHasSecondProduct, groupByDate]);\n\n  // Group products by date\n  const groupProductsByDate = useCallback((products: Product[]) => {\n    const groups: {[key: string]: Product[]} = {};\n    \n    products.forEach(product => {\n      if (product.created_at) {\n        const date = new Date(product.created_at);\n        const dateKey = date.toLocaleDateString('tr-TR', {\n          year: 'numeric',\n          month: 'long',\n          day: 'numeric'\n        });\n        \n        if (!groups[dateKey]) {\n          groups[dateKey] = [];\n        }\n        groups[dateKey].push(product);\n      }\n    });\n    \n    // Sort groups by date (newest first)\n    const sortedGroups: {[key: string]: Product[]} = {};\n    Object.keys(groups)\n      .sort((a, b) => {\n        const dateA = new Date(groups[a][0].created_at!);\n        const dateB = new Date(groups[b][0].created_at!);\n        return dateB.getTime() - dateA.getTime();\n      })\n      .forEach(key => {\n        sortedGroups[key] = groups[key];\n      });\n    \n    setDateGroups(sortedGroups);\n  }, []);\n\n  const loadBrands = useCallback(async () => {\n    try {\n      // ✅ Sadece ürünü olan markaları getir\n      const response = await brandsAPI.getBrandsWithProducts();\n      setBrands(response.brands);\n      \n      // ✅ Otomatik marka seçme - kullanıcı manuel seçsin\n      // İlk yüklemede tüm ürünleri göster\n    } catch (error: any) {\n      toast.error('Markalar yüklenirken hata oluştu');\n      console.error('Error loading brands:', error);\n    }\n  }, []);\n\n  const loadFilterOptions = useCallback(async () => {\n    try {\n      const options = await productsAPI.getFilterOptions();\n      setFilterOptions(options);\n    } catch (error: any) {\n      console.error('Error loading filter options:', error);\n      setApiError(prev => prev ?? 'Filtre se�enekleri sunucudan alinamadi. Lutfen sistem yoneticinize haber verin.');\n    }\n  }, []);\n\n  const handleRetry = useCallback(() => {\n    setApiError(null);\n    loadBrands();\n    loadFilterOptions();\n    refreshProducts();\n  }, [loadBrands, loadFilterOptions, refreshProducts]);\n\n  // Upload settings yükle\n  useEffect(() => {\n    loadUploadSettings();\n    checkForUploadRecovery();\n  }, [loadUploadSettings]);\n\n  // Upload recovery system\n  const checkForUploadRecovery = useCallback(() => {\n    const savedUploadJob = localStorage.getItem('uploadJobId');\n    const savedUploadProgress = localStorage.getItem('uploadProgress');\n    \n    if (savedUploadJob && savedUploadProgress) {\n      setUploadRecovery({\n        isRecovering: true,\n        jobId: savedUploadJob,\n        progress: parseInt(savedUploadProgress)\n      });\n      \n      // Resume upload monitoring\n      resumeUploadMonitoring(savedUploadJob);\n    }\n  }, []);\n\n  const resumeUploadMonitoring = useCallback(async (jobId: string) => {\n    try {\n      setUploading(true);\n      setUploadProgress(parseInt(localStorage.getItem('uploadProgress') || '0'));\n      setUploadStatus('Yükleme devam ediyor...');\n      \n      // Start polling for upload status\n      const interval = setInterval(async () => {\n        try {\n          const response = await fetch(`/api/upload/status/${jobId}`);\n          const data = await response.json();\n          \n          if (data.status === 'completed') {\n            clearInterval(interval);\n            setUploading(false);\n            setUploadProgress(100);\n            setUploadStatus('Yükleme tamamlandı!');\n            \n            // Clear recovery data\n            localStorage.removeItem('uploadJobId');\n            localStorage.removeItem('uploadProgress');\n            setUploadRecovery({ isRecovering: false, jobId: null, progress: 0 });\n            \n            // Reload products\n            window.location.reload(); // Simple reload for now\n            toast.success('Yükleme başarıyla tamamlandı!');\n          } else if (data.status === 'failed') {\n            clearInterval(interval);\n            setUploading(false);\n            setUploadStatus('Yükleme başarısız!');\n            \n            // Clear recovery data\n            localStorage.removeItem('uploadJobId');\n            localStorage.removeItem('uploadProgress');\n            setUploadRecovery({ isRecovering: false, jobId: null, progress: 0 });\n            \n            toast.error('Yükleme başarısız oldu!');\n          } else if (data.progress) {\n            setUploadProgress(data.progress);\n            localStorage.setItem('uploadProgress', data.progress.toString());\n          }\n        } catch (error) {\n          console.error('Upload status check error:', error);\n        }\n      }, 2000);\n      \n    } catch (error) {\n      console.error('Upload recovery error:', error);\n      setUploadRecovery({ isRecovering: false, jobId: null, progress: 0 });\n    }\n  }, []);\n\n  const cancelUploadRecovery = useCallback(() => {\n    localStorage.removeItem('uploadJobId');\n    localStorage.removeItem('uploadProgress');\n    setUploadRecovery({ isRecovering: false, jobId: null, progress: 0 });\n    setUploading(false);\n    setUploadProgress(0);\n    setUploadStatus('');\n  }, []);\n\n  // Cleanup polling on unmount\n  useEffect(() => {\n    return () => {\n      setPollingActive(false);\n      pollingActiveRef.current = false;\n    };\n  }, []);\n\n  useEffect(() => {\n    const fetchProducts = async () => {\n      try {\n        setLoading(true);\n\n        // Filtreleri backend'e g�nder (sadece dolu olanlar�)\n        const filters: any = {};\n        if (filterProductType.length > 0) filters.product_type = filterProductType;\n        if (filterColor.length > 0) filters.color = filterColor;\n        if (filterSizeRange.length > 0) filters.size_range = filterSizeRange;\n        // Price filters removed\n        if (filterIncomplete) filters.incomplete = true;\n        if (filterComplete) filters.complete = true;\n        if (filterHasSecondProduct) filters.has_second_product = true;\n\n        // Backend'den filtrelenmi� �r�nleri al\n        const response = await productsAPI.getProducts(\n          page,\n          20,\n          selectedBrand || undefined,\n          searchTerm || undefined,\n          Object.keys(filters).length > 0 ? filters : undefined\n        );\n\n        // UNKNOWN ve DEFAULT de�erlerini frontend'de de filtrele\n        const filteredProducts = response.products.filter(product =>\n          product.code !== 'UNKNOWN' &&\n          product.code !== 'DEFAULT_CODE' &&\n          product.color !== 'UNKNOWN' &&\n          product.color !== 'DEFAULT'\n        );\n\n        setProducts(filteredProducts);\n        setTotalPages(response.total_pages);\n        setApiError(null);\n      } catch (error: any) {\n        const detail = error?.response?.data?.detail;\n        const message = detail && typeof detail === 'string'\n          ? detail\n          : 'Urun listesi sunucudan alinirken bir hata olustu (HTTP 500). Lutfen sistem yoneticinize haber verin.';\n        setApiError(message);\n        toast.error('Urunler yuklenirken hata olustu');\n        console.error('Error loading products:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n    \n    // Sayfa değişikliklerinde direkt yükle\n    if (page !== 1) {\n      fetchProducts();\n      return;\n    }\n    \n    // Arama veya filtreler için debounce uygula\n    if (searchTimerRef.current) {\n      clearTimeout(searchTimerRef.current);\n    }\n    searchTimerRef.current = setTimeout(() => {\n      fetchProducts();\n    }, 500); // 500ms delay - kullanıcı yazmayı bitirince arama yap\n    \n    return () => {\n      if (searchTimerRef.current) {\n        clearTimeout(searchTimerRef.current);\n      }\n    };\n  }, [page, searchTerm, filterProductType, filterColor, filterSizeRange, filterIncomplete, filterHasSecondProduct, selectedBrand]);\n\n  useEffect(() => {\n    loadBrands();\n    loadFilterOptions();\n  }, [loadBrands, loadFilterOptions]);\n\n  const validateFiles = (files: File[]): { valid: boolean; message?: string; validFiles: File[] } => {\n    // Dosya sayısı kontrolü\n    if (files.length > uploadLimit) {\n      return {\n        valid: false,\n        message: `Maksimum ${uploadLimit} dosya seçebilirsiniz. ${files.length} dosya seçtiniz. İlk ${uploadLimit} dosya kabul edilecek.`,\n        validFiles: files.slice(0, uploadLimit)\n      };\n    }\n\n    // Dosya boyutu kontrolü\n    const oversizedFiles: string[] = [];\n    const validFiles: File[] = [];\n    let totalSizeMB = 0;\n\n    for (const file of files) {\n      const fileSizeMB = file.size / (1024 * 1024);\n      \n      if (fileSizeMB > maxFileSizeMB) {\n        oversizedFiles.push(`${file.name} (${fileSizeMB.toFixed(2)} MB)`);\n      } else {\n        validFiles.push(file);\n        totalSizeMB += fileSizeMB;\n      }\n    }\n\n    if (oversizedFiles.length > 0) {\n      return {\n        valid: false,\n        message: `Bazı dosyalar çok büyük (maksimum ${maxFileSizeMB} MB):\\n${oversizedFiles.join('\\n')}\\n\\nBu dosyalar yüklenmeyecek.`,\n        validFiles\n      };\n    }\n\n    // Toplam boyut kontrolü\n    if (totalSizeMB > totalUploadSizeMB) {\n      return {\n        valid: false,\n        message: `Toplam dosya boyutu çok büyük: ${totalSizeMB.toFixed(2)} MB. Maksimum: ${totalUploadSizeMB} MB. Lütfen daha az dosya seçin.`,\n        validFiles: []\n      };\n    }\n\n    return { valid: true, validFiles };\n  };\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const files = Array.from(event.target.files || []);\n    \n    const validation = validateFiles(files);\n    \n    if (!validation.valid) {\n      toast.error(validation.message || 'Dosya seçimi geçersiz');\n      if (validation.validFiles.length > 0) {\n        setSelectedFiles(validation.validFiles);\n        setShowUploadModal(true);\n      }\n      return;\n    }\n    \n    setSelectedFiles(validation.validFiles);\n    setShowUploadModal(true);\n  };\n\n  const handleUpload = async () => {\n    if (!selectedFiles.length) {\n      notificationService.error('Lütfen yüklenecek dosyaları seçin');\n      return;\n    }\n\n    try {\n      setUploading(true);\n      setUploadProgress(0);\n      setUploadStatus(`${selectedFiles.length} dosya yükleniyor...`);\n      \n      // Start upload and get job ID\n      const response = await productsAPI.uploadProductImages(selectedFiles);\n      \n      if (response.job_id) {\n        // Save job ID for recovery\n        localStorage.setItem('uploadJobId', response.job_id.toString());\n        localStorage.setItem('uploadProgress', '0');\n        \n        setUploadJobId(response.job_id.toString());\n        setPollingActive(true);\n        pollingActiveRef.current = true;\n        // Poll for progress using job ID\n        const pollProgress = async () => {\n          // Check polling state at the start of each poll\n          if (!pollingActiveRef.current) return; // Stop polling if flag is false\n          \n          try {\n            const statusResponse = await productsAPI.getUploadJobStatus(response.job_id!);\n            const { status, processed_files, total_files, failed_files } = statusResponse;\n            \n            // Calculate progress percentage\n            const progressPercent = total_files > 0 ? Math.round((processed_files / total_files) * 100) : 0;\n            setUploadProgress(progressPercent);\n            \n            if (status === 'completed') {\n              setUploadStatus(`Yükleme tamamlandı! ${processed_files} dosya işlendi`);\n              setPollingActive(false); // Stop polling\n              pollingActiveRef.current = false;\n              \n              // Clear recovery data\n              localStorage.removeItem('uploadJobId');\n              localStorage.removeItem('uploadProgress');\n              setUploadJobId(null);\n              \n              // Handle results\n              if (response.incomplete_products && response.incomplete_products.length > 0) {\n                setIncompleteProducts(response.incomplete_products);\n                setShowMissingFieldsModal(true);\n                setShowUploadModal(false);\n                notificationService.warning(`Kısmi başarı: ${response.products_created} ürün oluşturuldu, ${response.incomplete_products.length} ürün eksik bilgi nedeniyle oluşturulamadı`);\n              } else {\n                notificationService.success(`${response.products_created} ürün başarıyla oluşturuldu`);\n                setSelectedFiles([]);\n                setShowUploadModal(false);\n                refreshProducts(); // Listeyi yenile\n              }\n              setUploading(false);\n            } else if (status === 'failed') {\n              setUploadStatus('Yükleme başarısız oldu');\n              setPollingActive(false); // Stop polling\n              pollingActiveRef.current = false;\n              \n              // Clear recovery data\n              localStorage.removeItem('uploadJobId');\n              localStorage.removeItem('uploadProgress');\n              setUploadJobId(null);\n              \n              notificationService.error('Yükleme işlemi başarısız oldu');\n              setUploading(false);\n            } else {\n              // Still processing, update status and continue polling\n              setUploadStatus(`${processed_files}/${total_files} dosya işlendi (${failed_files} hata)`);\n              if (pollingActiveRef.current) {\n                setTimeout(pollProgress, 2000); // Poll every 2 seconds\n              }\n            }\n          } catch (error) {\n            console.error('Progress polling error:', error);\n            setUploadStatus('Yükleme durumu kontrol edilemiyor');\n            if (pollingActiveRef.current) {\n              setTimeout(pollProgress, 5000); // Retry after 5 seconds\n            }\n          }\n        };\n        \n        // Start polling\n        pollProgress();\n      } else {\n        // Fallback for immediate response (no job ID)\n        setUploadProgress(100);\n        setUploadStatus('Yükleme tamamlandı!');\n        \n        if (response.success) {\n          if (response.incomplete_products && response.incomplete_products.length > 0) {\n            setIncompleteProducts(response.incomplete_products);\n            setShowMissingFieldsModal(true);\n            setShowUploadModal(false);\n            notificationService.warning(`Kısmi başarı: ${response.products_created} ürün oluşturuldu, ${response.incomplete_products.length} ürün eksik bilgi nedeniyle oluşturulamadı`);\n          } else {\n            notificationService.success(`${response.products_created} ürün başarıyla oluşturuldu`);\n            setSelectedFiles([]);\n            setShowUploadModal(false);\n            refreshProducts();\n          }\n        } else {\n          notificationService.error('Bilinmeyen hata oluştu');\n        }\n        setUploading(false);\n      }\n    } catch (error: any) {\n      const errorMsg = error.response?.data?.detail || 'Bilinmeyen hata';\n      notificationService.custom(errorMsg, 'error' as any, 5000);\n      console.error('Upload error:', error);\n      setUploading(false);\n      setUploadProgress(0);\n      setUploadStatus('');\n      setPollingActive(false); // Stop polling on error\n      pollingActiveRef.current = false;\n    }\n  };\n\n\n\n  const clearAllFilters = () => {\n    setFilterProductType([]);\n    setFilterColor([]);\n    setFilterSizeRange([]);\n    setFilterIncomplete(false);\n    setFilterComplete(false);\n    setFilterHasSecondProduct(false);\n    setSearchTerm('');\n    setPage(1);\n  };\n\n\n  const handleCompleteMissingFields = async (completionData: Array<{\n    product_id: number;\n    product_type?: string;\n    size_range?: string;\n    price?: number;\n  }>) => {\n    try {\n      const response = await productsAPI.completeProductsBulk(completionData);\n      if (response.success) {\n        toast.success(`${response.updated_count} ürün bilgileri tamamlandı`);\n        setShowMissingFieldsModal(false);\n        setIncompleteProducts([]);\n        refreshProducts(); // Listeyi yenile\n      } else {\n        toast.error('Bilgi tamamlama başarısız');\n      }\n    } catch (error: any) {\n      toast.error('Bilgi tamamlama sırasında hata oluştu');\n      console.error('Complete error:', error);\n    }\n  };\n\n  const getProductStatusIcon = (product: Product) => {\n    if (product.is_processed) {\n      return <CheckCircle className=\"w-4 h-4 text-green-500\" />;\n    } else {\n      return null; // No icon for unprocessed products\n    }\n  };\n\n  const getProductStatusText = (product: Product) => {\n    if (product.is_processed) {\n      return 'Hazır';\n    } else {\n      return 'İşleniyor';\n    }\n  };\n\n  const getCoverImage = (product: Product): ProductImage | null => {\n    const images = product.images || [];\n    \n    // SADECE ETİKET OLMAYAN GÖRSELLERİ AL\n    const nonTagImages = images.filter(img => {\n      // Etiket görsellerini kesinlikle hariç tut\n      if (img.image_type === 'tag' || img.image_type === 'collage') return false;\n      \n      const filename = img.filename || img.original_filename || '';\n      \n      // Dosya adında 'tag' veya 'etiket' varsa hariç tut\n      if (/tag|etiket/i.test(filename)) return false;\n      \n      // Dosya adında sayı OLMAYAN dosyalar etiket olabilir - hariç tut\n      if (!/\\d+\\.(jpg|jpeg|png)$/i.test(filename)) return false;\n      \n      return true;\n    });\n    \n    if (nonTagImages.length === 0) {\n      return null;\n    }\n    \n    // EN KÜÇÜK SAYILI GÖRSELİ BUL (COVER OLSUN OLMASIN)\n    const sortedByNumber = [...nonTagImages].sort((a, b) => {\n      const filenameA = a.filename || a.original_filename || '';\n      const filenameB = b.filename || b.original_filename || '';\n      \n      // Dosya adından sayıyı çıkar\n      const matchA = filenameA.match(/(\\d+)\\.(jpg|jpeg|png)$/i);\n      const matchB = filenameB.match(/(\\d+)\\.(jpg|jpeg|png)$/i);\n      \n      const numberA = matchA ? parseInt(matchA[1]) : 999999;\n      const numberB = matchB ? parseInt(matchB[1]) : 999999;\n      \n      return numberA - numberB;\n    });\n    \n    // EN KÜÇÜK SAYILI OLANINI DÖN\n    return sortedByNumber[0] || null;\n  };\n\n  if (apiError) {\n    return (\n      <div className=\"flex flex-col items-center justify-center min-h-screen px-6 text-center space-y-4\">\n        <AlertCircle className=\"w-12 h-12 text-red-500\" />\n        <div className=\"space-y-2\">\n          <h2 className=\"text-xl font-semibold text-gray-800\">Veriler yuklenemedi</h2>\n          <p className=\"text-gray-600 max-w-xl\">{apiError}</p>\n        </div>\n        <button\n          onClick={handleRetry}\n          className=\"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors\"\n        >\n          Tekrar dene\n        </button>\n      </div>\n    );\n  }\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"flex items-center gap-3\">\n          <div className=\"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin\"></div>\n          <span className=\"text-gray-600\">Medya galerisi yükleniyor...</span>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Upload Recovery Banner */}\n      {uploadRecovery.isRecovering && (\n        <div className=\"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4\">\n          <div className=\"flex items-start gap-3\">\n            <div className=\"p-2 bg-blue-100 rounded-full\">\n              <RefreshCw className=\"w-5 h-5 text-blue-600 animate-spin\" />\n            </div>\n            <div className=\"flex-1\">\n              <h3 className=\"font-semibold text-blue-800 mb-1\">Yükleme Devam Ediyor</h3>\n              <p className=\"text-blue-700 text-sm mb-3\">\n                Önceki yükleme işlemi devam ediyor. İşlem tamamlanana kadar bekleyin.\n              </p>\n              <div className=\"flex items-center gap-4\">\n                <div className=\"flex-1 bg-blue-200 rounded-full h-2\">\n                  <div \n                    className=\"bg-blue-600 h-2 rounded-full transition-all duration-300\"\n                    style={{ width: `${uploadRecovery.progress}%` }}\n                  ></div>\n                </div>\n                <span className=\"text-sm font-medium text-blue-800\">{uploadRecovery.progress}%</span>\n                <button\n                  onClick={cancelUploadRecovery}\n                  className=\"btn btn-sm btn-ghost text-blue-600 hover:text-blue-800\"\n                >\n                  İptal Et\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Bilgilendirme Mesajı - Temiz Modern Tasarım */}\n      <div className=\"bg-gradient-to-r from-slate-50 to-blue-50 border border-slate-200 rounded-lg p-5\">\n        <div className=\"flex items-start gap-4\">\n          {/* İkon */}\n          <div className=\"flex-shrink-0 pt-0.5\">\n            <div className=\"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center\">\n              <AlertCircle className=\"w-5 h-5 text-blue-600\" />\n            </div>\n          </div>\n          \n          {/* İçerik */}\n          <div className=\"flex-1\">\n            <h3 className=\"text-sm font-semibold text-gray-900 mb-1\">Depolama Bilgisi</h3>\n            <p className=\"text-sm text-gray-600 leading-relaxed\">\n              Ürün görselleri ve kolajlar <span className=\"font-medium text-gray-900\">24 saat</span> boyunca ücretsiz olarak saklanmaktadır. Daha uzun süre depolama için premium paketlerimizi inceleyebilirsiniz.\n            </p>\n          </div>\n          \n          {/* Buton */}\n          <div className=\"flex-shrink-0\">\n            <button className=\"px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white text-xs font-medium rounded transition-colors duration-200\">\n              Premium\n            </button>\n          </div>\n        </div>\n      </div>\n\n      {/* Header */}\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-gray-900\">Ürünler</h1>\n          <p className=\"text-gray-600\">Ürün görsellerini yönetin ve AI ile işleyin</p>\n        </div>\n        \n        <div className=\"flex items-center gap-3\">\n          <button\n            onClick={() => document.getElementById('file-upload')?.click()}\n            className=\"btn btn-primary flex items-center gap-2\"\n          >\n            <Upload size={18} />\n            Görsel Yükle\n          </button>\n          \n          <input\n            id=\"file-upload\"\n            type=\"file\"\n            multiple\n            accept=\"image/*\"\n            onChange={handleFileSelect}\n            className=\"hidden\"\n          />\n        </div>\n      </div>\n\n      {/* Filters */}\n      <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-4\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-sm font-semibold text-gray-700\">Arama & Filtreleme</h3>\n          <div className=\"flex items-center gap-2\">\n            <button\n              onClick={() => setShowFilters(!showFilters)}\n              className={`flex items-center gap-2 px-3 py-1.5 text-sm rounded-lg transition-colors ${\n                showFilters ? 'bg-blue-100 text-blue-700' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n              }`}\n            >\n              <Filter size={16} />\n              {showFilters ? 'Filtreleri Gizle' : 'Gelişmiş Filtreler'}\n            </button>\n            {(filterProductType.length > 0 || filterColor.length > 0 || filterSizeRange.length > 0 || filterIncomplete || filterComplete || filterHasSecondProduct) && (\n              <button\n                onClick={clearAllFilters}\n                className=\"flex items-center gap-2 px-3 py-1.5 text-sm bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors\"\n              >\n                <X size={16} />\n                Tümünü Temizle\n              </button>\n            )}\n          </div>\n        </div>\n        \n        <div className=\"grid grid-cols-1 md:grid-cols-5 gap-3\">\n          {/* Search - Ürün Kodu ve Ürün Adı */}\n          <div className=\"relative md:col-span-2\">\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400\" size={16} />\n            <input\n              type=\"text\"\n              placeholder=\"Ürün ara...\"\n              value={searchTerm}\n              onChange={(e) => { setSearchTerm(e.target.value); setPage(1); }}\n              className=\"w-full pl-9 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            />\n          </div>\n\n          {/* Brand Filter */}\n          <select\n            value={selectedBrand || ''}\n            onChange={(e) => { setSelectedBrand(Number(e.target.value) || null); setPage(1); }}\n            className=\"px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n          >\n            <option value=\"\">Tüm Markalar</option>\n            {brands.map(brand => (\n              <option key={brand.id} value={brand.id}>\n                {brand.name}\n              </option>\n            ))}\n          </select>\n\n          {/* View Mode & Options Combined */}\n          <div className=\"flex items-center gap-2\">\n            <button\n              onClick={() => setViewMode('grid')}\n              className={`p-2 rounded-lg ${viewMode === 'grid' ? 'bg-blue-100 text-blue-600' : 'text-gray-400 hover:text-gray-600'}`}\n              title=\"Grid görünüm\"\n            >\n              <Grid size={16} />\n            </button>\n            <button\n              onClick={() => setViewMode('list')}\n              className={`p-2 rounded-lg ${viewMode === 'list' ? 'bg-blue-100 text-blue-600' : 'text-gray-400 hover:text-gray-600'}`}\n              title=\"Liste görünüm\"\n            >\n              <List size={16} />\n            </button>\n            <button\n              onClick={() => setGroupByDate(!groupByDate)}\n              className={`px-3 py-2 rounded-lg text-xs font-medium transition-colors ${\n                groupByDate \n                  ? 'bg-green-100 text-green-700 hover:bg-green-200' \n                  : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\n              }`}\n              title=\"Tarihe göre grupla\"\n            >\n              📅 {groupByDate ? 'Gruplu' : 'Grup'}\n            </button>\n            <button\n              onClick={refreshProducts}\n              className=\"p-2 rounded-lg text-gray-600 hover:bg-gray-100\"\n              title=\"Yenile\"\n            >\n              <RefreshCw size={16} />\n            </button>\n          </div>\n        </div>\n        \n        {/* Gelişmiş Filtreler */}\n        {showFilters && (\n          <div className=\"mt-4 pt-4 border-t border-gray-200\">\n            <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n              {/* Ürün Tipi */}\n              <div>\n                <label className=\"block text-xs font-medium text-gray-700 mb-1\">Ürün Tipi</label>\n                <div className=\"max-h-32 overflow-y-auto border border-gray-300 rounded-lg p-2 space-y-1\">\n                  {filterOptions.product_types.map(type => (\n                    <label key={type} className=\"flex items-center space-x-2 text-sm\">\n                      <input\n                        type=\"checkbox\"\n                        checked={filterProductType.includes(type)}\n                        onChange={(e) => {\n                          if (e.target.checked) {\n                            setFilterProductType([...filterProductType, type]);\n                          } else {\n                            setFilterProductType(filterProductType.filter(t => t !== type));\n                          }\n                          setPage(1);\n                        }}\n                        className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                      />\n                      <span>{type}</span>\n                    </label>\n                  ))}\n                </div>\n              </div>\n              \n              {/* Renk */}\n              <div>\n                <label className=\"block text-xs font-medium text-gray-700 mb-1\">Renk</label>\n                <div className=\"max-h-32 overflow-y-auto border border-gray-300 rounded-lg p-2 space-y-1\">\n                  {filterOptions.colors.map(color => (\n                    <label key={color} className=\"flex items-center space-x-2 text-sm\">\n                      <input\n                        type=\"checkbox\"\n                        checked={filterColor.includes(color)}\n                        onChange={(e) => {\n                          if (e.target.checked) {\n                            setFilterColor([...filterColor, color]);\n                          } else {\n                            setFilterColor(filterColor.filter(c => c !== color));\n                          }\n                          setPage(1);\n                        }}\n                        className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                      />\n                      <span>{color}</span>\n                    </label>\n                  ))}\n                </div>\n              </div>\n              \n              {/* Beden */}\n              <div>\n                <label className=\"block text-xs font-medium text-gray-700 mb-1\">Beden</label>\n                <div className=\"max-h-32 overflow-y-auto border border-gray-300 rounded-lg p-2 space-y-1\">\n                  {filterOptions.size_ranges.map(size => (\n                    <label key={size} className=\"flex items-center space-x-2 text-sm\">\n                      <input\n                        type=\"checkbox\"\n                        checked={filterSizeRange.includes(size)}\n                        onChange={(e) => {\n                          if (e.target.checked) {\n                            setFilterSizeRange([...filterSizeRange, size]);\n                          } else {\n                            setFilterSizeRange(filterSizeRange.filter(s => s !== size));\n                          }\n                          setPage(1);\n                        }}\n                        className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                      />\n                      <span>{size}</span>\n                    </label>\n                  ))}\n                </div>\n              </div>\n              \n              {/* Price filters removed */}\n              \n              {/* Özel Filtreler */}\n              <div className=\"flex flex-col gap-2\">\n                <label className=\"flex items-center gap-2 text-sm text-gray-700 cursor-pointer\">\n                  <input\n                    type=\"checkbox\"\n                    checked={filterIncomplete}\n                    onChange={(e) => { setFilterIncomplete(e.target.checked); setPage(1); }}\n                    className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                  />\n                  <span>Eksik Bilgiler</span>\n                </label>\n                <label className=\"flex items-center gap-2 text-sm text-gray-700 cursor-pointer\">\n                  <input\n                    type=\"checkbox\"\n                    checked={filterComplete}\n                    onChange={(e) => { setFilterComplete(e.target.checked); setPage(1); }}\n                    className=\"rounded border-gray-300 text-green-600 focus:ring-green-500\"\n                  />\n                  <span>Tam Bilgiler</span>\n                </label>\n                <label className=\"flex items-center gap-2 text-sm text-gray-700 cursor-pointer\">\n                  <input\n                    type=\"checkbox\"\n                    checked={filterHasSecondProduct}\n                    onChange={(e) => { setFilterHasSecondProduct(e.target.checked); setPage(1); }}\n                    className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                  />\n                  <span>Çift Ürün</span>\n                </label>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Products Grid/List */}\n      {products.length === 0 ? (\n        <div className=\"text-center py-12\">\n          <ImageIcon className=\"w-16 h-16 text-gray-300 mx-auto mb-4\" />\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">Henüz ürün yok</h3>\n          <p className=\"text-gray-600 mb-4\">İlk ürün görsellerinizi yükleyerek başlayın</p>\n          <button\n            onClick={() => document.getElementById('file-upload')?.click()}\n            className=\"btn btn-primary\"\n          >\n            <Plus size={18} className=\"mr-2\" />\n            Görsel Yükle\n          </button>\n        </div>\n      ) : groupByDate && Object.keys(dateGroups).length > 0 ? (\n        // Date grouped view\n        <div className=\"space-y-8\">\n          {Object.entries(dateGroups).map(([date, dateProducts]) => (\n            <div key={date} className=\"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden\">\n              {/* Date Header */}\n              <div className=\"bg-gradient-to-r from-blue-50 to-indigo-50 px-6 py-4 border-b border-gray-200\">\n                <div className=\"flex items-center justify-between\">\n                  <h3 className=\"text-lg font-semibold text-gray-800\">📅 {date}</h3>\n                  <span className=\"bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full\">\n                    {dateProducts.length} ürün\n                  </span>\n                </div>\n              </div>\n              \n              {/* Products in this date group */}\n              <div className=\"p-6\">\n                <div className={viewMode === 'grid' ? 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 2xl:grid-cols-4 gap-6' : 'space-y-4'}>\n                  {dateProducts.map((product) => {\n            const coverImage = getCoverImage(product);\n            \n            return (\n              <div\n                key={product.id}\n                className={`bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow ${\n                  viewMode === 'list' ? 'flex' : ''\n                }`}\n              >\n                {/* Product Image */}\n                <div className={`${viewMode === 'list' ? 'w-48 h-48 flex-shrink-0' : 'h-64'} bg-gray-100 relative overflow-hidden`}>\n                  {coverImage ? (\n                    <img\n                      src={getImageURL(coverImage.file_path)}\n                      alt={product.name}\n                      className=\"w-full h-full object-contain bg-white\"\n                      loading=\"lazy\"\n                      onError={(e) => {\n                        (e.target as HTMLImageElement).src = 'data:image/svg+xml,%3Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"100\" height=\"100\"%3E%3Crect fill=\"%23f3f4f6\" width=\"100\" height=\"100\"/%3E%3Ctext x=\"50%25\" y=\"50%25\" text-anchor=\"middle\" dy=\".3em\" fill=\"%239ca3af\"%3ENo Image%3C/text%3E%3C/svg%3E';\n                      }}\n                    />\n                  ) : (\n                    <div className=\"w-full h-full flex items-center justify-center\">\n                      <ImageIcon className=\"w-8 h-8 text-gray-400\" />\n                    </div>\n                  )}\n                </div>\n\n                {/* Product Info */}\n                <div className={`p-4 ${viewMode === 'list' ? 'flex-1' : ''}`}>\n                  <div className=\"flex items-start justify-between mb-2\">\n                    <div className=\"flex-1 min-w-0\">\n                      {/* Marka Adı */}\n                      <p className=\"text-xs font-semibold text-blue-600 mb-1 truncate\" title={product.brand_name || product.brand?.name}>\n                        {product.brand_name || product.brand?.name || 'Marka Yok'}\n                      </p>\n                      {/* Ürün Kodu */}\n                      <h3 className=\"font-medium text-gray-900 truncate\" title={product.code}>\n                        {product.code.length > 20 ? `${product.code.substring(0, 20)}...` : product.code}\n                      </h3>\n                      {/* Renk */}\n                      <p className=\"text-sm text-gray-600 truncate\" title={product.color}>\n                        {product.color && product.color.length > 15 ? `${product.color.substring(0, 15)}...` : product.color}\n                      </p>\n                    </div>\n                    {getProductStatusIcon(product)}\n                  </div>\n\n                  <div className=\"flex items-center justify-between text-sm text-gray-500 mb-3\">\n                    <span>{(product.images || []).length} görsel</span>\n                    <span>{getProductStatusText(product)}</span>\n                  </div>\n\n                  {/* VIEW MODE */}\n                  <div className=\"space-y-1.5 mb-3\">\n                    <div className={`text-sm ${!product.product_type ? 'text-red-500 font-medium' : 'text-gray-600'}`}>\n                      <span className=\"font-medium text-gray-700\">Tip:</span> {product.product_type || '❌ Eksik'}\n                    </div>\n                    <div className={`text-sm ${!product.size_range ? 'text-red-500 font-medium' : 'text-gray-600'}`}>\n                      <span className=\"font-medium text-gray-700\">Beden:</span> {product.size_range || '❌ Eksik'}\n                    </div>\n                    <div className={`text-sm ${!product.price ? 'text-red-500 font-medium' : 'text-gray-600'}`}>\n                      <span className=\"font-medium text-gray-700\">Fiyat:</span> {product.price ? `$${product.price}` : '❌ Eksik'}\n                    </div>\n                  </div>\n\n                  {/* Actions */}\n                  <div className=\"flex items-center gap-2\">\n                    <button\n                      onClick={() => window.location.href = `/admin/products/${product.id}`}\n                      className=\"btn btn-sm btn-secondary flex items-center gap-1\"\n                    >\n                      <Eye size={14} />\n                      Detay\n                    </button>\n                  </div>\n                </div>\n              </div>\n                    );\n                  })}\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      ) : (\n        // Regular view (non-grouped)\n        <div className={viewMode === 'grid' ? 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 2xl:grid-cols-4 gap-6' : 'space-y-4'}>\n          {products.map((product) => {\n            const coverImage = getCoverImage(product);\n            \n            return (\n              <div\n                key={product.id}\n                className={`bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow ${\n                  viewMode === 'list' ? 'flex' : ''\n                }`}\n              >\n                {/* Product Image */}\n                <div className={`${viewMode === 'list' ? 'w-48 h-48 flex-shrink-0' : 'h-64'} bg-gray-100 relative overflow-hidden`}>\n                  {coverImage ? (\n                    <img\n                      src={getImageURL(coverImage.file_path)}\n                      alt={product.name}\n                      className=\"w-full h-full object-contain bg-white\"\n                      loading=\"lazy\"\n                      onError={(e) => {\n                        (e.target as HTMLImageElement).src = 'data:image/svg+xml,%3Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"100\" height=\"100\"%3E%3Crect fill=\"%23f3f4f6\" width=\"100\" height=\"100\"/%3E%3Ctext x=\"50%25\" y=\"50%25\" text-anchor=\"middle\" dy=\".3em\" fill=\"%239ca3af\"%3ENo Image%3C/text%3E%3C/svg%3E';\n                      }}\n                    />\n                  ) : (\n                    <div className=\"w-full h-full flex items-center justify-center bg-gray-100\">\n                      <ImageIcon size={48} className=\"text-gray-400\" />\n                    </div>\n                  )}\n                  \n                  {/* Image count badge */}\n                  <div className=\"absolute top-2 right-2 bg-black bg-opacity-75 text-white text-xs px-2 py-1 rounded-full\">\n                    {product.images?.length || 0} görsel\n                  </div>\n                  \n                  {/* Status badges */}\n                  <div className=\"absolute top-2 left-2 flex flex-col gap-1\">\n                    {(!product.product_type || !product.color || !product.size_range || !product.price) && (\n                      <span className=\"bg-red-500 text-white text-xs px-2 py-1 rounded-full font-medium\">\n                        ❌ Eksik\n                      </span>\n                    )}\n                    {product.product_type && product.color && product.size_range && product.price && (\n                      <span className=\"bg-green-500 text-white text-xs px-2 py-1 rounded-full font-medium\">\n                        ✅ Tam\n                      </span>\n                    )}\n                  </div>\n                </div>\n\n                {/* Product Info */}\n                <div className={`p-4 ${viewMode === 'list' ? 'flex-1 flex flex-col justify-between' : ''}`}>\n                  <div className=\"mb-3\">\n                    <h3 className=\"font-semibold text-gray-900 text-lg mb-1\">{product.code}</h3>\n                    <p className=\"text-gray-600 text-sm mb-2\">{product.name}</p>\n                    <p className=\"text-xs text-gray-500\">{product.brand_name}</p>\n                  </div>\n\n                  {/* Product Details */}\n                  <div className=\"space-y-1 mb-4\">\n                    <div className={`text-sm ${!product.product_type ? 'text-red-500 font-medium' : 'text-gray-600'}`}>\n                      <span className=\"font-medium text-gray-700\">Tip:</span> {product.product_type || '❌ Eksik'}\n                    </div>\n                    <div className={`text-sm ${!product.color ? 'text-red-500 font-medium' : 'text-gray-600'}`}>\n                      <span className=\"font-medium text-gray-700\">Renk:</span> {product.color || '❌ Eksik'}\n                    </div>\n                    <div className={`text-sm ${!product.size_range ? 'text-red-500 font-medium' : 'text-gray-600'}`}>\n                      <span className=\"font-medium text-gray-700\">Beden:</span> {product.size_range || '❌ Eksik'}\n                    </div>\n                    <div className={`text-sm ${!product.price ? 'text-red-500 font-medium' : 'text-gray-600'}`}>\n                      <span className=\"font-medium text-gray-700\">Fiyat:</span> {product.price ? `$${product.price}` : '❌ Eksik'}\n                    </div>\n                  </div>\n\n                  {/* Actions */}\n                  <div className=\"flex items-center gap-2\">\n                    <button\n                      onClick={() => window.location.href = `/admin/products/${product.id}`}\n                      className=\"btn btn-sm btn-secondary flex items-center gap-1\"\n                    >\n                      <Eye size={14} />\n                      Detay\n                    </button>\n                  </div>\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      )}\n\n      {/* Pagination */}\n      {totalPages > 1 && (\n        <div className=\"flex justify-center\">\n          <div className=\"flex items-center gap-2\">\n            <button\n              onClick={() => setPage(Math.max(1, page - 1))}\n              disabled={page === 1}\n              className=\"btn btn-sm btn-secondary\"\n            >\n              Önceki\n            </button>\n            \n            <span className=\"text-sm text-gray-600\">\n              Sayfa {page} / {totalPages}\n            </span>\n            \n            <button\n              onClick={() => setPage(Math.min(totalPages, page + 1))}\n              disabled={page === totalPages}\n              className=\"btn btn-sm btn-secondary\"\n            >\n              Sonraki\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* Upload Modal */}\n      {showUploadModal && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white rounded-lg p-6 w-full max-w-md\">\n            <h3 className=\"text-lg font-medium text-gray-900 mb-4\">Görsel Yükle</h3>\n            \n            {/* Limit Bilgileri */}\n            <div className=\"mb-4 p-3 bg-blue-50 rounded-lg\">\n              <h4 className=\"text-sm font-medium text-blue-900 mb-2\">Yükleme Limitleri:</h4>\n              <div className=\"text-xs text-blue-700 space-y-1\">\n                <div>• Maksimum dosya sayısı: {uploadLimit} <span className=\"text-green-600\">⚡</span></div>\n                <div>• Maksimum dosya boyutu: {maxFileSizeMB} MB <span className=\"text-green-600\">⚡</span></div>\n                <div>• Toplam yükleme boyutu: {totalUploadSizeMB} MB <span className=\"text-green-600\">⚡</span></div>\n                <div className=\"text-green-600 font-medium mt-2\">🚀 Optimize edilmiş performans!</div>\n              </div>\n            </div>\n            \n            {/* Marka seçimi kaldırıldı - otomatik tespit edilecek */}\n            <div className=\"mb-4 p-3 bg-green-50 rounded-lg\">\n              <div className=\"flex items-start gap-2\">\n                <div className=\"text-green-600\">ℹ️</div>\n                <div className=\"text-sm text-green-800\">\n                  <p className=\"font-medium\">Otomatik Marka Tespiti</p>\n                  <p className=\"mt-1\">\n                    Marka bilgisi etiketlerden otomatik olarak tespit edilecek. \n                    Sadece yetkili olduğunuz markalar yüklenecek.\n                  </p>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"mb-4\">\n              <p className=\"text-sm text-gray-600 mb-2\">\n                {selectedFiles.length} dosya seçildi\n                {(() => {\n                  const totalSizeMB = selectedFiles.reduce((sum, file) => sum + file.size / (1024 * 1024), 0);\n                  return (\n                    <span className=\"text-gray-500\">\n                      {' '}(Toplam: {totalSizeMB.toFixed(2)} MB)\n                    </span>\n                  );\n                })()}\n              </p>\n              <div className=\"max-h-32 overflow-y-auto border border-gray-200 rounded-lg p-2\">\n                {selectedFiles.slice(0, 10).map((file, index) => {\n                  const fileSizeMB = file.size / (1024 * 1024);\n                  const isOversized = fileSizeMB > maxFileSizeMB;\n                  return (\n                    <div key={index} className={`text-xs truncate ${isOversized ? 'text-red-600' : 'text-gray-500'}`}>\n                      {file.name} ({fileSizeMB.toFixed(2)} MB)\n                      {isOversized && <span className=\"text-red-600 font-medium\"> - ÇOK BÜYÜK!</span>}\n                    </div>\n                  );\n                })}\n                {selectedFiles.length > 10 && (\n                  <div className=\"text-xs text-gray-400 italic\">\n                    ... ve {selectedFiles.length - 10} dosya daha\n                  </div>\n                )}\n              </div>\n            </div>\n\n            {/* Progress Bar */}\n            {uploading && (\n              <div className=\"mb-4\">\n                <div className=\"flex items-center justify-between mb-2\">\n                  <span className=\"text-sm text-gray-600\">{uploadStatus}</span>\n                  <span className=\"text-sm font-medium text-blue-600\">{uploadProgress}%</span>\n                </div>\n                <div className=\"w-full bg-gray-200 rounded-full h-2.5\">\n                  <div\n                    className=\"bg-blue-600 h-2.5 rounded-full transition-all duration-300\"\n                    style={{ width: `${uploadProgress}%` }}\n                  ></div>\n                </div>\n              </div>\n            )}\n\n            <div className=\"flex justify-end gap-3\">\n              <button\n                onClick={() => setShowUploadModal(false)}\n                className=\"btn btn-secondary\"\n                disabled={uploading}\n              >\n                İptal\n              </button>\n              <button\n                onClick={handleUpload}\n                className=\"btn btn-primary\"\n                disabled={uploading || selectedFiles.length > uploadLimit}\n              >\n                {uploading ? 'Yükleniyor...' : 'Yükle'}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Missing Fields Modal */}\n      {showMissingFieldsModal && (\n        <MissingFieldsModal\n          incompleteProducts={incompleteProducts}\n          onComplete={handleCompleteMissingFields}\n          onCancel={() => {\n            setShowMissingFieldsModal(false);\n            setIncompleteProducts([]);\n          }}\n        />\n      )}\n\n    </div>\n  );\n};\n\nexport default MediaGallery;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}