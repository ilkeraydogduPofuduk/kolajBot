{"ast":null,"code":"import _objectSpread from\"C:/Users/ilker/Desktop/aibrands/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{employeeRequestsAPI}from'../../api/employeeRequests';import{brandsAPI}from'../../api/brands';import{rolesAPI}from'../../api/roles';// Used in modals\n// import { auditLogsAPI, AuditActions, ResourceTypes } from '../../api/auditLogs'; // Disabled - endpoint not available\nimport{useAuth}from'../../hooks/useAuth';import{Plus,Search,Check,X,Clock,User,Building2,Edit}from'lucide-react';import{usePageTexts}from'../../hooks/usePageTexts';import toast from'react-hot-toast';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const EmployeeRequests=()=>{var _currentUser$permissi;const{user:currentUser,loading:authLoading}=useAuth();const{getTitle,getDescription,getButtonText,getStatusText}=usePageTexts();const[requests,setRequests]=useState([]);const[brands,setBrands]=useState([]);const[loading,setLoading]=useState(true);const[page,setPage]=useState(1);const[total,setTotal]=useState(0);const[statusFilter,setStatusFilter]=useState('');const[showCreateModal,setShowCreateModal]=useState(false);const[selectedRequest,setSelectedRequest]=useState(null);const[showApprovalModal,setShowApprovalModal]=useState(false);const[showEditModal,setShowEditModal]=useState(false);const[editingRequest,setEditingRequest]=useState(null);const perPage=10;useEffect(()=>{if(authLoading)return;// Wait for auth to complete\nloadRequests();loadBrands();},[page,statusFilter,authLoading]);// eslint-disable-line react-hooks/exhaustive-deps\nconst loadRequests=async()=>{try{setLoading(true);const response=await employeeRequestsAPI.getEmployeeRequests(page,perPage,statusFilter||undefined);setRequests(response.requests);setTotal(response.total);}catch(error){toast.error('Talepler yüklenemedi');}finally{setLoading(false);}};const loadBrands=async()=>{try{const response=await brandsAPI.getBrands(1,100);setBrands(response.brands);}catch(error){// Ignore error for brands\n}};const handleCreateRequest=async requestData=>{try{// Validate role_id before sending\nif(!requestData.role_id||requestData.role_id===0){toast.error('Rol bilgisi yüklenemedi. Lütfen sayfayı yenileyin.');return;}const newRequest=await employeeRequestsAPI.createEmployeeRequest(requestData);// Audit log disabled - endpoint not available\n/*try {\n        await auditLogsAPI.createAuditLog({\n          action: AuditActions.EMPLOYEE_REQUEST_CREATED,\n          resource_type: ResourceTypes.EMPLOYEE_REQUEST,\n          resource_id: newRequest.id,\n          details: {\n            resource_name: `${requestData.first_name} ${requestData.last_name}`,\n            new_values: requestData,\n            message: `${requestData.first_name} ${requestData.last_name} için çalışan talebi oluşturuldu`\n          }\n        });\n      } catch (auditError) {\n        console.error('Audit log oluşturulamadı:', auditError);\n      }*/toast.success('Çalışan talebi başarıyla oluşturuldu');setShowCreateModal(false);loadRequests();// Sidebar'daki sayacı güncelle\nwindow.dispatchEvent(new CustomEvent('employeeRequestUpdated'));}catch(error){var _error$response,_error$response$data;const errorMessage=((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.detail)||'Talep oluşturulamadı';console.error('Employee request creation error:',error);// Check if it's a foreign key error (database inconsistency)\nif(errorMessage.includes('Geçersiz rol ID')||errorMessage.includes('foreign key')){toast.error('Veritabanı tutarsızlığı tespit edildi. Lütfen sistem yöneticisine başvurun.');}else{toast.error(errorMessage);}}};const handleApproveRequest=async(requestId,adminNotes)=>{try{const request=requests.find(r=>r.id===requestId);const oldStatus=request===null||request===void 0?void 0:request.status;await employeeRequestsAPI.approveEmployeeRequest(requestId,adminNotes);// Audit log disabled - endpoint not available\n/*try {\n        await auditLogsAPI.createAuditLog({\n          action: AuditActions.EMPLOYEE_REQUEST_APPROVED,\n          resource_type: ResourceTypes.EMPLOYEE_REQUEST,\n          resource_id: requestId,\n          details: {\n            resource_name: request ? `${request.first_name} ${request.last_name}` : `Talep #${requestId}`,\n            old_values: { status: oldStatus, admin_notes: request?.admin_notes },\n            new_values: { status: 'approved', admin_notes: adminNotes },\n            message: `${request?.first_name} ${request?.last_name} için çalışan talebi onaylandı${adminNotes ? ` - Not: ${adminNotes}` : ''}`\n          }\n        });\n      } catch (auditError) {\n        console.error('Audit log oluşturulamadı:', auditError);\n      }*/toast.success('Talep onaylandı ve çalışan oluşturuldu');setShowApprovalModal(false);setSelectedRequest(null);loadRequests();// Sidebar'daki sayacı güncelle\nwindow.dispatchEvent(new CustomEvent('employeeRequestUpdated'));}catch(error){var _error$response2,_error$response2$data;toast.error(((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.detail)||'Talep onaylanamadı');}};const handleRejectRequest=async(requestId,adminNotes)=>{try{const request=requests.find(r=>r.id===requestId);const oldStatus=request===null||request===void 0?void 0:request.status;await employeeRequestsAPI.rejectEmployeeRequest(requestId,adminNotes);// Audit log disabled - endpoint not available\n/*try {\n        await auditLogsAPI.createAuditLog({\n          action: AuditActions.EMPLOYEE_REQUEST_REJECTED,\n          resource_type: ResourceTypes.EMPLOYEE_REQUEST,\n          resource_id: requestId,\n          details: {\n            resource_name: request ? `${request.first_name} ${request.last_name}` : `Talep #${requestId}`,\n            old_values: { status: oldStatus, admin_notes: request?.admin_notes },\n            new_values: { status: 'rejected', admin_notes: adminNotes },\n            message: `${request?.first_name} ${request?.last_name} için çalışan talebi reddedildi - Sebep: ${adminNotes}`\n          }\n        });\n      } catch (auditError) {\n        console.error('Audit log oluşturulamadı:', auditError);\n      }*/toast.success('Talep reddedildi');setShowApprovalModal(false);setSelectedRequest(null);loadRequests();// Sidebar'daki sayacı güncelle\nwindow.dispatchEvent(new CustomEvent('employeeRequestUpdated'));}catch(error){var _error$response3,_error$response3$data;toast.error(((_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.detail)||'Talep reddedilemedi');}};// Hızlı onaylama (admin notları olmadan)\n// const handleQuickApprove = async (requestId: number) => {\n//   if (!window.confirm('Bu talebi onaylamak istediğinizden emin misiniz? Otomatik olarak kullanıcı oluşturulacak ve şifre gönderilecektir.')) {\n//     return;\n//   }\n//   try {\n//     await employeeRequestsAPI.approveEmployeeRequest(requestId, 'Hızlı onay');\n//     toast.success('Talep onaylandı! Kullanıcı oluşturuldu ve şifre gönderildi.');\n//     loadRequests();\n//     // Sidebar'daki sayacı güncelle\n//     window.dispatchEvent(new CustomEvent('employeeRequestUpdated'));\n//   } catch (error: any) {\n//     toast.error(error.response?.data?.detail || 'Talep onaylanamadı');\n//   }\n// };\n// Talep düzenleme\nconst handleEditRequest=request=>{setEditingRequest(request);setShowEditModal(true);};// Talep güncelleme\nconst handleUpdateRequest=async requestData=>{if(!editingRequest)return;try{var _editingRequest$brand,_requestData$brand_id;// Değişiklikleri tespit et\nconst changes=[];if(editingRequest.first_name!==requestData.first_name){changes.push({field:'Ad',oldValue:editingRequest.first_name,newValue:requestData.first_name});}if(editingRequest.last_name!==requestData.last_name){changes.push({field:'Soyad',oldValue:editingRequest.last_name,newValue:requestData.last_name});}if(editingRequest.email!==requestData.email){changes.push({field:'E-posta',oldValue:editingRequest.email,newValue:requestData.email});}if(editingRequest.phone_number!==requestData.phone_number){changes.push({field:'Telefon',oldValue:editingRequest.phone_number||'Boş',newValue:requestData.phone_number||'Boş'});}if(editingRequest.role_id!==requestData.role_id){changes.push({field:'Rol ID',oldValue:editingRequest.role_id,newValue:requestData.role_id});}if(JSON.stringify((_editingRequest$brand=editingRequest.brand_ids)===null||_editingRequest$brand===void 0?void 0:_editingRequest$brand.sort())!==JSON.stringify((_requestData$brand_id=requestData.brand_ids)===null||_requestData$brand_id===void 0?void 0:_requestData$brand_id.sort())){changes.push({field:'Markalar',oldValue:editingRequest.brand_ids,newValue:requestData.brand_ids});}await employeeRequestsAPI.updateEmployeeRequest(editingRequest.id,requestData);// Audit log disabled - endpoint not available\n/*try {\n        await auditLogsAPI.createAuditLog({\n          action: AuditActions.EMPLOYEE_REQUEST_UPDATED,\n          resource_type: ResourceTypes.EMPLOYEE_REQUEST,\n          resource_id: editingRequest.id,\n          details: {\n            resource_name: `${requestData.first_name} ${requestData.last_name}`,\n            old_values: {\n              first_name: editingRequest.first_name,\n              last_name: editingRequest.last_name,\n              email: editingRequest.email,\n              phone_number: editingRequest.phone_number,\n              role_id: editingRequest.role_id,\n              brand_ids: editingRequest.brand_ids\n            },\n            new_values: requestData,\n            message: `${requestData.first_name} ${requestData.last_name} için çalışan talebi güncellendi${changes.length > 0 ? ` - Değişiklikler: ${changes.map(c => `${c.field}: ${c.oldValue} → ${c.newValue}`).join(', ')}` : ''}`\n          }\n        });\n      } catch (auditError) {\n        console.error('Audit log oluşturulamadı:', auditError);\n      }*/toast.success('Talep başarıyla güncellendi');setShowEditModal(false);setEditingRequest(null);loadRequests();}catch(error){var _error$response4,_error$response4$data;toast.error(((_error$response4=error.response)===null||_error$response4===void 0?void 0:(_error$response4$data=_error$response4.data)===null||_error$response4$data===void 0?void 0:_error$response4$data.detail)||'Talep güncellenemedi');}};const getStatusColor=status=>{switch(status){case'pending':return'bg-yellow-100 text-yellow-800';case'approved':return'bg-green-100 text-green-800';case'rejected':return'bg-red-100 text-red-800';default:return'bg-gray-100 text-gray-800';}};// const getStatusTextLocal = (status: string) => {\n//   return getStatusText(status);\n// };\nconst getStatusIcon=status=>{switch(status){case'pending':return/*#__PURE__*/_jsx(Clock,{size:16});case'approved':return/*#__PURE__*/_jsx(Check,{size:16});case'rejected':return/*#__PURE__*/_jsx(X,{size:16});default:return/*#__PURE__*/_jsx(Clock,{size:16});}};// Loading state\nif(authLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center min-h-screen\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500\"})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-gray-900\",children:getTitle('employee_requests')}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:getDescription('employee_requests')})]}),(currentUser===null||currentUser===void 0?void 0:(_currentUser$permissi=currentUser.permissions)===null||_currentUser$permissi===void 0?void 0:_currentUser$permissi.includes('employee_requests.manage'))&&/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowCreateModal(true),className:\"btn btn-primary\",children:[/*#__PURE__*/_jsx(Plus,{size:18,className:\"mr-2\"}),getButtonText('add_employee_request')]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Durum\"}),/*#__PURE__*/_jsxs(\"select\",{value:statusFilter,onChange:e=>setStatusFilter(e.target.value),className:\"form-input\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"T\\xFCm Durumlar\"}),/*#__PURE__*/_jsx(\"option\",{value:\"pending\",children:\"Bekleyen\"}),/*#__PURE__*/_jsx(\"option\",{value:\"approved\",children:\"Onaylanan\"}),/*#__PURE__*/_jsx(\"option\",{value:\"rejected\",children:\"Reddedilen\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-end\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>setStatusFilter(''),className:\"btn btn-secondary\",children:\"Filtreleri Temizle\"})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[loading?/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center py-8\",children:/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"})}):/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"w-full\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{className:\"border-b\",children:[/*#__PURE__*/_jsx(\"th\",{className:\"text-left py-3 px-4 font-medium text-gray-900\",children:\"\\xC7al\\u0131\\u015Fan Bilgileri\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-left py-3 px-4 font-medium text-gray-900\",children:\"Rol\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-left py-3 px-4 font-medium text-gray-900\",children:\"Markalar\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-left py-3 px-4 font-medium text-gray-900\",children:\"Durum\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-left py-3 px-4 font-medium text-gray-900\",children:\"Talep Eden\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-left py-3 px-4 font-medium text-gray-900\",children:\"Tarih\"}),((currentUser===null||currentUser===void 0?void 0:currentUser.role)==='Super Admin'||(currentUser===null||currentUser===void 0?void 0:currentUser.role)==='Mağaza Yöneticisi')&&/*#__PURE__*/_jsx(\"th\",{className:\"text-left py-3 px-4 font-medium text-gray-900\",children:\"\\u0130\\u015Flemler\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:requests.map(request=>/*#__PURE__*/_jsxs(\"tr\",{className:\"border-b hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-8 w-8 bg-blue-100 rounded-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(User,{size:16,className:\"text-blue-600\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"font-medium text-gray-900\",children:[request.first_name,\" \",request.last_name]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600\",children:request.email}),request.phone_number&&/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500\",children:request.phone_number})]})]})}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",children:/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs\",children:request.role_name})}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-1\",children:request.brand_names.map(brandName=>/*#__PURE__*/_jsxs(\"span\",{className:\"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs flex items-center gap-1\",children:[/*#__PURE__*/_jsx(Building2,{size:12}),brandName]},brandName))})}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"px-2 py-1 rounded-full text-xs flex items-center gap-1 w-fit \".concat(getStatusColor(request.status)),children:[getStatusIcon(request.status),getStatusText(request.status)]})}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4 text-gray-600 text-sm\",children:request.requested_by_name}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4 text-gray-600 text-sm\",children:new Date(request.created_at).toLocaleDateString('tr-TR')}),(currentUser===null||currentUser===void 0?void 0:currentUser.role)==='Super Admin'&&/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-1\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleEditRequest(request),className:\"px-2 py-1 bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition-colors text-xs flex items-center gap-1\",title:\"Talebi d\\xFCzenle\",children:[/*#__PURE__*/_jsx(Edit,{size:12}),\"D\\xFCzenle\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{setSelectedRequest(request);setShowApprovalModal(true);},className:\"px-2 py-1 bg-gray-100 text-gray-600 rounded hover:bg-gray-200 transition-colors text-xs flex items-center gap-1\",title:\"Detaylar\\u0131 g\\xF6r\\xFCnt\\xFCle\",children:[/*#__PURE__*/_jsx(Search,{size:12}),\"Detay\"]})]})}),(currentUser===null||currentUser===void 0?void 0:currentUser.role)==='Mağaza Yöneticisi'&&/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{setSelectedRequest(request);setShowApprovalModal(true);},className:\"px-2 py-1 bg-gray-100 text-gray-600 rounded hover:bg-gray-200 transition-colors text-xs flex items-center gap-1\",title:\"Detaylar\\u0131 g\\xF6r\\xFCnt\\xFCle\",children:[/*#__PURE__*/_jsx(Search,{size:12}),\"Detay\"]})})]},request.id))})]})}),total>perPage&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mt-4 pt-4 border-t\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-600\",children:[total,\" talepten \",(page-1)*perPage+1,\"-\",Math.min(page*perPage,total),\" aras\\u0131 g\\xF6steriliyor\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setPage(page-1),disabled:page===1,className:\"btn btn-secondary disabled:opacity-50 disabled:cursor-not-allowed\",children:\"\\xD6nceki\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setPage(page+1),disabled:page*perPage>=total,className:\"btn btn-secondary disabled:opacity-50 disabled:cursor-not-allowed\",children:\"Sonraki\"})]})]})]}),showCreateModal&&/*#__PURE__*/_jsx(CreateRequestModal,{brands:brands.filter(brand=>{var _currentUser$brand_id;return currentUser===null||currentUser===void 0?void 0:(_currentUser$brand_id=currentUser.brand_ids)===null||_currentUser$brand_id===void 0?void 0:_currentUser$brand_id.includes(brand.id);}),onClose:()=>setShowCreateModal(false),onSave:handleCreateRequest,getButtonText:getButtonText}),showEditModal&&editingRequest&&/*#__PURE__*/_jsx(EditRequestModal,{request:editingRequest,brands:(()=>{// Super Admin ise talep sahibinin markalarını göster\nif((currentUser===null||currentUser===void 0?void 0:currentUser.role)==='Super Admin'){// Talep sahibinin yetkili olduğu markaları filtrele\nconst requestorBrands=brands.filter(brand=>{var _editingRequest$reque;return((_editingRequest$reque=editingRequest.requested_by_brand_ids)===null||_editingRequest$reque===void 0?void 0:_editingRequest$reque.includes(brand.id))||false;});// Eğer talep sahibinin markası bulunamazsa, tüm markaları göster (fallback)\nif(requestorBrands.length===0){console.warn('Talep sahibinin markası bulunamadı, tüm markalar gösteriliyor');return brands;}return requestorBrands;}// Diğer roller için sadece kendi markalarını göster\nreturn brands.filter(brand=>{var _currentUser$brand_id2;return(currentUser===null||currentUser===void 0?void 0:(_currentUser$brand_id2=currentUser.brand_ids)===null||_currentUser$brand_id2===void 0?void 0:_currentUser$brand_id2.includes(brand.id))||false;});})(),onClose:()=>{setShowEditModal(false);setEditingRequest(null);},onSave:handleUpdateRequest,currentUser:currentUser}),showApprovalModal&&selectedRequest&&/*#__PURE__*/_jsx(ApprovalModal,{request:selectedRequest,onClose:()=>{setShowApprovalModal(false);setSelectedRequest(null);},onApprove:handleApproveRequest,onReject:handleRejectRequest,currentUser:currentUser,getStatusText:getStatusText})]});};// Create Request Modal Component\nconst CreateRequestModal=_ref=>{let{brands,onClose,onSave,getButtonText}=_ref;const[roles,setRoles]=useState([]);const[loadingRoles,setLoadingRoles]=useState(true);const[formData,setFormData]=useState({email:'',first_name:'',last_name:'',phone_number:'',role_id:0,// Will be set after roles are loaded\nbrand_ids:[],request_message:''});// Load roles on mount\nuseEffect(()=>{const fetchRoles=async()=>{try{var _response$roles$;const response=await rolesAPI.getRoles();setRoles(response.roles);// Automatically set employee role - try multiple name patterns\nconst employeeRole=response.roles.find(r=>{var _r$display_name,_r$display_name2;return r.name==='store_employee'||((_r$display_name=r.display_name)===null||_r$display_name===void 0?void 0:_r$display_name.includes('Çalışan'))||((_r$display_name2=r.display_name)===null||_r$display_name2===void 0?void 0:_r$display_name2.includes('Employee'));});const defaultRoleId=(employeeRole===null||employeeRole===void 0?void 0:employeeRole.id)||((_response$roles$=response.roles[0])===null||_response$roles$===void 0?void 0:_response$roles$.id)||0;setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{role_id:defaultRoleId}));}catch(error){console.error('Roller yüklenemedi:',error);toast.error('Roller yüklenemedi');}finally{setLoadingRoles(false);}};fetchRoles();},[]);// Get employee role for display\nconst employeeRole=roles.find(r=>{var _r$display_name3,_r$display_name4;return r.name==='store_employee'||((_r$display_name3=r.display_name)===null||_r$display_name3===void 0?void 0:_r$display_name3.includes('Çalışan'))||((_r$display_name4=r.display_name)===null||_r$display_name4===void 0?void 0:_r$display_name4.includes('Employee'));});const handleChange=e=>{const{name,value}=e.target;setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:name==='role_id'?Number(value):value}));};const handleBrandChange=(brandId,checked)=>{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{brand_ids:checked?[...prev.brand_ids,brandId]:prev.brand_ids.filter(id=>id!==brandId)}));};const handleSubmit=async e=>{e.preventDefault();if(!formData.first_name||!formData.last_name||!formData.email){toast.error('Ad, soyad ve e-posta alanları zorunludur');return;}if(formData.brand_ids.length===0){toast.error('En az bir marka seçilmelidir');return;}await onSave(formData);};return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold mb-4\",children:\"\\xC7al\\u0131\\u015Fan Talep Et\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Ad\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"first_name\",value:formData.first_name,onChange:handleChange,className:\"form-input\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Soyad\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"last_name\",value:formData.last_name,onChange:handleChange,className:\"form-input\",required:true})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"E-posta\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",name:\"email\",value:formData.email,onChange:handleChange,className:\"form-input\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Telefon (Opsiyonel)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",name:\"phone_number\",value:formData.phone_number,onChange:handleChange,className:\"form-input\",placeholder:\"\\xD6rn: +90 555 123 45 67\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-blue-50 border border-blue-200 rounded-lg p-3\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(User,{className:\"h-4 w-4 text-blue-600\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-blue-800 font-medium\",children:[\"Rol: \",(employeeRole===null||employeeRole===void 0?void 0:employeeRole.display_name)||'Çalışan',\" (Otomatik)\"]})]})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"form-label\",children:[\"Markalar \",/*#__PURE__*/_jsx(\"span\",{className:\"text-red-500\",children:\"*\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2 max-h-32 overflow-y-auto border rounded p-2\",children:brands.length>0?brands.map(brand=>/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:formData.brand_ids.includes(brand.id),onChange:e=>handleBrandChange(brand.id,e.target.checked),className:\"rounded\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:brand.name})]},brand.id)):/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500 p-2\",children:\"Size atanm\\u0131\\u015F marka bulunamad\\u0131. L\\xFCtfen sistem y\\xF6neticisi ile ileti\\u015Fime ge\\xE7in.\"})}),formData.brand_ids.length===0&&/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-red-500 mt-1\",children:\"En az bir marka se\\xE7ilmelidir.\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Talep Mesaj\\u0131 (Opsiyonel)\"}),/*#__PURE__*/_jsx(\"textarea\",{name:\"request_message\",value:formData.request_message,onChange:handleChange,className:\"form-input\",rows:3,placeholder:\"Bu \\xE7al\\u0131\\u015Fan hakk\\u0131nda ek bilgi...\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 pt-4\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary flex-1\",children:getButtonText('add_employee_request')}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:onClose,className:\"btn btn-secondary\",children:\"\\u0130ptal\"})]})]})]})})});};// Approval Modal Component\nconst ApprovalModal=_ref2=>{let{request,onClose,onApprove,onReject,currentUser,getStatusText}=_ref2;const[adminNotes,setAdminNotes]=useState('');const handleSubmit=async e=>{e.preventDefault();await onApprove(request.id,adminNotes);};const getStatusColor=status=>{switch(status){case'pending':return'bg-yellow-100 text-yellow-800';case'approved':return'bg-green-100 text-green-800';case'rejected':return'bg-red-100 text-red-800';default:return'bg-gray-100 text-gray-800';}};// const getStatusTextLocal = (status: string) => {\n//   return getStatusText(status);\n// };\nconst getStatusIcon=status=>{switch(status){case'pending':return/*#__PURE__*/_jsx(Clock,{size:16});case'approved':return/*#__PURE__*/_jsx(Check,{size:16});case'rejected':return/*#__PURE__*/_jsx(X,{size:16});default:return/*#__PURE__*/_jsx(Clock,{size:16});}};return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-lg max-w-md w-full\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold mb-4\",children:\"Talep \\u0130nceleme\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4 mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium text-gray-900\",children:\"\\xC7al\\u0131\\u015Fan Bilgileri\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600\",children:[request.first_name,\" \",request.last_name,\" (\",request.email,\")\"]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium text-gray-900\",children:\"Rol\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:request.role_name})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium text-gray-900\",children:\"Markalar\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:request.brand_names.join(', ')})]}),request.request_message&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium text-gray-900\",children:\"Talep Mesaj\\u0131\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:request.request_message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium text-gray-900\",children:\"Talep Eden\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:request.requested_by_name})]}),request.admin_notes&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium text-gray-900\",children:request.status==='rejected'?'Red Nedeni':'Admin Notları'}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm p-3 rounded-lg \".concat(request.status==='rejected'?'text-red-700 bg-red-50 border border-red-200':'text-gray-600 bg-gray-50'),children:request.admin_notes})]}),request.status!=='pending'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium text-gray-900\",children:\"Durum\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"px-2 py-1 rounded-full text-xs flex items-center gap-1 w-fit \".concat(getStatusColor(request.status)),children:[getStatusIcon(request.status),getStatusText(request.status)]})]})]}),(currentUser===null||currentUser===void 0?void 0:currentUser.role)==='Super Admin'?/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Admin Notlar\\u0131\"}),/*#__PURE__*/_jsx(\"textarea\",{value:adminNotes,onChange:e=>setAdminNotes(e.target.value),className:\"form-input\",rows:3,placeholder:\"Onay/red nedeni veya ek notlar...\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[request.status==='pending'?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"button\",{onClick:handleSubmit,className:\"btn btn-success flex-1\",children:[/*#__PURE__*/_jsx(Check,{size:16,className:\"mr-2\"}),\"Onayla\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{if(adminNotes.trim()){onReject(request.id,adminNotes);}else{// Admin notları boşsa uyarı ver\nalert('Reddetme nedeni belirtmelisiniz!');}},className:\"btn btn-danger flex-1\",children:[/*#__PURE__*/_jsx(X,{size:16,className:\"mr-2\"}),\"Reddet\"]})]}):/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 text-center\",children:/*#__PURE__*/_jsx(\"span\",{className:\"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium \".concat(request.status==='approved'?'bg-green-100 text-green-800':'bg-red-100 text-red-800'),children:request.status==='approved'?'Onaylandı':'Reddedildi'})}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:onClose,className:\"btn btn-secondary\",children:\"Kapat\"})]})]}):/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-end\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:onClose,className:\"btn btn-secondary\",children:\"Kapat\"})})]})})});};// Edit Request Modal Component\nconst EditRequestModal=_ref3=>{let{request,brands,onClose,onSave,currentUser}=_ref3;const[roles,setRoles]=useState([]);const[loadingRoles,setLoadingRoles]=useState(true);const[formData,setFormData]=useState({email:request.email||'',first_name:request.first_name||'',last_name:request.last_name||'',phone_number:request.phone_number||'',role_id:request.role_id||0,// Use request's role_id, will be updated if needed\nbrand_ids:request.brand_ids||[],request_message:request.request_message||''});// Load roles on mount\nuseEffect(()=>{const fetchRoles=async()=>{try{const response=await rolesAPI.getRoles();setRoles(response.roles);// If role_id is 0 or invalid, set default\nif(!request.role_id||request.role_id===0){var _response$roles$2;const employeeRole=response.roles.find(r=>{var _r$display_name5,_r$display_name6;return r.name==='store_employee'||((_r$display_name5=r.display_name)===null||_r$display_name5===void 0?void 0:_r$display_name5.includes('Çalışan'))||((_r$display_name6=r.display_name)===null||_r$display_name6===void 0?void 0:_r$display_name6.includes('Employee'));});const defaultRoleId=(employeeRole===null||employeeRole===void 0?void 0:employeeRole.id)||((_response$roles$2=response.roles[0])===null||_response$roles$2===void 0?void 0:_response$roles$2.id)||0;setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{role_id:defaultRoleId}));}}catch(error){console.error('Roller yüklenemedi:',error);toast.error('Roller yüklenemedi');}finally{setLoadingRoles(false);}};fetchRoles();},[request.role_id]);const handleChange=e=>{const{name,value}=e.target;setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:name==='role_id'?Number(value):value}));};const handleBrandChange=(brandId,checked)=>{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{brand_ids:checked?[...prev.brand_ids,brandId]:prev.brand_ids.filter(id=>id!==brandId)}));};const handleSubmit=async e=>{e.preventDefault();if(!formData.first_name||!formData.last_name||!formData.email){toast.error('Ad, soyad ve e-posta alanları zorunludur');return;}if(formData.brand_ids.length===0){toast.error('En az bir marka seçilmelidir');return;}await onSave(formData);};return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold mb-4\",children:\"Talep D\\xFCzenle\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Ad\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"first_name\",value:formData.first_name,onChange:handleChange,className:\"form-input\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Soyad\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"last_name\",value:formData.last_name,onChange:handleChange,className:\"form-input\",required:true})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"E-posta\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",name:\"email\",value:formData.email,onChange:handleChange,className:\"form-input\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Telefon (Opsiyonel)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",name:\"phone_number\",value:formData.phone_number,onChange:handleChange,className:\"form-input\",placeholder:\"\\xD6rn: +90 555 123 45 67\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Rol\"}),/*#__PURE__*/_jsx(\"select\",{name:\"role_id\",value:formData.role_id,onChange:handleChange,className:\"form-input\",required:true,children:roles.length>0?roles.map(role=>/*#__PURE__*/_jsx(\"option\",{value:role.id,children:role.display_name},role.id)):/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Rol y\\xFCkleniyor...\"})})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"form-label\",children:[\"Markalar \",/*#__PURE__*/_jsx(\"span\",{className:\"text-red-500\",children:\"*\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2 max-h-32 overflow-y-auto border rounded p-2\",children:brands.length>0?brands.map(brand=>/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:formData.brand_ids.includes(brand.id),onChange:e=>handleBrandChange(brand.id,e.target.checked),className:\"rounded\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:brand.name})]},brand.id)):/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500 p-2\",children:(()=>{if((currentUser===null||currentUser===void 0?void 0:currentUser.role)==='Super Admin'){return'Talep sahibinin erişebileceği marka bulunamadı. Sistem yöneticisi olarak tüm markalar gösterilmektedir.';}return'Size atanmış marka bulunamadı. Lütfen sistem yöneticisi ile iletişime geçin.';})()})}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-blue-600 mt-1\",children:\"\\uD83D\\uDCA1 Sadece talep sahibinin yetkili oldu\\u011Fu markalar g\\xF6sterilmektedir.\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Talep Mesaj\\u0131 (Sadece G\\xF6r\\xFCnt\\xFCleme)\"}),/*#__PURE__*/_jsx(\"textarea\",{name:\"request_message\",value:formData.request_message,readOnly:true,className:\"form-input bg-gray-50 cursor-not-allowed\",rows:3,placeholder:formData.request_message||\"Talep mesajı yok\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1\",children:\"\\uD83D\\uDCA1 Bu mesaj ma\\u011Faza y\\xF6neticisi taraf\\u0131ndan yaz\\u0131lm\\u0131\\u015Ft\\u0131r ve de\\u011Fi\\u015Ftirilemez.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 pt-4\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary flex-1\",children:\"G\\xFCncelle\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:onClose,className:\"btn btn-secondary\",children:\"\\u0130ptal\"})]})]})]})})});};export default EmployeeRequests;","map":{"version":3,"names":["React","useState","useEffect","employeeRequestsAPI","brandsAPI","rolesAPI","useAuth","Plus","Search","Check","X","Clock","User","Building2","Edit","usePageTexts","toast","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","EmployeeRequests","_currentUser$permissi","user","currentUser","loading","authLoading","getTitle","getDescription","getButtonText","getStatusText","requests","setRequests","brands","setBrands","setLoading","page","setPage","total","setTotal","statusFilter","setStatusFilter","showCreateModal","setShowCreateModal","selectedRequest","setSelectedRequest","showApprovalModal","setShowApprovalModal","showEditModal","setShowEditModal","editingRequest","setEditingRequest","perPage","loadRequests","loadBrands","response","getEmployeeRequests","undefined","error","getBrands","handleCreateRequest","requestData","role_id","newRequest","createEmployeeRequest","success","window","dispatchEvent","CustomEvent","_error$response","_error$response$data","errorMessage","data","detail","console","includes","handleApproveRequest","requestId","adminNotes","request","find","r","id","oldStatus","status","approveEmployeeRequest","_error$response2","_error$response2$data","handleRejectRequest","rejectEmployeeRequest","_error$response3","_error$response3$data","handleEditRequest","handleUpdateRequest","_editingRequest$brand","_requestData$brand_id","changes","first_name","push","field","oldValue","newValue","last_name","email","phone_number","JSON","stringify","brand_ids","sort","updateEmployeeRequest","_error$response4","_error$response4$data","getStatusColor","getStatusIcon","size","className","children","permissions","onClick","value","onChange","e","target","role","map","role_name","brand_names","brandName","concat","requested_by_name","Date","created_at","toLocaleDateString","title","Math","min","disabled","CreateRequestModal","filter","brand","_currentUser$brand_id","onClose","onSave","EditRequestModal","requestorBrands","_editingRequest$reque","requested_by_brand_ids","length","warn","_currentUser$brand_id2","ApprovalModal","onApprove","onReject","_ref","roles","setRoles","loadingRoles","setLoadingRoles","formData","setFormData","request_message","fetchRoles","_response$roles$","getRoles","employeeRole","_r$display_name","_r$display_name2","name","display_name","defaultRoleId","prev","_objectSpread","_r$display_name3","_r$display_name4","handleChange","Number","handleBrandChange","brandId","checked","handleSubmit","preventDefault","onSubmit","type","required","placeholder","rows","_ref2","setAdminNotes","join","admin_notes","trim","alert","_ref3","_response$roles$2","_r$display_name5","_r$display_name6","readOnly"],"sources":["C:/Users/ilker/Desktop/aibrands/frontend/src/pages/admin/EmployeeRequests.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { employeeRequestsAPI, EmployeeRequest, EmployeeRequestCreate } from '../../api/employeeRequests';\nimport { brandsAPI, Brand } from '../../api/brands';\nimport { rolesAPI, Role } from '../../api/roles'; // Used in modals\n// import { auditLogsAPI, AuditActions, ResourceTypes } from '../../api/auditLogs'; // Disabled - endpoint not available\nimport { useAuth } from '../../hooks/useAuth';\nimport { Plus, Search, Check, X, Clock, User, Building2, Edit } from 'lucide-react';\nimport { usePageTexts } from '../../hooks/usePageTexts';\nimport toast from 'react-hot-toast';\n\nconst EmployeeRequests: React.FC = () => {\n  const { user: currentUser, loading: authLoading } = useAuth();\n  const { getTitle, getDescription, getButtonText, getStatusText } = usePageTexts();\n  const [requests, setRequests] = useState<EmployeeRequest[]>([]);\n  const [brands, setBrands] = useState<Brand[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [page, setPage] = useState(1);\n  const [total, setTotal] = useState(0);\n  const [statusFilter, setStatusFilter] = useState('');\n  const [showCreateModal, setShowCreateModal] = useState(false);\n  const [selectedRequest, setSelectedRequest] = useState<EmployeeRequest | null>(null);\n  const [showApprovalModal, setShowApprovalModal] = useState(false);\n  const [showEditModal, setShowEditModal] = useState(false);\n  const [editingRequest, setEditingRequest] = useState<EmployeeRequest | null>(null);\n  const perPage = 10;\n\n  useEffect(() => {\n    if (authLoading) return; // Wait for auth to complete\n    \n    loadRequests();\n    loadBrands();\n  }, [page, statusFilter, authLoading]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  const loadRequests = async () => {\n    try {\n      setLoading(true);\n      const response = await employeeRequestsAPI.getEmployeeRequests(page, perPage, statusFilter || undefined);\n      setRequests(response.requests);\n      setTotal(response.total);\n    } catch (error) {\n      toast.error('Talepler yüklenemedi');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const loadBrands = async () => {\n    try {\n      const response = await brandsAPI.getBrands(1, 100);\n      setBrands(response.brands);\n    } catch (error) {\n      // Ignore error for brands\n    }\n  };\n\n\n  const handleCreateRequest = async (requestData: EmployeeRequestCreate) => {\n    try {\n      // Validate role_id before sending\n      if (!requestData.role_id || requestData.role_id === 0) {\n        toast.error('Rol bilgisi yüklenemedi. Lütfen sayfayı yenileyin.');\n        return;\n      }\n      \n      const newRequest = await employeeRequestsAPI.createEmployeeRequest(requestData);\n      \n      // Audit log disabled - endpoint not available\n      /*try {\n        await auditLogsAPI.createAuditLog({\n          action: AuditActions.EMPLOYEE_REQUEST_CREATED,\n          resource_type: ResourceTypes.EMPLOYEE_REQUEST,\n          resource_id: newRequest.id,\n          details: {\n            resource_name: `${requestData.first_name} ${requestData.last_name}`,\n            new_values: requestData,\n            message: `${requestData.first_name} ${requestData.last_name} için çalışan talebi oluşturuldu`\n          }\n        });\n      } catch (auditError) {\n        console.error('Audit log oluşturulamadı:', auditError);\n      }*/\n\n      toast.success('Çalışan talebi başarıyla oluşturuldu');\n      setShowCreateModal(false);\n      loadRequests();\n      // Sidebar'daki sayacı güncelle\n      window.dispatchEvent(new CustomEvent('employeeRequestUpdated'));\n    } catch (error: any) {\n      const errorMessage = error.response?.data?.detail || 'Talep oluşturulamadı';\n      console.error('Employee request creation error:', error);\n      \n      // Check if it's a foreign key error (database inconsistency)\n      if (errorMessage.includes('Geçersiz rol ID') || errorMessage.includes('foreign key')) {\n        toast.error('Veritabanı tutarsızlığı tespit edildi. Lütfen sistem yöneticisine başvurun.');\n      } else {\n        toast.error(errorMessage);\n      }\n    }\n  };\n\n  const handleApproveRequest = async (requestId: number, adminNotes?: string) => {\n    try {\n      const request = requests.find(r => r.id === requestId);\n      const oldStatus = request?.status;\n      \n      await employeeRequestsAPI.approveEmployeeRequest(requestId, adminNotes);\n      \n      // Audit log disabled - endpoint not available\n      /*try {\n        await auditLogsAPI.createAuditLog({\n          action: AuditActions.EMPLOYEE_REQUEST_APPROVED,\n          resource_type: ResourceTypes.EMPLOYEE_REQUEST,\n          resource_id: requestId,\n          details: {\n            resource_name: request ? `${request.first_name} ${request.last_name}` : `Talep #${requestId}`,\n            old_values: { status: oldStatus, admin_notes: request?.admin_notes },\n            new_values: { status: 'approved', admin_notes: adminNotes },\n            message: `${request?.first_name} ${request?.last_name} için çalışan talebi onaylandı${adminNotes ? ` - Not: ${adminNotes}` : ''}`\n          }\n        });\n      } catch (auditError) {\n        console.error('Audit log oluşturulamadı:', auditError);\n      }*/\n\n      toast.success('Talep onaylandı ve çalışan oluşturuldu');\n      setShowApprovalModal(false);\n      setSelectedRequest(null);\n      loadRequests();\n      // Sidebar'daki sayacı güncelle\n      window.dispatchEvent(new CustomEvent('employeeRequestUpdated'));\n    } catch (error: any) {\n      toast.error(error.response?.data?.detail || 'Talep onaylanamadı');\n    }\n  };\n\n  const handleRejectRequest = async (requestId: number, adminNotes: string) => {\n    try {\n      const request = requests.find(r => r.id === requestId);\n      const oldStatus = request?.status;\n      \n      await employeeRequestsAPI.rejectEmployeeRequest(requestId, adminNotes);\n      \n      // Audit log disabled - endpoint not available\n      /*try {\n        await auditLogsAPI.createAuditLog({\n          action: AuditActions.EMPLOYEE_REQUEST_REJECTED,\n          resource_type: ResourceTypes.EMPLOYEE_REQUEST,\n          resource_id: requestId,\n          details: {\n            resource_name: request ? `${request.first_name} ${request.last_name}` : `Talep #${requestId}`,\n            old_values: { status: oldStatus, admin_notes: request?.admin_notes },\n            new_values: { status: 'rejected', admin_notes: adminNotes },\n            message: `${request?.first_name} ${request?.last_name} için çalışan talebi reddedildi - Sebep: ${adminNotes}`\n          }\n        });\n      } catch (auditError) {\n        console.error('Audit log oluşturulamadı:', auditError);\n      }*/\n\n      toast.success('Talep reddedildi');\n      setShowApprovalModal(false);\n      setSelectedRequest(null);\n      loadRequests();\n      // Sidebar'daki sayacı güncelle\n      window.dispatchEvent(new CustomEvent('employeeRequestUpdated'));\n    } catch (error: any) {\n      toast.error(error.response?.data?.detail || 'Talep reddedilemedi');\n    }\n  };\n\n  // Hızlı onaylama (admin notları olmadan)\n  // const handleQuickApprove = async (requestId: number) => {\n  //   if (!window.confirm('Bu talebi onaylamak istediğinizden emin misiniz? Otomatik olarak kullanıcı oluşturulacak ve şifre gönderilecektir.')) {\n  //     return;\n  //   }\n\n  //   try {\n  //     await employeeRequestsAPI.approveEmployeeRequest(requestId, 'Hızlı onay');\n  //     toast.success('Talep onaylandı! Kullanıcı oluşturuldu ve şifre gönderildi.');\n  //     loadRequests();\n  //     // Sidebar'daki sayacı güncelle\n  //     window.dispatchEvent(new CustomEvent('employeeRequestUpdated'));\n  //   } catch (error: any) {\n  //     toast.error(error.response?.data?.detail || 'Talep onaylanamadı');\n  //   }\n  // };\n\n  // Talep düzenleme\n  const handleEditRequest = (request: EmployeeRequest) => {\n    setEditingRequest(request);\n    setShowEditModal(true);\n  };\n\n  // Talep güncelleme\n  const handleUpdateRequest = async (requestData: EmployeeRequestCreate) => {\n    if (!editingRequest) return;\n\n    try {\n      // Değişiklikleri tespit et\n      const changes: Array<{field: string, oldValue: any, newValue: any}> = [];\n      \n      if (editingRequest.first_name !== requestData.first_name) {\n        changes.push({field: 'Ad', oldValue: editingRequest.first_name, newValue: requestData.first_name});\n      }\n      if (editingRequest.last_name !== requestData.last_name) {\n        changes.push({field: 'Soyad', oldValue: editingRequest.last_name, newValue: requestData.last_name});\n      }\n      if (editingRequest.email !== requestData.email) {\n        changes.push({field: 'E-posta', oldValue: editingRequest.email, newValue: requestData.email});\n      }\n      if (editingRequest.phone_number !== requestData.phone_number) {\n        changes.push({field: 'Telefon', oldValue: editingRequest.phone_number || 'Boş', newValue: requestData.phone_number || 'Boş'});\n      }\n      if (editingRequest.role_id !== requestData.role_id) {\n        changes.push({field: 'Rol ID', oldValue: editingRequest.role_id, newValue: requestData.role_id});\n      }\n      if (JSON.stringify(editingRequest.brand_ids?.sort()) !== JSON.stringify(requestData.brand_ids?.sort())) {\n        changes.push({field: 'Markalar', oldValue: editingRequest.brand_ids, newValue: requestData.brand_ids});\n      }\n\n      await employeeRequestsAPI.updateEmployeeRequest(editingRequest.id, requestData);\n      \n      // Audit log disabled - endpoint not available\n      /*try {\n        await auditLogsAPI.createAuditLog({\n          action: AuditActions.EMPLOYEE_REQUEST_UPDATED,\n          resource_type: ResourceTypes.EMPLOYEE_REQUEST,\n          resource_id: editingRequest.id,\n          details: {\n            resource_name: `${requestData.first_name} ${requestData.last_name}`,\n            old_values: {\n              first_name: editingRequest.first_name,\n              last_name: editingRequest.last_name,\n              email: editingRequest.email,\n              phone_number: editingRequest.phone_number,\n              role_id: editingRequest.role_id,\n              brand_ids: editingRequest.brand_ids\n            },\n            new_values: requestData,\n            message: `${requestData.first_name} ${requestData.last_name} için çalışan talebi güncellendi${changes.length > 0 ? ` - Değişiklikler: ${changes.map(c => `${c.field}: ${c.oldValue} → ${c.newValue}`).join(', ')}` : ''}`\n          }\n        });\n      } catch (auditError) {\n        console.error('Audit log oluşturulamadı:', auditError);\n      }*/\n\n      toast.success('Talep başarıyla güncellendi');\n      setShowEditModal(false);\n      setEditingRequest(null);\n      loadRequests();\n    } catch (error: any) {\n      toast.error(error.response?.data?.detail || 'Talep güncellenemedi');\n    }\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'pending':\n        return 'bg-yellow-100 text-yellow-800';\n      case 'approved':\n        return 'bg-green-100 text-green-800';\n      case 'rejected':\n        return 'bg-red-100 text-red-800';\n      default:\n        return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  // const getStatusTextLocal = (status: string) => {\n  //   return getStatusText(status);\n  // };\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'pending':\n        return <Clock size={16} />;\n      case 'approved':\n        return <Check size={16} />;\n      case 'rejected':\n        return <X size={16} />;\n      default:\n        return <Clock size={16} />;\n    }\n  };\n\n  // Loading state\n  if (authLoading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-gray-900\">\n{getTitle('employee_requests')}\n          </h1>\n          <p className=\"text-gray-600\">\n            {getDescription('employee_requests')}\n          </p>\n        </div>\n        {currentUser?.permissions?.includes('employee_requests.manage') && (\n          <button\n            onClick={() => setShowCreateModal(true)}\n            className=\"btn btn-primary\"\n          >\n            <Plus size={18} className=\"mr-2\" />\n            {getButtonText('add_employee_request')}\n          </button>\n        )}\n      </div>\n\n      {/* Filters */}\n      <div className=\"card\">\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n          <div>\n            <label className=\"form-label\">Durum</label>\n            <select\n              value={statusFilter}\n              onChange={(e) => setStatusFilter(e.target.value)}\n              className=\"form-input\"\n            >\n              <option value=\"\">Tüm Durumlar</option>\n              <option value=\"pending\">Bekleyen</option>\n              <option value=\"approved\">Onaylanan</option>\n              <option value=\"rejected\">Reddedilen</option>\n            </select>\n          </div>\n          \n          <div className=\"flex items-end\">\n            <button\n              onClick={() => setStatusFilter('')}\n              className=\"btn btn-secondary\"\n            >\n              Filtreleri Temizle\n            </button>\n          </div>\n        </div>\n      </div>\n\n      {/* Requests Table */}\n      <div className=\"card\">\n        {loading ? (\n          <div className=\"flex justify-center py-8\">\n            <div className=\"spinner\"></div>\n          </div>\n        ) : (\n          <div className=\"overflow-x-auto\">\n            <table className=\"w-full\">\n              <thead>\n                <tr className=\"border-b\">\n                  <th className=\"text-left py-3 px-4 font-medium text-gray-900\">Çalışan Bilgileri</th>\n                  <th className=\"text-left py-3 px-4 font-medium text-gray-900\">Rol</th>\n                  <th className=\"text-left py-3 px-4 font-medium text-gray-900\">Markalar</th>\n                  <th className=\"text-left py-3 px-4 font-medium text-gray-900\">Durum</th>\n                  <th className=\"text-left py-3 px-4 font-medium text-gray-900\">Talep Eden</th>\n                  <th className=\"text-left py-3 px-4 font-medium text-gray-900\">Tarih</th>\n                  {(currentUser?.role === 'Super Admin' || currentUser?.role === 'Mağaza Yöneticisi') && (\n                    <th className=\"text-left py-3 px-4 font-medium text-gray-900\">İşlemler</th>\n                  )}\n                </tr>\n              </thead>\n              <tbody>\n                {requests.map((request) => (\n                  <tr key={request.id} className=\"border-b hover:bg-gray-50\">\n                    <td className=\"py-3 px-4\">\n                      <div className=\"flex items-center gap-3\">\n                        <div className=\"h-8 w-8 bg-blue-100 rounded-full flex items-center justify-center\">\n                          <User size={16} className=\"text-blue-600\" />\n                        </div>\n                        <div>\n                          <div className=\"font-medium text-gray-900\">\n                            {request.first_name} {request.last_name}\n                          </div>\n                          <div className=\"text-sm text-gray-600\">{request.email}</div>\n                          {request.phone_number && (\n                            <div className=\"text-xs text-gray-500\">{request.phone_number}</div>\n                          )}\n                        </div>\n                      </div>\n                    </td>\n                    <td className=\"py-3 px-4\">\n                      <span className=\"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs\">\n                        {request.role_name}\n                      </span>\n                    </td>\n                    <td className=\"py-3 px-4\">\n                      <div className=\"flex flex-wrap gap-1\">\n                        {request.brand_names.map(brandName => (\n                          <span key={brandName} className=\"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs flex items-center gap-1\">\n                            <Building2 size={12} />\n                            {brandName}\n                          </span>\n                        ))}\n                      </div>\n                    </td>\n                    <td className=\"py-3 px-4\">\n                      <span className={`px-2 py-1 rounded-full text-xs flex items-center gap-1 w-fit ${getStatusColor(request.status)}`}>\n                        {getStatusIcon(request.status)}\n                        {getStatusText(request.status)}\n                      </span>\n                    </td>\n                    <td className=\"py-3 px-4 text-gray-600 text-sm\">\n                      {request.requested_by_name}\n                    </td>\n                    <td className=\"py-3 px-4 text-gray-600 text-sm\">\n                      {new Date(request.created_at).toLocaleDateString('tr-TR')}\n                    </td>\n                    {currentUser?.role === 'Super Admin' && (\n                      <td className=\"py-3 px-4\">\n                        <div className=\"flex items-center gap-1\">\n                          {/* Düzenleme butonu her zaman görünür */}\n                          <button\n                            onClick={() => handleEditRequest(request)}\n                            className=\"px-2 py-1 bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition-colors text-xs flex items-center gap-1\"\n                            title=\"Talebi düzenle\"\n                          >\n                            <Edit size={12} />\n                            Düzenle\n                          </button>\n                          \n                          {/* Detay görüntüleme butonu - onaylama/reddetme detay modal'ında yapılacak */}\n                          <button\n                            onClick={() => {\n                              setSelectedRequest(request);\n                              setShowApprovalModal(true);\n                            }}\n                            className=\"px-2 py-1 bg-gray-100 text-gray-600 rounded hover:bg-gray-200 transition-colors text-xs flex items-center gap-1\"\n                            title=\"Detayları görüntüle\"\n                          >\n                            <Search size={12} />\n                            Detay\n                          </button>\n                        </div>\n                      </td>\n                    )}\n                    {currentUser?.role === 'Mağaza Yöneticisi' && (\n                      <td className=\"py-3 px-4\">\n                        <button\n                          onClick={() => {\n                            setSelectedRequest(request);\n                            setShowApprovalModal(true);\n                          }}\n                          className=\"px-2 py-1 bg-gray-100 text-gray-600 rounded hover:bg-gray-200 transition-colors text-xs flex items-center gap-1\"\n                          title=\"Detayları görüntüle\"\n                        >\n                          <Search size={12} />\n                          Detay\n                        </button>\n                      </td>\n                    )}\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        )}\n\n        {/* Pagination */}\n        {total > perPage && (\n          <div className=\"flex justify-between items-center mt-4 pt-4 border-t\">\n            <div className=\"text-sm text-gray-600\">\n              {total} talepten {((page - 1) * perPage) + 1}-{Math.min(page * perPage, total)} arası gösteriliyor\n            </div>\n            <div className=\"flex gap-2\">\n              <button\n                onClick={() => setPage(page - 1)}\n                disabled={page === 1}\n                className=\"btn btn-secondary disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                Önceki\n              </button>\n              <button\n                onClick={() => setPage(page + 1)}\n                disabled={page * perPage >= total}\n                className=\"btn btn-secondary disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                Sonraki\n              </button>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Create Request Modal */}\n      {showCreateModal && (\n        <CreateRequestModal\n          brands={brands.filter(brand => currentUser?.brand_ids?.includes(brand.id))}\n          onClose={() => setShowCreateModal(false)}\n          onSave={handleCreateRequest}\n          getButtonText={getButtonText}\n        />\n      )}\n\n      {/* Edit Request Modal */}\n      {showEditModal && editingRequest && (\n        <EditRequestModal\n          request={editingRequest}\n          brands={(() => {\n            // Super Admin ise talep sahibinin markalarını göster\n            if (currentUser?.role === 'Super Admin') {\n              // Talep sahibinin yetkili olduğu markaları filtrele\n              const requestorBrands = brands.filter(brand => \n                editingRequest.requested_by_brand_ids?.includes(brand.id) || false\n              );\n              \n              // Eğer talep sahibinin markası bulunamazsa, tüm markaları göster (fallback)\n              if (requestorBrands.length === 0) {\n                console.warn('Talep sahibinin markası bulunamadı, tüm markalar gösteriliyor');\n                return brands;\n              }\n              \n              return requestorBrands;\n            }\n            // Diğer roller için sadece kendi markalarını göster\n            return brands.filter(brand => \n              currentUser?.brand_ids?.includes(brand.id) || false\n            );\n          })()}\n          onClose={() => {\n            setShowEditModal(false);\n            setEditingRequest(null);\n          }}\n          onSave={handleUpdateRequest}\n          currentUser={currentUser}\n        />\n      )}\n\n      {/* Approval Modal */}\n      {showApprovalModal && selectedRequest && (\n        <ApprovalModal\n          request={selectedRequest}\n          onClose={() => {\n            setShowApprovalModal(false);\n            setSelectedRequest(null);\n          }}\n          onApprove={handleApproveRequest}\n          onReject={handleRejectRequest}\n          currentUser={currentUser}\n          getStatusText={getStatusText}\n        />\n      )}\n\n    </div>\n  );\n};\n\n// Create Request Modal Component\ninterface CreateRequestModalProps {\n  brands: Brand[];\n  onClose: () => void;\n  onSave: (requestData: EmployeeRequestCreate) => Promise<void>;\n  getButtonText: (key: string) => string;\n}\n\nconst CreateRequestModal: React.FC<CreateRequestModalProps> = ({ brands, onClose, onSave, getButtonText }) => {\n  const [roles, setRoles] = useState<Role[]>([]);\n  const [loadingRoles, setLoadingRoles] = useState(true);\n  \n  const [formData, setFormData] = useState({\n    email: '',\n    first_name: '',\n    last_name: '',\n    phone_number: '',\n    role_id: 0, // Will be set after roles are loaded\n    brand_ids: [] as number[],\n    request_message: '',\n  });\n  \n  // Load roles on mount\n  useEffect(() => {\n    const fetchRoles = async () => {\n      try {\n        const response = await rolesAPI.getRoles();\n        setRoles(response.roles);\n        \n        // Automatically set employee role - try multiple name patterns\n        const employeeRole = response.roles.find(r => \n          r.name === 'store_employee' || \n          r.display_name?.includes('Çalışan') ||\n          r.display_name?.includes('Employee')\n        );\n        const defaultRoleId = employeeRole?.id || response.roles[0]?.id || 0;\n        \n        setFormData(prev => ({\n          ...prev,\n          role_id: defaultRoleId\n        }));\n      } catch (error) {\n        console.error('Roller yüklenemedi:', error);\n        toast.error('Roller yüklenemedi');\n      } finally {\n        setLoadingRoles(false);\n      }\n    };\n    fetchRoles();\n  }, []);\n  \n  // Get employee role for display\n  const employeeRole = roles.find(r => \n    r.name === 'store_employee' || \n    r.display_name?.includes('Çalışan') ||\n    r.display_name?.includes('Employee')\n  );\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement>) => {\n    const { name, value } = e.target;\n    setFormData(prev => ({\n      ...prev,\n      [name]: name === 'role_id' ? Number(value) : value,\n    }));\n  };\n\n  const handleBrandChange = (brandId: number, checked: boolean) => {\n    setFormData(prev => ({\n      ...prev,\n      brand_ids: checked \n        ? [...prev.brand_ids, brandId]\n        : prev.brand_ids.filter(id => id !== brandId)\n    }));\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!formData.first_name || !formData.last_name || !formData.email) {\n      toast.error('Ad, soyad ve e-posta alanları zorunludur');\n      return;\n    }\n    \n    if (formData.brand_ids.length === 0) {\n      toast.error('En az bir marka seçilmelidir');\n      return;\n    }\n\n    await onSave(formData);\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\n      <div className=\"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto\">\n        <div className=\"p-6\">\n          <h2 className=\"text-xl font-bold mb-4\">Çalışan Talep Et</h2>\n          \n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div>\n                <label className=\"form-label\">Ad</label>\n                <input\n                  type=\"text\"\n                  name=\"first_name\"\n                  value={formData.first_name}\n                  onChange={handleChange}\n                  className=\"form-input\"\n                  required\n                />\n              </div>\n              <div>\n                <label className=\"form-label\">Soyad</label>\n                <input\n                  type=\"text\"\n                  name=\"last_name\"\n                  value={formData.last_name}\n                  onChange={handleChange}\n                  className=\"form-input\"\n                  required\n                />\n              </div>\n            </div>\n\n            <div>\n              <label className=\"form-label\">E-posta</label>\n              <input\n                type=\"email\"\n                name=\"email\"\n                value={formData.email}\n                onChange={handleChange}\n                className=\"form-input\"\n                required\n              />\n            </div>\n\n            <div>\n              <label className=\"form-label\">Telefon (Opsiyonel)</label>\n              <input\n                type=\"tel\"\n                name=\"phone_number\"\n                value={formData.phone_number}\n                onChange={handleChange}\n                className=\"form-input\"\n                placeholder=\"Örn: +90 555 123 45 67\"\n              />\n            </div>\n\n            {/* Rol otomatik olarak Mağaza Çalışanı atanacak */}\n            <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-3\">\n              <div className=\"flex items-center gap-2\">\n                <User className=\"h-4 w-4 text-blue-600\" />\n                <span className=\"text-sm text-blue-800 font-medium\">\n                  Rol: {employeeRole?.display_name || 'Çalışan'} (Otomatik)\n                </span>\n              </div>\n            </div>\n\n            <div>\n              <label className=\"form-label\">\n                Markalar <span className=\"text-red-500\">*</span>\n              </label>\n              <div className=\"space-y-2 max-h-32 overflow-y-auto border rounded p-2\">\n                {brands.length > 0 ? (\n                  brands.map(brand => (\n                    <label key={brand.id} className=\"flex items-center gap-2\">\n                      <input\n                        type=\"checkbox\"\n                        checked={formData.brand_ids.includes(brand.id)}\n                        onChange={(e) => handleBrandChange(brand.id, e.target.checked)}\n                        className=\"rounded\"\n                      />\n                      <span className=\"text-sm\">{brand.name}</span>\n                    </label>\n                  ))\n                ) : (\n                  <div className=\"text-sm text-gray-500 p-2\">\n                    Size atanmış marka bulunamadı. Lütfen sistem yöneticisi ile iletişime geçin.\n                  </div>\n                )}\n              </div>\n              {formData.brand_ids.length === 0 && (\n                <p className=\"text-xs text-red-500 mt-1\">\n                  En az bir marka seçilmelidir.\n                </p>\n              )}\n            </div>\n\n            <div>\n              <label className=\"form-label\">Talep Mesajı (Opsiyonel)</label>\n              <textarea\n                name=\"request_message\"\n                value={formData.request_message}\n                onChange={handleChange}\n                className=\"form-input\"\n                rows={3}\n                placeholder=\"Bu çalışan hakkında ek bilgi...\"\n              />\n            </div>\n\n            <div className=\"flex gap-2 pt-4\">\n              <button type=\"submit\" className=\"btn btn-primary flex-1\">\n    {getButtonText('add_employee_request')}\n              </button>\n              <button type=\"button\" onClick={onClose} className=\"btn btn-secondary\">\n                İptal\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  );\n};\n\n// Approval Modal Component\ninterface ApprovalModalProps {\n  request: EmployeeRequest;\n  onClose: () => void;\n  onApprove: (requestId: number, adminNotes?: string) => Promise<void>;\n  onReject: (requestId: number, adminNotes: string) => Promise<void>;\n  currentUser: any;\n  getStatusText: (key: string) => string;\n}\n\nconst ApprovalModal: React.FC<ApprovalModalProps> = ({ request, onClose, onApprove, onReject, currentUser, getStatusText }) => {\n  const [adminNotes, setAdminNotes] = useState('');\n  \n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    await onApprove(request.id, adminNotes);\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'pending':\n        return 'bg-yellow-100 text-yellow-800';\n      case 'approved':\n        return 'bg-green-100 text-green-800';\n      case 'rejected':\n        return 'bg-red-100 text-red-800';\n      default:\n        return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  // const getStatusTextLocal = (status: string) => {\n  //   return getStatusText(status);\n  // };\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'pending':\n        return <Clock size={16} />;\n      case 'approved':\n        return <Check size={16} />;\n      case 'rejected':\n        return <X size={16} />;\n      default:\n        return <Clock size={16} />;\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\n      <div className=\"bg-white rounded-lg max-w-md w-full\">\n        <div className=\"p-6\">\n          <h2 className=\"text-xl font-bold mb-4\">Talep İnceleme</h2>\n          \n          <div className=\"space-y-4 mb-6\">\n            <div>\n              <h3 className=\"font-medium text-gray-900\">Çalışan Bilgileri</h3>\n              <p className=\"text-sm text-gray-600\">\n                {request.first_name} {request.last_name} ({request.email})\n              </p>\n            </div>\n            \n            <div>\n              <h3 className=\"font-medium text-gray-900\">Rol</h3>\n              <p className=\"text-sm text-gray-600\">{request.role_name}</p>\n            </div>\n            \n            <div>\n              <h3 className=\"font-medium text-gray-900\">Markalar</h3>\n              <p className=\"text-sm text-gray-600\">{request.brand_names.join(', ')}</p>\n            </div>\n            \n            {request.request_message && (\n              <div>\n                <h3 className=\"font-medium text-gray-900\">Talep Mesajı</h3>\n                <p className=\"text-sm text-gray-600\">{request.request_message}</p>\n              </div>\n            )}\n            \n            <div>\n              <h3 className=\"font-medium text-gray-900\">Talep Eden</h3>\n              <p className=\"text-sm text-gray-600\">{request.requested_by_name}</p>\n            </div>\n            \n            {request.admin_notes && (\n              <div>\n                <h3 className=\"font-medium text-gray-900\">\n                  {request.status === 'rejected' ? 'Red Nedeni' : 'Admin Notları'}\n                </h3>\n                <div className={`text-sm p-3 rounded-lg ${\n                  request.status === 'rejected' \n                    ? 'text-red-700 bg-red-50 border border-red-200' \n                    : 'text-gray-600 bg-gray-50'\n                }`}>\n                  {request.admin_notes}\n                </div>\n              </div>\n            )}\n            \n            {request.status !== 'pending' && (\n              <div>\n                <h3 className=\"font-medium text-gray-900\">Durum</h3>\n                <span className={`px-2 py-1 rounded-full text-xs flex items-center gap-1 w-fit ${getStatusColor(request.status)}`}>\n                  {getStatusIcon(request.status)}\n                  {getStatusText(request.status)}\n                </span>\n              </div>\n            )}\n          </div>\n\n          {currentUser?.role === 'Super Admin' ? (\n            <div className=\"space-y-4\">\n              <div>\n                <label className=\"form-label\">Admin Notları</label>\n                <textarea\n                  value={adminNotes}\n                  onChange={(e) => setAdminNotes(e.target.value)}\n                  className=\"form-input\"\n                  rows={3}\n                  placeholder=\"Onay/red nedeni veya ek notlar...\"\n                />\n              </div>\n\n              <div className=\"flex gap-2\">\n                {/* Sadece bekleyen talepler için butonlar göster */}\n                {request.status === 'pending' ? (\n                  <>\n                    <button\n                      onClick={handleSubmit}\n                      className=\"btn btn-success flex-1\"\n                    >\n                      <Check size={16} className=\"mr-2\" />\n                      Onayla\n                    </button>\n                    \n                    <button\n                      onClick={() => {\n                        if (adminNotes.trim()) {\n                          onReject(request.id, adminNotes);\n                        } else {\n                          // Admin notları boşsa uyarı ver\n                          alert('Reddetme nedeni belirtmelisiniz!');\n                        }\n                      }}\n                      className=\"btn btn-danger flex-1\"\n                    >\n                      <X size={16} className=\"mr-2\" />\n                      Reddet\n                    </button>\n                  </>\n                ) : (\n                  <div className=\"flex-1 text-center\">\n                    <span className={`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${\n                      request.status === 'approved' \n                        ? 'bg-green-100 text-green-800' \n                        : 'bg-red-100 text-red-800'\n                    }`}>\n                      {request.status === 'approved' ? 'Onaylandı' : 'Reddedildi'}\n                    </span>\n                  </div>\n                )}\n                \n                <button type=\"button\" onClick={onClose} className=\"btn btn-secondary\">\n                  Kapat\n                </button>\n              </div>\n            </div>\n          ) : (\n            <div className=\"flex justify-end\">\n              <button type=\"button\" onClick={onClose} className=\"btn btn-secondary\">\n                Kapat\n              </button>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\n// Edit Request Modal Component\ninterface EditRequestModalProps {\n  request: EmployeeRequest;\n  brands: Brand[];\n  onClose: () => void;\n  onSave: (requestData: EmployeeRequestCreate) => Promise<void>;\n  currentUser: any;\n}\n\nconst EditRequestModal: React.FC<EditRequestModalProps> = ({ request, brands, onClose, onSave, currentUser }) => {\n  const [roles, setRoles] = useState<Role[]>([]);\n  const [loadingRoles, setLoadingRoles] = useState(true);\n  \n  const [formData, setFormData] = useState({\n    email: request.email || '',\n    first_name: request.first_name || '',\n    last_name: request.last_name || '',\n    phone_number: request.phone_number || '',\n    role_id: request.role_id || 0, // Use request's role_id, will be updated if needed\n    brand_ids: request.brand_ids || [] as number[],\n    request_message: request.request_message || '',\n  });\n  \n  // Load roles on mount\n  useEffect(() => {\n    const fetchRoles = async () => {\n      try {\n        const response = await rolesAPI.getRoles();\n        setRoles(response.roles);\n        \n        // If role_id is 0 or invalid, set default\n        if (!request.role_id || request.role_id === 0) {\n          const employeeRole = response.roles.find(r => \n            r.name === 'store_employee' || \n            r.display_name?.includes('Çalışan') ||\n            r.display_name?.includes('Employee')\n          );\n          const defaultRoleId = employeeRole?.id || response.roles[0]?.id || 0;\n          \n          setFormData(prev => ({\n            ...prev,\n            role_id: defaultRoleId\n          }));\n        }\n      } catch (error) {\n        console.error('Roller yüklenemedi:', error);\n        toast.error('Roller yüklenemedi');\n      } finally {\n        setLoadingRoles(false);\n      }\n    };\n    fetchRoles();\n  }, [request.role_id]);\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement>) => {\n    const { name, value } = e.target;\n    setFormData(prev => ({\n      ...prev,\n      [name]: name === 'role_id' ? Number(value) : value,\n    }));\n  };\n\n  const handleBrandChange = (brandId: number, checked: boolean) => {\n    setFormData(prev => ({\n      ...prev,\n      brand_ids: checked \n        ? [...prev.brand_ids, brandId]\n        : prev.brand_ids.filter(id => id !== brandId)\n    }));\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!formData.first_name || !formData.last_name || !formData.email) {\n      toast.error('Ad, soyad ve e-posta alanları zorunludur');\n      return;\n    }\n    \n    if (formData.brand_ids.length === 0) {\n      toast.error('En az bir marka seçilmelidir');\n      return;\n    }\n\n    await onSave(formData);\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\n      <div className=\"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto\">\n        <div className=\"p-6\">\n          <h2 className=\"text-xl font-bold mb-4\">Talep Düzenle</h2>\n          \n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div>\n                <label className=\"form-label\">Ad</label>\n                <input\n                  type=\"text\"\n                  name=\"first_name\"\n                  value={formData.first_name}\n                  onChange={handleChange}\n                  className=\"form-input\"\n                  required\n                />\n              </div>\n              <div>\n                <label className=\"form-label\">Soyad</label>\n                <input\n                  type=\"text\"\n                  name=\"last_name\"\n                  value={formData.last_name}\n                  onChange={handleChange}\n                  className=\"form-input\"\n                  required\n                />\n              </div>\n            </div>\n\n            <div>\n              <label className=\"form-label\">E-posta</label>\n              <input\n                type=\"email\"\n                name=\"email\"\n                value={formData.email}\n                onChange={handleChange}\n                className=\"form-input\"\n                required\n              />\n            </div>\n\n            <div>\n              <label className=\"form-label\">Telefon (Opsiyonel)</label>\n              <input\n                type=\"tel\"\n                name=\"phone_number\"\n                value={formData.phone_number}\n                onChange={handleChange}\n                className=\"form-input\"\n                placeholder=\"Örn: +90 555 123 45 67\"\n              />\n            </div>\n\n            <div>\n              <label className=\"form-label\">Rol</label>\n              <select\n                name=\"role_id\"\n                value={formData.role_id}\n                onChange={handleChange}\n                className=\"form-input\"\n                required\n              >\n                {roles.length > 0 ? (\n                  roles.map(role => (\n                    <option key={role.id} value={role.id}>\n                      {role.display_name}\n                    </option>\n                  ))\n                ) : (\n                  <option value=\"\">Rol yükleniyor...</option>\n                )}\n              </select>\n            </div>\n\n            <div>\n              <label className=\"form-label\">\n                Markalar <span className=\"text-red-500\">*</span>\n              </label>\n              <div className=\"space-y-2 max-h-32 overflow-y-auto border rounded p-2\">\n                {brands.length > 0 ? (\n                  brands.map(brand => (\n                    <label key={brand.id} className=\"flex items-center gap-2\">\n                      <input\n                        type=\"checkbox\"\n                        checked={formData.brand_ids.includes(brand.id)}\n                        onChange={(e) => handleBrandChange(brand.id, e.target.checked)}\n                        className=\"rounded\"\n                      />\n                      <span className=\"text-sm\">{brand.name}</span>\n                    </label>\n                  ))\n                ) : (\n                  <div className=\"text-sm text-gray-500 p-2\">\n                    {(() => {\n                      if (currentUser?.role === 'Super Admin') {\n                        return 'Talep sahibinin erişebileceği marka bulunamadı. Sistem yöneticisi olarak tüm markalar gösterilmektedir.';\n                      }\n                      return 'Size atanmış marka bulunamadı. Lütfen sistem yöneticisi ile iletişime geçin.';\n                    })()}\n                  </div>\n                )}\n              </div>\n              <p className=\"text-xs text-blue-600 mt-1\">\n                💡 Sadece talep sahibinin yetkili olduğu markalar gösterilmektedir.\n              </p>\n            </div>\n\n            <div>\n              <label className=\"form-label\">Talep Mesajı (Sadece Görüntüleme)</label>\n              <textarea\n                name=\"request_message\"\n                value={formData.request_message}\n                readOnly\n                className=\"form-input bg-gray-50 cursor-not-allowed\"\n                rows={3}\n                placeholder={formData.request_message || \"Talep mesajı yok\"}\n              />\n              <p className=\"text-xs text-gray-500 mt-1\">\n                💡 Bu mesaj mağaza yöneticisi tarafından yazılmıştır ve değiştirilemez.\n              </p>\n            </div>\n\n            <div className=\"flex gap-2 pt-4\">\n              <button type=\"submit\" className=\"btn btn-primary flex-1\">\n                Güncelle\n              </button>\n              <button type=\"button\" onClick={onClose} className=\"btn btn-secondary\">\n                İptal\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  );\n};\n\n\nexport default EmployeeRequests;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}