{"ast":null,"code":"import _objectSpread from\"C:/Users/ilker/Desktop/aibrands/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{usersAPI}from'../../api/users';import{brandsAPI}from'../../api/brands';import{rolesAPI}from'../../api/roles';import{useAuth}from'../../hooks/useAuth';import{Plus,Search,Edit,UserCheck,UserX}from'lucide-react';import toast from'react-hot-toast';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Users=()=>{const[users,setUsers]=useState([]);const[brands,setBrands]=useState([]);const[roles,setRoles]=useState([]);const[loading,setLoading]=useState(true);const[page,setPage]=useState(1);const[total,setTotal]=useState(0);const[searchTerm,setSearchTerm]=useState('');const[roleFilter,setRoleFilter]=useState('');const[brandFilter,setBrandFilter]=useState(null);const[onlyEmployees,setOnlyEmployees]=useState(false);const[showCreateModal,setShowCreateModal]=useState(false);const[editingUser,setEditingUser]=useState(null);const{user:currentUser,loading:authLoading}=useAuth();const perPage=10;const employeeRole=roles.find(r=>r.name==='market_personel');useEffect(()=>{if(authLoading)return;// Wait for auth to complete\nloadUsers();loadBrands();loadRoles();},[page,roleFilter,brandFilter,authLoading]);// eslint-disable-line react-hooks/exhaustive-deps\nuseEffect(()=>{// When toggling onlyEmployees, set/clear roleFilter accordingly\nif(onlyEmployees&&employeeRole){setRoleFilter(employeeRole.display_name);}else if(onlyEmployees&&!employeeRole){toast.error('Çalışan rolü bulunamadı');setOnlyEmployees(false);}else if(!onlyEmployees){setRoleFilter('');}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[onlyEmployees,employeeRole===null||employeeRole===void 0?void 0:employeeRole.id]);const loadUsers=async()=>{try{setLoading(true);const response=await usersAPI.getUsers(page,perPage,roleFilter||undefined,brandFilter||undefined);setUsers(response.users);setTotal(response.total);}catch(error){toast.error(error.message||'Kullanıcılar yüklenemedi');}finally{setLoading(false);}};const loadBrands=async()=>{try{const response=await brandsAPI.getBrands(1,1000);setBrands(response.brands);}catch(_unused){}};const loadRoles=async()=>{try{const response=await rolesAPI.getRoles();setRoles(response.roles);}catch(_unused2){}};const handleCreateUser=async userData=>{try{await usersAPI.createUser(userData);toast.success('Kullanıcı başarıyla oluşturuldu');setShowCreateModal(false);loadUsers();}catch(error){toast.error(error.message||'Kullanıcı oluşturulamadı');}};const handleUpdateUser=async userData=>{if(!editingUser)return;try{// Şifre değişikliği yapılıyorsa mail gönder, yapılmıyorsa gönderme\nconst hasPasswordChange=userData.password&&userData.password.trim()!=='';await usersAPI.updateUser(editingUser.id,userData,hasPasswordChange);toast.success('Kullanıcı başarıyla güncellendi');setEditingUser(null);loadUsers();}catch(error){toast.error(error.message||'Kullanıcı güncellenemedi');}};const handleUpdateUserSilent=async userData=>{if(!editingUser)return;try{await usersAPI.updateUser(editingUser.id,userData);setEditingUser(null);loadUsers();}catch(error){throw error;// Re-throw to be handled by caller\n}};const handleToggleUserStatus=async user=>{try{if(user.is_active){await usersAPI.deactivateUser(user.id);toast.success('Kullanıcı pasifleştirildi');}else{await usersAPI.activateUser(user.id);toast.success('Kullanıcı aktifleştirildi');}loadUsers();}catch(error){toast.error(error.message||'Kullanıcı durumu güncellenemedi');}};const displayedUsers=users.filter(u=>{if(!searchTerm)return true;const q=searchTerm.toLowerCase();return u.email.toLowerCase().includes(q)||u.first_name.toLowerCase().includes(q)||u.last_name.toLowerCase().includes(q);});// Loading state\nif(authLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center min-h-screen\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500\"})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-gray-900\",children:\"Kullan\\u0131c\\u0131lar\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Sistem kullan\\u0131c\\u0131lar\\u0131n\\u0131 ve \\xE7al\\u0131\\u015Fanlar\\u0131 y\\xF6netin\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowCreateModal(true),className:\"btn btn-primary\",children:[/*#__PURE__*/_jsx(Plus,{size:18,className:\"mr-2\"}),\"Kullan\\u0131c\\u0131 Ekle\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-5 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Arama\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Search,{className:\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),className:\"form-input pl-10\",placeholder:\"Kullan\\u0131c\\u0131larda ara...\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Rol\"}),/*#__PURE__*/_jsxs(\"select\",{value:roleFilter,onChange:e=>{setOnlyEmployees(false);setRoleFilter(e.target.value);},className:\"form-input\",disabled:onlyEmployees,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"T\\xFCm Roller\"}),roles.map(role=>/*#__PURE__*/_jsx(\"option\",{value:role.display_name,children:role.display_name},role.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Marka\"}),/*#__PURE__*/_jsxs(\"select\",{value:brandFilter||'',onChange:e=>setBrandFilter(e.target.value?Number(e.target.value):null),className:\"form-input\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"T\\xFCm Markalar\"}),brands.map(brand=>/*#__PURE__*/_jsx(\"option\",{value:brand.id,children:brand.name},brand.id))]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-end\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setSearchTerm('');setRoleFilter('');setBrandFilter(null);setOnlyEmployees(false);},className:\"btn btn-secondary w-full\",children:\"Filtreleri Temizle\"})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[loading?/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center py-8\",children:/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"})}):/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"w-full\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{className:\"border-b\",children:[/*#__PURE__*/_jsx(\"th\",{className:\"text-left py-3 px-4 font-medium text-gray-900\",children:\"Ad Soyad\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-left py-3 px-4 font-medium text-gray-900\",children:\"E-posta\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-left py-3 px-4 font-medium text-gray-900\",children:\"Rol\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-left py-3 px-4 font-medium text-gray-900\",children:\"Markalar\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-left py-3 px-4 font-medium text-gray-900\",children:\"Durum\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-left py-3 px-4 font-medium text-gray-900\",children:\"Son Giri\\u015F\"}),/*#__PURE__*/_jsx(\"th\",{className:\"text-left py-3 px-4 font-medium text-gray-900\",children:\"\\u0130\\u015Flemler\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:displayedUsers.map(user=>/*#__PURE__*/_jsxs(\"tr\",{className:\"border-b hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-8 w-8 bg-blue-100 rounded-full flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm font-medium text-blue-600\",children:[user.first_name[0],user.last_name[0]]})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"font-medium text-gray-900\",children:[user.first_name,\" \",user.last_name]}),user.is_2fa_enabled&&/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-green-600\",children:\"2FA Aktif\"})]})]})}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4 text-gray-600\",children:user.email}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",children:/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs\",children:user.role})}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",children:user.brand_ids&&user.brand_ids.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-1\",children:user.brand_ids.map(brandId=>{const brand=brands.find(b=>b.id===brandId);return/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs\",children:(brand===null||brand===void 0?void 0:brand.name)||\"Brand #\".concat(brandId)},brandId);})}):/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-400 text-sm\",children:\"Marka yok\"})}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",children:/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 rounded-full text-xs \".concat(user.is_active?'bg-green-100 text-green-800':'bg-red-100 text-red-800'),children:user.is_active?'Aktif':'Pasif'})}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4 text-gray-600 text-sm\",children:user.last_login?new Date(user.last_login).toLocaleDateString('tr-TR'):'Hiç'}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setEditingUser(user),className:\"p-1 text-gray-400 hover:text-blue-600\",title:\"Kullan\\u0131c\\u0131y\\u0131 d\\xFCzenle\",children:/*#__PURE__*/_jsx(Edit,{size:16})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleToggleUserStatus(user),className:\"p-1 \".concat(user.is_active?'text-gray-400 hover:text-red-600':'text-gray-400 hover:text-green-600'),title:user.is_active?'Kullanıcıyı pasifleştir':'Kullanıcıyı aktifleştir',children:user.is_active?/*#__PURE__*/_jsx(UserX,{size:16}):/*#__PURE__*/_jsx(UserCheck,{size:16})})]})})]},user.id))})]})}),total>perPage&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mt-4 pt-4 border-t\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-600\",children:[total,\" kullan\\u0131c\\u0131dan \",(page-1)*perPage+1,\"-\",Math.min(page*perPage,total),\" aras\\u0131 g\\xF6steriliyor\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setPage(page-1),disabled:page===1,className:\"btn btn-secondary disabled:opacity-50 disabled:cursor-not-allowed\",children:\"\\xD6nceki\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setPage(page+1),disabled:page*perPage>=total,className:\"btn btn-secondary disabled:opacity-50 disabled:cursor-not-allowed\",children:\"Sonraki\"})]})]})]}),(showCreateModal||editingUser)&&/*#__PURE__*/_jsx(UserModal,{user:editingUser,brands:brands,roles:roles,onClose:()=>{setShowCreateModal(false);setEditingUser(null);},onSave:editingUser?handleUpdateUser:handleCreateUser,onSaveSilent:handleUpdateUserSilent,currentUser:currentUser})]});};// User Modal Component remains unchanged\nconst UserModal=_ref=>{let{user,brands,roles,onClose,onSave,onSaveSilent,currentUser}=_ref;const[formData,setFormData]=useState({email:(user===null||user===void 0?void 0:user.email)||'',password:'',first_name:(user===null||user===void 0?void 0:user.first_name)||'',last_name:(user===null||user===void 0?void 0:user.last_name)||'',role_id:(user===null||user===void 0?void 0:user.role_id)||undefined,brand_ids:(user===null||user===void 0?void 0:user.brand_ids)||[]});// Şifre değişikliği için state'ler\nconst[passwordData,setPasswordData]=useState({currentPassword:'',newPassword:''});const[showPasswordFields,setShowPasswordFields]=useState(false);const[isSubmitting,setIsSubmitting]=useState(false);// Update form data when user prop changes\nuseEffect(()=>{if(user){setFormData({email:user.email||'',password:'',first_name:user.first_name||'',last_name:user.last_name||'',role_id:user.role_id||undefined,brand_ids:user.brand_ids||[]});// Kullanıcı kendi hesabını düzenliyorsa şifre alanlarını göster\nif(currentUser&&currentUser.id===user.id){setShowPasswordFields(true);}else{setShowPasswordFields(false);}}},[user,currentUser]);const selectedRole=roles.find(r=>r.id===formData.role_id);const isSuperAdmin=(selectedRole===null||selectedRole===void 0?void 0:selectedRole.name)==='super_admin';const isBrandManager=(selectedRole===null||selectedRole===void 0?void 0:selectedRole.name)==='brand_manager';const isMarketManager=(selectedRole===null||selectedRole===void 0?void 0:selectedRole.name)==='market_manager';const isEmployeeRole=!!selectedRole&&!isSuperAdmin&&!isBrandManager&&!isMarketManager;const handleChange=e=>{const{name,value}=e.target;setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:name==='role_id'?Number(value):value}));};// Şifre alanlarını güncelleyen fonksiyon\nconst handlePasswordChange=e=>{const{name,value}=e.target;setPasswordData(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:value}));};const handleBrandToggle=(brandId,checked)=>{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{brand_ids:checked?[...prev.brand_ids,brandId]:prev.brand_ids.filter(id=>id!==brandId)}));};const handleSubmit=async e=>{e.preventDefault();setIsSubmitting(true);try{if(!user&&!formData.password){toast.error('Password is required for new users');return;}if(!formData.role_id){toast.error('Rol seçiniz');return;}// Require at least one brand for brand managers and employees\nif((isBrandManager||isEmployeeRole)&&(!formData.brand_ids||formData.brand_ids.length===0)){toast.error(isBrandManager?'Yönetici için en az bir marka seçiniz':'Çalışan için en az bir marka seçiniz');return;}// Kullanıcı kendi şifresini değiştiriyorsa\nif(user&&showPasswordFields){// Şifre değişikliği yapılacaksa, mevcut ve yeni şifre alanlarını kontrol et\nif(passwordData.newPassword){if(!passwordData.currentPassword){toast.error('Mevcut şifrenizi giriniz');return;}try{// Sadece şifre değişikliğini yap (kullanıcı bilgileri güncellenmesin)\nawait usersAPI.updatePassword(user.id,{current_password:passwordData.currentPassword,new_password:passwordData.newPassword});toast.success('Şifre başarıyla güncellendi');setPasswordData({currentPassword:'',newPassword:''});// Şifre değişikliği sonrası kullanıcıyı logout yap\nif(currentUser&&currentUser.id===user.id){// Kendi şifresini değiştirdiyse logout yap\nlocalStorage.removeItem('access_token');localStorage.removeItem('refresh_token');window.location.href='/login';return;}onClose();}catch(error){toast.error(error.message||'Şifre güncellenemedi');}return;}}// Admin başka bir kullanıcının şifresini sıfırlıyorsa\nif(user&&!showPasswordFields){// Şifre değişikliği yapılacaksa\nif(passwordData.newPassword){try{// Sadece admin şifre sıfırlaması yap (kullanıcı bilgileri güncellenmesin)\nawait usersAPI.updatePassword(user.id,{new_password:passwordData.newPassword});toast.success('Şifre başarıyla güncellendi');setPasswordData({currentPassword:'',newPassword:''});onClose();}catch(error){toast.error(error.message||'Şifre güncellenemedi');}return;}}// Şifre değişikliği yapılmıyorsa, sadece kullanıcı bilgilerini güncelle\nconst payload=_objectSpread({},formData);if(user){delete payload.password;}await onSave(payload);onClose();}finally{setIsSubmitting(false);}};return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold mb-4\",children:user?'Kullanıcıyı Düzenle':'Kullanıcı Oluştur'}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Ad\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"first_name\",value:formData.first_name,onChange:handleChange,className:\"form-input\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Soyad\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"last_name\",value:formData.last_name,onChange:handleChange,className:\"form-input\",required:true})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"E-posta\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",name:\"email\",value:formData.email,onChange:handleChange,className:\"form-input\",required:true})]}),!user&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"\\u015Eifre\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"password\",value:formData.password,onChange:handleChange,className:\"form-input\",required:true})]}),showPasswordFields&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Mevcut \\u015Eifre\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"currentPassword\",value:passwordData.currentPassword,onChange:handlePasswordChange,className:\"form-input\",required:!!passwordData.newPassword// Yeni şifre girildiyse mevcut şifre gerekli\n})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Yeni \\u015Eifre\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"newPassword\",value:passwordData.newPassword,onChange:handlePasswordChange,className:\"form-input\"})]})]}),!showPasswordFields&&user&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Yeni \\u015Eifre (Kullan\\u0131c\\u0131 i\\xE7in s\\u0131f\\u0131rla)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"newPassword\",value:passwordData.newPassword,onChange:handlePasswordChange,className:\"form-input\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Rol\"}),/*#__PURE__*/_jsxs(\"select\",{name:\"role_id\",value:formData.role_id||'',onChange:handleChange,className:\"form-input\",required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Rol Se\\xE7in\"}),roles.map(r=>/*#__PURE__*/_jsx(\"option\",{value:r.id,children:r.display_name},r.id))]})]}),(isBrandManager||isMarketManager||isEmployeeRole)&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Markalar\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2 max-h-32 overflow-y-auto border rounded p-2\",children:brands.map(brand=>/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:formData.brand_ids.includes(brand.id),onChange:e=>handleBrandToggle(brand.id,e.target.checked),className:\"rounded\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:brand.name})]},brand.id))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 pt-4\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary flex-1\",disabled:isSubmitting,children:isSubmitting?'İşleniyor...':user?'Kullanıcıyı Güncelle':'Kullanıcı Oluştur'}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:onClose,className:\"btn btn-secondary\",children:\"\\u0130ptal\"})]})]})]})})});};export default Users;","map":{"version":3,"names":["React","useState","useEffect","usersAPI","brandsAPI","rolesAPI","useAuth","Plus","Search","Edit","UserCheck","UserX","toast","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Users","users","setUsers","brands","setBrands","roles","setRoles","loading","setLoading","page","setPage","total","setTotal","searchTerm","setSearchTerm","roleFilter","setRoleFilter","brandFilter","setBrandFilter","onlyEmployees","setOnlyEmployees","showCreateModal","setShowCreateModal","editingUser","setEditingUser","user","currentUser","authLoading","perPage","employeeRole","find","r","name","loadUsers","loadBrands","loadRoles","display_name","error","id","response","getUsers","undefined","message","getBrands","_unused","getRoles","_unused2","handleCreateUser","userData","createUser","success","handleUpdateUser","hasPasswordChange","password","trim","updateUser","handleUpdateUserSilent","handleToggleUserStatus","is_active","deactivateUser","activateUser","displayedUsers","filter","u","q","toLowerCase","email","includes","first_name","last_name","className","children","onClick","size","type","value","onChange","e","target","placeholder","disabled","map","role","Number","brand","is_2fa_enabled","brand_ids","length","brandId","b","concat","last_login","Date","toLocaleDateString","title","Math","min","UserModal","onClose","onSave","onSaveSilent","_ref","formData","setFormData","role_id","passwordData","setPasswordData","currentPassword","newPassword","showPasswordFields","setShowPasswordFields","isSubmitting","setIsSubmitting","selectedRole","isSuperAdmin","isBrandManager","isMarketManager","isEmployeeRole","handleChange","prev","_objectSpread","handlePasswordChange","handleBrandToggle","checked","handleSubmit","preventDefault","updatePassword","current_password","new_password","localStorage","removeItem","window","location","href","payload","onSubmit","required"],"sources":["C:/Users/ilker/Desktop/aibrands/frontend/src/pages/admin/Users.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { usersAPI, User, UserCreate } from '../../api/users';\nimport { User as AuthUser } from '../../api/auth';\nimport { brandsAPI, Brand } from '../../api/brands';\nimport { rolesAPI, Role } from '../../api/roles';\nimport { useAuth } from '../../hooks/useAuth';\nimport { Plus, Search, Edit, UserCheck, UserX } from 'lucide-react';\nimport toast from 'react-hot-toast';\n\nconst Users: React.FC = () => {\n  const [users, setUsers] = useState<User[]>([]);\n  const [brands, setBrands] = useState<Brand[]>([]);\n  const [roles, setRoles] = useState<Role[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [page, setPage] = useState(1);\n  const [total, setTotal] = useState(0);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [roleFilter, setRoleFilter] = useState('');\n  const [brandFilter, setBrandFilter] = useState<number | null>(null);\n  const [onlyEmployees, setOnlyEmployees] = useState(false);\n  const [showCreateModal, setShowCreateModal] = useState(false);\n  const [editingUser, setEditingUser] = useState<User | null>(null);\n  \n  const { user: currentUser, loading: authLoading } = useAuth();\n  const perPage = 10;\n\n  const employeeRole = roles.find(r => r.name === 'market_personel');\n\n  useEffect(() => {\n    if (authLoading) return; // Wait for auth to complete\n    \n    loadUsers();\n    loadBrands();\n    loadRoles();\n  }, [page, roleFilter, brandFilter, authLoading]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  useEffect(() => {\n    // When toggling onlyEmployees, set/clear roleFilter accordingly\n    if (onlyEmployees && employeeRole) {\n      setRoleFilter(employeeRole.display_name);\n    } else if (onlyEmployees && !employeeRole) {\n      toast.error('Çalışan rolü bulunamadı');\n      setOnlyEmployees(false);\n    } else if (!onlyEmployees) {\n      setRoleFilter('');\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [onlyEmployees, employeeRole?.id]);\n\n  const loadUsers = async () => {\n    try {\n      setLoading(true);\n      const response = await usersAPI.getUsers(page, perPage, roleFilter || undefined, brandFilter || undefined);\n      setUsers(response.users);\n      setTotal(response.total);\n    } catch (error: any) {\n      toast.error(error.message || 'Kullanıcılar yüklenemedi');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const loadBrands = async () => {\n    try {\n      const response = await brandsAPI.getBrands(1, 1000);\n      setBrands(response.brands);\n    } catch {}\n  };\n\n  const loadRoles = async () => {\n    try {\n      const response = await rolesAPI.getRoles();\n      setRoles(response.roles);\n    } catch {}\n  };\n\n  const handleCreateUser = async (userData: any) => {\n    try {\n      await usersAPI.createUser(userData as UserCreate);\n      toast.success('Kullanıcı başarıyla oluşturuldu');\n      setShowCreateModal(false);\n      loadUsers();\n    } catch (error: any) {\n      toast.error(error.message || 'Kullanıcı oluşturulamadı');\n    }\n  };\n\n  const handleUpdateUser = async (userData: any) => {\n    if (!editingUser) return;\n    try {\n      // Şifre değişikliği yapılıyorsa mail gönder, yapılmıyorsa gönderme\n      const hasPasswordChange = userData.password && userData.password.trim() !== '';\n      await usersAPI.updateUser(editingUser.id, userData, hasPasswordChange);\n      toast.success('Kullanıcı başarıyla güncellendi');\n      setEditingUser(null);\n      loadUsers();\n    } catch (error: any) {\n      toast.error(error.message || 'Kullanıcı güncellenemedi');\n    }\n  };\n\n  const handleUpdateUserSilent = async (userData: any) => {\n    if (!editingUser) return;\n    try {\n      await usersAPI.updateUser(editingUser.id, userData);\n      setEditingUser(null);\n      loadUsers();\n    } catch (error: any) {\n      throw error; // Re-throw to be handled by caller\n    }\n  };\n\n  const handleToggleUserStatus = async (user: User) => {\n    try {\n      if (user.is_active) {\n        await usersAPI.deactivateUser(user.id);\n        toast.success('Kullanıcı pasifleştirildi');\n      } else {\n        await usersAPI.activateUser(user.id);\n        toast.success('Kullanıcı aktifleştirildi');\n      }\n      loadUsers();\n    } catch (error: any) {\n      toast.error(error.message || 'Kullanıcı durumu güncellenemedi');\n    }\n  };\n\n\n  const displayedUsers = users.filter(u => {\n    if (!searchTerm) return true;\n    const q = searchTerm.toLowerCase();\n    return (\n      u.email.toLowerCase().includes(q) ||\n      u.first_name.toLowerCase().includes(q) ||\n      u.last_name.toLowerCase().includes(q)\n    );\n  });\n\n  // Loading state\n  if (authLoading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-gray-900\">Kullanıcılar</h1>\n          <p className=\"text-gray-600\">Sistem kullanıcılarını ve çalışanları yönetin</p>\n        </div>\n        <button onClick={() => setShowCreateModal(true)} className=\"btn btn-primary\">\n          <Plus size={18} className=\"mr-2\" />\n          Kullanıcı Ekle\n        </button>\n      </div>\n\n      {/* Filters */}\n      <div className=\"card\">\n        <div className=\"grid grid-cols-1 md:grid-cols-5 gap-4\">\n          <div>\n            <label className=\"form-label\">Arama</label>\n            <div className=\"relative\">\n              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400\" />\n              <input type=\"text\" value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} className=\"form-input pl-10\" placeholder=\"Kullanıcılarda ara...\" />\n            </div>\n          </div>\n          <div>\n            <label className=\"form-label\">Rol</label>\n            <select value={roleFilter} onChange={(e) => { setOnlyEmployees(false); setRoleFilter(e.target.value); }} className=\"form-input\" disabled={onlyEmployees}>\n              <option value=\"\">Tüm Roller</option>\n              {roles.map(role => (\n                <option key={role.id} value={role.display_name}>{role.display_name}</option>\n              ))}\n            </select>\n          </div>\n          <div>\n            <label className=\"form-label\">Marka</label>\n            <select value={brandFilter || ''} onChange={(e) => setBrandFilter(e.target.value ? Number(e.target.value) : null)} className=\"form-input\">\n              <option value=\"\">Tüm Markalar</option>\n              {brands.map(brand => (\n                <option key={brand.id} value={brand.id}>{brand.name}</option>\n              ))}\n            </select>\n          </div>\n          \n          <div className=\"flex items-end\">\n            <button onClick={() => { setSearchTerm(''); setRoleFilter(''); setBrandFilter(null); setOnlyEmployees(false); }} className=\"btn btn-secondary w-full\">Filtreleri Temizle</button>\n          </div>\n        </div>\n      </div>\n\n      {/* Users Table */}\n      <div className=\"card\">\n        {loading ? (\n          <div className=\"flex justify-center py-8\"><div className=\"spinner\"></div></div>\n        ) : (\n          <div className=\"overflow-x-auto\">\n            <table className=\"w-full\">\n              <thead>\n                <tr className=\"border-b\">\n                  <th className=\"text-left py-3 px-4 font-medium text-gray-900\">Ad Soyad</th>\n                  <th className=\"text-left py-3 px-4 font-medium text-gray-900\">E-posta</th>\n                  <th className=\"text-left py-3 px-4 font-medium text-gray-900\">Rol</th>\n                  <th className=\"text-left py-3 px-4 font-medium text-gray-900\">Markalar</th>\n                  <th className=\"text-left py-3 px-4 font-medium text-gray-900\">Durum</th>\n                  <th className=\"text-left py-3 px-4 font-medium text-gray-900\">Son Giriş</th>\n                  <th className=\"text-left py-3 px-4 font-medium text-gray-900\">İşlemler</th>\n                </tr>\n              </thead>\n              <tbody>\n                {displayedUsers.map((user) => (\n                  <tr key={user.id} className=\"border-b hover:bg-gray-50\">\n                    <td className=\"py-3 px-4\">\n                      <div className=\"flex items-center gap-3\">\n                        <div className=\"h-8 w-8 bg-blue-100 rounded-full flex items-center justify-center\">\n                          <span className=\"text-sm font-medium text-blue-600\">\n                            {user.first_name[0]}{user.last_name[0]}\n                          </span>\n                        </div>\n                        <div>\n                          <div className=\"font-medium text-gray-900\">\n                            {user.first_name} {user.last_name}\n                          </div>\n                          {user.is_2fa_enabled && (\n                            <span className=\"text-xs text-green-600\">2FA Aktif</span>\n                          )}\n                        </div>\n                      </div>\n                    </td>\n                    <td className=\"py-3 px-4 text-gray-600\">{user.email}</td>\n                    <td className=\"py-3 px-4\">\n                      <span className=\"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs\">\n                        {user.role}\n                      </span>\n                    </td>\n                    <td className=\"py-3 px-4\">\n                      {user.brand_ids && user.brand_ids.length > 0 ? (\n                        <div className=\"flex flex-wrap gap-1\">\n                          {user.brand_ids.map(brandId => {\n                            const brand = brands.find(b => b.id === brandId);\n                            return (\n                              <span key={brandId} className=\"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs\">\n                                {brand?.name || `Brand #${brandId}`}\n                              </span>\n                            );\n                          })}\n                        </div>\n                      ) : (\n                        <span className=\"text-gray-400 text-sm\">Marka yok</span>\n                      )}\n                    </td>\n                    <td className=\"py-3 px-4\">\n                      <span className={`px-2 py-1 rounded-full text-xs ${\n                        user.is_active \n                          ? 'bg-green-100 text-green-800' \n                          : 'bg-red-100 text-red-800'\n                      }`}>\n                        {user.is_active ? 'Aktif' : 'Pasif'}\n                      </span>\n                    </td>\n                    <td className=\"py-3 px-4 text-gray-600 text-sm\">\n                      {user.last_login \n                        ? new Date(user.last_login).toLocaleDateString('tr-TR')\n                        : 'Hiç'\n                      }\n                    </td>\n                    <td className=\"py-3 px-4\">\n                      <div className=\"flex items-center gap-2\">\n                        <button onClick={() => setEditingUser(user)} className=\"p-1 text-gray-400 hover:text-blue-600\" title=\"Kullanıcıyı düzenle\">\n                          <Edit size={16} />\n                        </button>\n                        <button onClick={() => handleToggleUserStatus(user)} className={`p-1 ${\n                            user.is_active \n                              ? 'text-gray-400 hover:text-red-600' \n                              : 'text-gray-400 hover:text-green-600'\n                          }`} title={user.is_active ? 'Kullanıcıyı pasifleştir' : 'Kullanıcıyı aktifleştir'}>\n                          {user.is_active ? <UserX size={16} /> : <UserCheck size={16} />}\n                        </button>\n                        \n                      </div>\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        )}\n\n        {/* Pagination */}\n        {total > perPage && (\n          <div className=\"flex justify-between items-center mt-4 pt-4 border-t\">\n            <div className=\"text-sm text-gray-600\">\n              {total} kullanıcıdan {((page - 1) * perPage) + 1}-{Math.min(page * perPage, total)} arası gösteriliyor\n            </div>\n            <div className=\"flex gap-2\">\n              <button onClick={() => setPage(page - 1)} disabled={page === 1} className=\"btn btn-secondary disabled:opacity-50 disabled:cursor-not-allowed\">Önceki</button>\n              <button onClick={() => setPage(page + 1)} disabled={page * perPage >= total} className=\"btn btn-secondary disabled:opacity-50 disabled:cursor-not-allowed\">Sonraki</button>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Create/Edit User Modal */}\n      {(showCreateModal || editingUser) && (\n        <UserModal\n          user={editingUser}\n          brands={brands}\n          roles={roles}\n          onClose={() => { setShowCreateModal(false); setEditingUser(null); }}\n          onSave={editingUser ? handleUpdateUser : handleCreateUser}\n          onSaveSilent={handleUpdateUserSilent}\n          currentUser={currentUser}\n        />\n      )}\n    </div>\n  );\n};\n\n// User Modal Component remains unchanged\ninterface UserModalProps {\n  user?: User | null;\n  brands: Brand[];\n  roles: Role[];\n  onClose: () => void;\n  onSave: (userData: any) => Promise<void>;\n  onSaveSilent: (userData: any) => Promise<void>;\n  currentUser: AuthUser | null; // Yeni eklenen prop - auth.ts'den User tipini kullan\n}\n\nconst UserModal: React.FC<UserModalProps> = ({ user, brands, roles, onClose, onSave, onSaveSilent, currentUser }) => {\n  \n  const [formData, setFormData] = useState<any>({\n    email: user?.email || '',\n    password: '',\n    first_name: user?.first_name || '',\n    last_name: user?.last_name || '',\n    role_id: user?.role_id || undefined,\n    brand_ids: user?.brand_ids || [],\n  });\n  // Şifre değişikliği için state'ler\n  const [passwordData, setPasswordData] = useState({\n    currentPassword: '',\n    newPassword: ''\n  });\n  const [showPasswordFields, setShowPasswordFields] = useState(false);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  // Update form data when user prop changes\n  useEffect(() => {\n    if (user) {\n      setFormData({\n        email: user.email || '',\n        password: '',\n        first_name: user.first_name || '',\n        last_name: user.last_name || '',\n        role_id: user.role_id || undefined,\n        brand_ids: user.brand_ids || [],\n      });\n      // Kullanıcı kendi hesabını düzenliyorsa şifre alanlarını göster\n      if (currentUser && currentUser.id === user.id) {\n        setShowPasswordFields(true);\n      } else {\n        setShowPasswordFields(false);\n      }\n    }\n  }, [user, currentUser]);\n\n  \n  const selectedRole = roles.find(r => r.id === formData.role_id);\n  const isSuperAdmin = selectedRole?.name === 'super_admin';\n  const isBrandManager = selectedRole?.name === 'brand_manager';\n  const isMarketManager = selectedRole?.name === 'market_manager';\n  const isEmployeeRole = !!selectedRole && !isSuperAdmin && !isBrandManager && !isMarketManager;\n\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\n    const { name, value } = e.target;\n    setFormData((prev: any) => ({\n      ...prev,\n      [name]: name === 'role_id' ? Number(value) : value,\n    }));\n  };\n\n  // Şifre alanlarını güncelleyen fonksiyon\n  const handlePasswordChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const { name, value } = e.target;\n    setPasswordData(prev => ({\n      ...prev,\n      [name]: value\n    }));\n  };\n\n  const handleBrandToggle = (brandId: number, checked: boolean) => {\n    setFormData((prev: any) => ({\n      ...prev,\n      brand_ids: checked ? [...prev.brand_ids, brandId] : prev.brand_ids.filter((id: number) => id !== brandId),\n    }));\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setIsSubmitting(true);\n    \n    try {\n      if (!user && !formData.password) {\n        toast.error('Password is required for new users');\n        return;\n      }\n      if (!formData.role_id) {\n        toast.error('Rol seçiniz');\n        return;\n      }\n      // Require at least one brand for brand managers and employees\n      if ((isBrandManager || isEmployeeRole) && (!formData.brand_ids || formData.brand_ids.length === 0)) {\n        toast.error(isBrandManager ? 'Yönetici için en az bir marka seçiniz' : 'Çalışan için en az bir marka seçiniz');\n        return;\n      }\n      \n      // Kullanıcı kendi şifresini değiştiriyorsa\n      if (user && showPasswordFields) {\n        // Şifre değişikliği yapılacaksa, mevcut ve yeni şifre alanlarını kontrol et\n        if (passwordData.newPassword) {\n          if (!passwordData.currentPassword) {\n            toast.error('Mevcut şifrenizi giriniz');\n            return;\n          }\n          \n          try {\n            // Sadece şifre değişikliğini yap (kullanıcı bilgileri güncellenmesin)\n            await usersAPI.updatePassword(user.id, {\n              current_password: passwordData.currentPassword,\n              new_password: passwordData.newPassword\n            });\n            \n            toast.success('Şifre başarıyla güncellendi');\n            setPasswordData({ currentPassword: '', newPassword: '' });\n            \n            // Şifre değişikliği sonrası kullanıcıyı logout yap\n            if (currentUser && currentUser.id === user.id) {\n              // Kendi şifresini değiştirdiyse logout yap\n              localStorage.removeItem('access_token');\n              localStorage.removeItem('refresh_token');\n              window.location.href = '/login';\n              return;\n            }\n            \n            onClose();\n          } catch (error: any) {\n            toast.error(error.message || 'Şifre güncellenemedi');\n          }\n          return;\n        }\n      }\n      \n      // Admin başka bir kullanıcının şifresini sıfırlıyorsa\n      if (user && !showPasswordFields) {\n        // Şifre değişikliği yapılacaksa\n        if (passwordData.newPassword) {\n          try {\n            // Sadece admin şifre sıfırlaması yap (kullanıcı bilgileri güncellenmesin)\n            await usersAPI.updatePassword(user.id, {\n              new_password: passwordData.newPassword\n            });\n            \n            toast.success('Şifre başarıyla güncellendi');\n            setPasswordData({ currentPassword: '', newPassword: '' });\n            onClose();\n          } catch (error: any) {\n            toast.error(error.message || 'Şifre güncellenemedi');\n          }\n          return;\n        }\n      }\n      \n      // Şifre değişikliği yapılmıyorsa, sadece kullanıcı bilgilerini güncelle\n      const payload = { ...formData };\n      if (user) {\n        delete payload.password;\n      }\n      await onSave(payload);\n      onClose();\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\n      <div className=\"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto\">\n        <div className=\"p-6\">\n          <h2 className=\"text-xl font-bold mb-4\">{user ? 'Kullanıcıyı Düzenle' : 'Kullanıcı Oluştur'}</h2>\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div>\n                <label className=\"form-label\">Ad</label>\n                <input type=\"text\" name=\"first_name\" value={formData.first_name} onChange={handleChange} className=\"form-input\" required />\n              </div>\n              <div>\n                <label className=\"form-label\">Soyad</label>\n                <input type=\"text\" name=\"last_name\" value={formData.last_name} onChange={handleChange} className=\"form-input\" required />\n              </div>\n            </div>\n            <div>\n              <label className=\"form-label\">E-posta</label>\n              <input type=\"email\" name=\"email\" value={formData.email} onChange={handleChange} className=\"form-input\" required />\n            </div>\n            {/* Yeni kullanıcı oluştururken şifre alanı */}\n            {!user && (\n              <div>\n                <label className=\"form-label\">Şifre</label>\n                <input type=\"password\" name=\"password\" value={formData.password} onChange={handleChange} className=\"form-input\" required />\n              </div>\n            )}\n            \n            {/* Şifre Değişikliği Alanları - Sadece kullanıcı kendi hesabını düzenliyorsa gösterilir */}\n            {showPasswordFields && (\n              <>\n                <div>\n                  <label className=\"form-label\">Mevcut Şifre</label>\n                  <input \n                    type=\"password\" \n                    name=\"currentPassword\" \n                    value={passwordData.currentPassword} \n                    onChange={handlePasswordChange} \n                    className=\"form-input\" \n                    required={!!passwordData.newPassword} // Yeni şifre girildiyse mevcut şifre gerekli\n                  />\n                </div>\n                <div>\n                  <label className=\"form-label\">Yeni Şifre</label>\n                  <input \n                    type=\"password\" \n                    name=\"newPassword\" \n                    value={passwordData.newPassword} \n                    onChange={handlePasswordChange} \n                    className=\"form-input\" \n                  />\n                </div>\n              </>\n            )}\n            \n            {/* Admin başka bir kullanıcının şifresini sıfırlıyorsa - sadece yeni şifre alanı */}\n            {!showPasswordFields && user && (\n              <div>\n                <label className=\"form-label\">Yeni Şifre (Kullanıcı için sıfırla)</label>\n                <input \n                  type=\"password\" \n                  name=\"newPassword\" \n                  value={passwordData.newPassword} \n                  onChange={handlePasswordChange} \n                  className=\"form-input\" \n                />\n              </div>\n            )}\n            <div>\n              <label className=\"form-label\">Rol</label>\n              <select name=\"role_id\" value={formData.role_id || ''} onChange={handleChange} className=\"form-input\" required>\n                <option value=\"\">Rol Seçin</option>\n                {roles.map(r => (\n                  <option key={r.id} value={r.id}>{r.display_name}</option>\n                ))}\n              </select>\n            </div>\n\n            {(isBrandManager || isMarketManager || isEmployeeRole) && (\n              <div>\n                <label className=\"form-label\">Markalar</label>\n                <div className=\"space-y-2 max-h-32 overflow-y-auto border rounded p-2\">\n                  {brands.map(brand => (\n                    <label key={brand.id} className=\"flex items-center gap-2\">\n                      <input type=\"checkbox\" checked={formData.brand_ids.includes(brand.id)} onChange={(e) => handleBrandToggle(brand.id, e.target.checked)} className=\"rounded\" />\n                      <span className=\"text-sm\">{brand.name}</span>\n                    </label>\n                  ))}\n                </div>\n              </div>\n            )}\n\n            <div className=\"flex gap-2 pt-4\">\n              <button \n                type=\"submit\" \n                className=\"btn btn-primary flex-1\"\n                disabled={isSubmitting}\n              >\n                {isSubmitting ? 'İşleniyor...' : (user ? 'Kullanıcıyı Güncelle' : 'Kullanıcı Oluştur')}\n              </button>\n              <button type=\"button\" onClick={onClose} className=\"btn btn-secondary\">İptal</button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Users;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}