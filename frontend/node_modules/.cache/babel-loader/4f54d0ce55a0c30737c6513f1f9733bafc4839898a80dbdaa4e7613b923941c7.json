{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ilker\\\\Desktop\\\\aibrands\\\\frontend\\\\src\\\\pages\\\\admin\\\\ChannelDetailOptimized.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { useAuth } from '../../hooks/useAuth';\nimport { socialMediaChannelsAPI } from '../../api/socialMediaChannels';\nimport { ArrowLeft, RefreshCw, Users, MessageSquare, Send, Paperclip, X, Image as ImageIcon, Video, FileText, CheckCircle, XCircle, Trash2, Download, UserPlus, Building2 } from 'lucide-react';\nimport toast from 'react-hot-toast';\nimport api from '../../utils/api';\nimport { format } from 'date-fns';\nimport { AssignUsersModal } from '../../components/channels/AssignUsersModal';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ChannelDetailOptimized = () => {\n  _s();\n  var _user$permissions, _user$permissions2;\n  const {\n    channelId\n  } = useParams();\n  const navigate = useNavigate();\n  const {\n    user,\n    loading: authLoading\n  } = useAuth();\n\n  // State\n  const [channel, setChannel] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [showAssignUsersModal, setShowAssignUsersModal] = useState(false);\n  const [assignedUsers, setAssignedUsers] = useState([]);\n  const [statistics, setStatistics] = useState(null);\n  const [botInfo, setBotInfo] = useState(null);\n  const [assignedUsersStats, setAssignedUsersStats] = useState([]);\n  const [showStats, setShowStats] = useState(true);\n\n  // Message input\n  const [messageText, setMessageText] = useState('');\n  const [mediaFiles, setMediaFiles] = useState([]);\n  const [isSending, setIsSending] = useState(false);\n\n  // Refs\n  const messagesEndRef = useRef(null);\n  const pollIntervalRef = useRef(null);\n  const fileInputRef = useRef(null);\n  const lastMessageCountRef = useRef(0);\n\n  // Scroll to bottom\n  const scrollToBottom = useCallback(() => {\n    setTimeout(() => {\n      var _messagesEndRef$curre;\n      (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n        behavior: 'smooth'\n      });\n    }, 100);\n  }, []);\n\n  // Load channel\n  const loadChannel = useCallback(async () => {\n    if (!channelId) return;\n    try {\n      const data = await socialMediaChannelsAPI.getChannel(Number(channelId));\n      setChannel(data);\n    } catch (error) {\n      toast.error('Kanal bilgileri yüklenemedi');\n      navigate('/admin/social-media/channels');\n    }\n  }, [channelId, navigate]);\n\n  // Load assigned users\n  const loadAssignedUsers = useCallback(async () => {\n    if (!channelId) return;\n    try {\n      const response = await socialMediaChannelsAPI.getChannelAssignedUsers(Number(channelId));\n      setAssignedUsers(response.assigned_users || []);\n    } catch (error) {\n      // Silently handle error - assigned users are not critical\n    }\n  }, [channelId]);\n\n  // Load messages\n  const loadMessages = useCallback(async (silent = false) => {\n    if (!channelId) return;\n    try {\n      if (!silent) setLoading(true);\n      const response = await api.get(`/api/social-media/channels/${channelId}/messages`, {\n        params: {\n          per_page: 500\n        }\n      });\n      const fetchedMessages = response.data.messages || [];\n\n      // Check for new messages\n      const hasNewMessages = fetchedMessages.length > lastMessageCountRef.current;\n      lastMessageCountRef.current = fetchedMessages.length;\n      setMessages(fetchedMessages);\n\n      // Auto-scroll on new messages\n      if (hasNewMessages) {\n        scrollToBottom();\n      }\n    } catch (error) {\n      if (!silent) toast.error('Mesajlar yüklenemedi');\n    } finally {\n      setLoading(false);\n    }\n  }, [channelId, scrollToBottom]);\n\n  // Initial load\n  useEffect(() => {\n    if (authLoading) return;\n    if (!user) {\n      navigate('/login', {\n        replace: true\n      });\n      return;\n    }\n    loadChannel();\n    loadAssignedUsers();\n    loadMessages();\n  }, [authLoading, user, navigate, loadChannel, loadAssignedUsers, loadMessages]);\n\n  // Real-time polling (every 3 seconds)\n  useEffect(() => {\n    if (!channelId) return;\n    pollIntervalRef.current = setInterval(() => {\n      loadMessages(true);\n    }, 3000);\n    return () => {\n      if (pollIntervalRef.current) {\n        clearInterval(pollIntervalRef.current);\n      }\n    };\n  }, [channelId, loadMessages]);\n\n  // File handling\n  const handleFileChange = e => {\n    if (!e.target.files) return;\n    const files = Array.from(e.target.files);\n    if (files.length + mediaFiles.length > 50) {\n      toast.error('En fazla 50 dosya ekleyebilirsiniz');\n      return;\n    }\n    setMediaFiles(prev => [...prev, ...files]);\n  };\n  const removeFile = index => {\n    setMediaFiles(prev => prev.filter((_, i) => i !== index));\n  };\n  const clearAllFiles = () => {\n    setMediaFiles([]);\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n  };\n\n  // Send message\n  const handleSendMessage = async e => {\n    e.preventDefault();\n    if (!channelId || !messageText.trim() && mediaFiles.length === 0) return;\n    if (isSending) return;\n    setIsSending(true);\n    try {\n      const textToSend = messageText.trim();\n      const filesToSend = [...mediaFiles];\n\n      // Clear inputs immediately for better UX\n      setMessageText('');\n      clearAllFiles();\n\n      // Send messages\n      if (filesToSend.length > 0) {\n        // Multiple files - send directly with FormData\n        for (let i = 0; i < filesToSend.length; i++) {\n          const file = filesToSend[i];\n          try {\n            // Direkt FormData ile dosya gönder\n            const formData = new FormData();\n            formData.append('file', file);\n            formData.append('message_text', textToSend || file.name);\n\n            // Yeni upload endpoint'ini kullan\n            await api.post(`/api/social-media/channels/${channelId}/messages/upload`, formData, {\n              headers: {\n                'Content-Type': 'multipart/form-data'\n              }\n            });\n\n            // Rate limiting için kısa bekleme\n            if (i < filesToSend.length - 1) {\n              await new Promise(resolve => setTimeout(resolve, 500));\n            }\n          } catch (error) {\n            toast.error(`Dosya ${i + 1} gönderilemedi: ${file.name}`);\n          }\n        }\n        toast.success(`${filesToSend.length} dosya gönderildi!`);\n      } else {\n        // Text only\n        await api.post(`/api/social-media/channels/${channelId}/messages`, {\n          message_text: textToSend,\n          message_type: 'text'\n        });\n        toast.success('Mesaj gönderildi!');\n      }\n\n      // Reload messages after 2 seconds\n      setTimeout(() => loadMessages(true), 2000);\n    } catch (error) {\n      toast.error(error.message || 'Mesaj gönderilemedi');\n    } finally {\n      setIsSending(false);\n    }\n  };\n\n  // Sync from Telegram\n  const handleTelegramSync = async () => {\n    try {\n      toast.loading('Telegram mesajları senkronize ediliyor...', {\n        duration: 2000\n      });\n      await api.post(`/api/social-media/channels/${channelId}/sync-messages`);\n      toast.success('Mesajlar senkronize ediliyor');\n      setTimeout(() => loadMessages(true), 3000);\n    } catch (error) {\n      toast.error('Senkronizasyon başarısız');\n    }\n  };\n\n  // Clear all messages\n  const handleClearMessages = async () => {\n    if (!window.confirm('Tüm mesajları silmek istediğinizden emin misiniz?')) return;\n    try {\n      toast.loading('Mesajlar temizleniyor...', {\n        id: 'clear'\n      });\n      const response = await api.delete(`/api/social-media/channels/${channelId}/messages/clear`);\n      setMessages([]);\n      lastMessageCountRef.current = 0;\n      toast.success(`✅ ${response.data.deleted_count} mesaj temizlendi!`, {\n        id: 'clear'\n      });\n    } catch (error) {\n      toast.error('Mesajlar temizlenemedi', {\n        id: 'clear'\n      });\n    }\n  };\n\n  // Render file icon\n  const renderFileIcon = type => {\n    if (type === 'image') return /*#__PURE__*/_jsxDEV(ImageIcon, {\n      size: 16,\n      className: \"text-blue-500\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 288,\n      columnNumber: 34\n    }, this);\n    if (type === 'video') return /*#__PURE__*/_jsxDEV(Video, {\n      size: 16,\n      className: \"text-purple-500\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 289,\n      columnNumber: 34\n    }, this);\n    return /*#__PURE__*/_jsxDEV(FileText, {\n      size: 16,\n      className: \"text-gray-500\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 290,\n      columnNumber: 12\n    }, this);\n  };\n\n  // Loading states\n  if (authLoading || loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-center min-h-screen\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 297,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 7\n    }, this);\n  }\n  if (!channel) return null;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex flex-col h-screen bg-gray-50\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white border-b border-gray-200 px-4 py-3\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center justify-between\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center gap-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => navigate('/admin/social-media/channels'),\n            className: \"p-2 hover:bg-gray-100 rounded-lg transition-colors\",\n            children: /*#__PURE__*/_jsxDEV(ArrowLeft, {\n              size: 20\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 314,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 310,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n              className: \"text-lg font-semibold text-gray-900\",\n              children: channel.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 318,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center gap-3 text-xs text-gray-500\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"flex items-center gap-1\",\n                children: [/*#__PURE__*/_jsxDEV(MessageSquare, {\n                  size: 12\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 321,\n                  columnNumber: 19\n                }, this), messages.length, \" mesaj\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 320,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"flex items-center gap-1\",\n                children: [/*#__PURE__*/_jsxDEV(Users, {\n                  size: 12\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 325,\n                  columnNumber: 19\n                }, this), channel.member_count || 0, \" \\xFCye\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 324,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"flex items-center gap-1\",\n                children: [/*#__PURE__*/_jsxDEV(Building2, {\n                  size: 12\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 329,\n                  columnNumber: 19\n                }, this), channel.brand_name || 'Marka']\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 328,\n                columnNumber: 17\n              }, this), channel.is_active ? /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"flex items-center gap-1 text-green-600\",\n                children: [/*#__PURE__*/_jsxDEV(CheckCircle, {\n                  size: 12\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 334,\n                  columnNumber: 21\n                }, this), \"Aktif\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 333,\n                columnNumber: 19\n              }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"flex items-center gap-1 text-red-600\",\n                children: [/*#__PURE__*/_jsxDEV(XCircle, {\n                  size: 12\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 339,\n                  columnNumber: 21\n                }, this), \"Pasif\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 338,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 319,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 317,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 309,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center gap-2\",\n          children: [((user === null || user === void 0 ? void 0 : (_user$permissions = user.permissions) === null || _user$permissions === void 0 ? void 0 : _user$permissions.includes('social.manage')) || (user === null || user === void 0 ? void 0 : (_user$permissions2 = user.permissions) === null || _user$permissions2 === void 0 ? void 0 : _user$permissions2.includes('brands.manage'))) && /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowAssignUsersModal(true),\n            className: \"flex items-center gap-2 px-3 py-1.5 text-sm bg-purple-50 text-purple-600 hover:bg-purple-100 rounded-lg transition-colors\",\n            title: \"Kullan\\u0131c\\u0131 Y\\xF6net\",\n            children: [/*#__PURE__*/_jsxDEV(UserPlus, {\n              size: 14\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 354,\n              columnNumber: 17\n            }, this), \"Kullan\\u0131c\\u0131 (\", assignedUsers.length, \")\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 349,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleTelegramSync,\n            className: \"flex items-center gap-2 px-3 py-1.5 text-sm bg-blue-50 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors\",\n            title: \"Telegram'dan Mesajlar\\u0131 \\xC7ek\",\n            children: [/*#__PURE__*/_jsxDEV(RefreshCw, {\n              size: 14\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 364,\n              columnNumber: 15\n            }, this), \"Sync\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 359,\n            columnNumber: 13\n          }, this), ((user === null || user === void 0 ? void 0 : user.role) === 'Super Admin' || (user === null || user === void 0 ? void 0 : user.role) === 'Mağaza Yöneticisi') && messages.length > 0 && /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleClearMessages,\n            className: \"flex items-center gap-2 px-3 py-1.5 text-sm bg-red-50 text-red-600 hover:bg-red-100 rounded-lg transition-colors\",\n            title: \"T\\xFCm mesajlar\\u0131 temizle\",\n            children: [/*#__PURE__*/_jsxDEV(Trash2, {\n              size: 14\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 374,\n              columnNumber: 17\n            }, this), \"Temizle\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 369,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 347,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 308,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 307,\n      columnNumber: 7\n    }, this), assignedUsers.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-gray-50 border-b border-gray-200 px-4 py-2\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-xs text-gray-600\",\n          children: \"Atanan Kullan\\u0131c\\u0131lar:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 386,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-wrap gap-1\",\n          children: assignedUsers.map(user => /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"inline-flex items-center gap-1 px-2 py-0.5 bg-white rounded-full border border-gray-200 text-xs text-gray-700\",\n            children: [/*#__PURE__*/_jsxDEV(Users, {\n              size: 10\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 393,\n              columnNumber: 19\n            }, this), user.first_name, \" \", user.last_name]\n          }, user.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 389,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 387,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 385,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 384,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-1 overflow-y-auto px-4 py-4 space-y-2\",\n      children: [messages.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-col items-center justify-center h-full text-gray-400\",\n        children: [/*#__PURE__*/_jsxDEV(MessageSquare, {\n          size: 48,\n          className: \"mb-3\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 406,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm\",\n          children: \"Hen\\xFCz mesaj yok\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 407,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-xs\",\n          children: \"A\\u015Fa\\u011F\\u0131dan mesaj g\\xF6nderin\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 408,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 405,\n        columnNumber: 11\n      }, this) : messages.map(message => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `flex ${message.is_sent ? 'justify-end' : 'justify-start'}`,\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `max-w-[70%] rounded-lg px-3 py-2 ${message.is_sent ? 'bg-blue-500 text-white' : 'bg-white border border-gray-200 text-gray-900'} ${message.is_sending ? 'opacity-50' : ''}`,\n          children: [message.media_url && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mb-2\",\n            children: [message.message_type === 'image' && /*#__PURE__*/_jsxDEV(\"img\", {\n              src: message.media_url,\n              alt: message.file_name || 'Image',\n              className: \"max-w-full max-h-48 rounded cursor-pointer\",\n              onClick: () => window.open(message.media_url, '_blank')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 427,\n              columnNumber: 23\n            }, this), message.message_type === 'video' && /*#__PURE__*/_jsxDEV(\"video\", {\n              src: message.media_url,\n              controls: true,\n              className: \"max-w-full max-h-48 rounded\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 435,\n              columnNumber: 23\n            }, this), message.message_type === 'document' && /*#__PURE__*/_jsxDEV(\"a\", {\n              href: message.media_url,\n              target: \"_blank\",\n              rel: \"noopener noreferrer\",\n              className: \"flex items-center gap-2 text-sm hover:underline\",\n              children: [/*#__PURE__*/_jsxDEV(Download, {\n                size: 14\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 448,\n                columnNumber: 25\n              }, this), message.file_name || 'Dosya']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 442,\n              columnNumber: 23\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 425,\n            columnNumber: 19\n          }, this), message.message_text && /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-sm break-words\",\n            children: message.message_text\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 457,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `text-xs mt-1 ${message.is_sent ? 'text-blue-100' : 'text-gray-400'}`,\n            children: format(new Date(message.timestamp), 'HH:mm')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 461,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 416,\n          columnNumber: 15\n        }, this)\n      }, message.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 412,\n        columnNumber: 13\n      }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: messagesEndRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 468,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 403,\n      columnNumber: 7\n    }, this), mediaFiles.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"px-4 py-2 bg-gray-100 border-t border-gray-200\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-2 flex-wrap\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-xs text-gray-600\",\n          children: [mediaFiles.length, \" dosya:\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 475,\n          columnNumber: 13\n        }, this), mediaFiles.map((file, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center gap-1 px-2 py-1 bg-white rounded border border-gray-300 text-xs\",\n          children: [renderFileIcon(file.type.split('/')[0]), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"max-w-[100px] truncate\",\n            children: file.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 482,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => removeFile(index),\n            className: \"ml-1 text-red-500 hover:text-red-700\",\n            children: /*#__PURE__*/_jsxDEV(X, {\n              size: 12\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 487,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 483,\n            columnNumber: 17\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 477,\n          columnNumber: 15\n        }, this)), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: clearAllFiles,\n          className: \"text-xs text-red-600 hover:text-red-700 underline\",\n          children: \"T\\xFCm\\xFCn\\xFC Kald\\u0131r\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 491,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 474,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 473,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white border-t border-gray-200 px-4 py-3\",\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSendMessage,\n        className: \"flex items-end gap-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          ref: fileInputRef,\n          type: \"file\",\n          multiple: true,\n          accept: \"image/*,video/*,.pdf,.doc,.docx,.txt\",\n          onChange: handleFileChange,\n          className: \"hidden\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 504,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          onClick: () => {\n            var _fileInputRef$current;\n            return (_fileInputRef$current = fileInputRef.current) === null || _fileInputRef$current === void 0 ? void 0 : _fileInputRef$current.click();\n          },\n          className: \"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors\",\n          disabled: isSending,\n          children: /*#__PURE__*/_jsxDEV(Paperclip, {\n            size: 20\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 519,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 513,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          value: messageText,\n          onChange: e => setMessageText(e.target.value),\n          onKeyDown: e => {\n            if (e.key === 'Enter' && !e.shiftKey) {\n              e.preventDefault();\n              handleSendMessage(e);\n            }\n          },\n          placeholder: \"Mesaj\\u0131n\\u0131z\\u0131 yaz\\u0131n...\",\n          className: \"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none\",\n          rows: 1,\n          disabled: isSending\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 522,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          disabled: isSending || !messageText.trim() && mediaFiles.length === 0,\n          className: \"p-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\",\n          children: /*#__PURE__*/_jsxDEV(Send, {\n            size: 20\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 542,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 537,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 503,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 502,\n      columnNumber: 7\n    }, this), showAssignUsersModal && channel && user && /*#__PURE__*/_jsxDEV(AssignUsersModal, {\n      channelId: channel.id,\n      channelName: channel.name,\n      brandId: channel.brand_id,\n      currentAssignedUserIds: channel.assigned_user_ids || [],\n      currentUserId: user.id,\n      onClose: () => setShowAssignUsersModal(false),\n      onSuccess: () => {\n        loadAssignedUsers();\n        loadChannel();\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 549,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 305,\n    columnNumber: 5\n  }, this);\n};\n_s(ChannelDetailOptimized, \"aB8knhRvzKJdCL1GlAKyj8XwtFA=\", false, function () {\n  return [useParams, useNavigate, useAuth];\n});\n_c = ChannelDetailOptimized;\nexport default ChannelDetailOptimized;\nvar _c;\n$RefreshReg$(_c, \"ChannelDetailOptimized\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","useRef","useParams","useNavigate","useAuth","socialMediaChannelsAPI","ArrowLeft","RefreshCw","Users","MessageSquare","Send","Paperclip","X","Image","ImageIcon","Video","FileText","CheckCircle","XCircle","Trash2","Download","UserPlus","Building2","toast","api","format","AssignUsersModal","jsxDEV","_jsxDEV","ChannelDetailOptimized","_s","_user$permissions","_user$permissions2","channelId","navigate","user","loading","authLoading","channel","setChannel","messages","setMessages","setLoading","showAssignUsersModal","setShowAssignUsersModal","assignedUsers","setAssignedUsers","statistics","setStatistics","botInfo","setBotInfo","assignedUsersStats","setAssignedUsersStats","showStats","setShowStats","messageText","setMessageText","mediaFiles","setMediaFiles","isSending","setIsSending","messagesEndRef","pollIntervalRef","fileInputRef","lastMessageCountRef","scrollToBottom","setTimeout","_messagesEndRef$curre","current","scrollIntoView","behavior","loadChannel","data","getChannel","Number","error","loadAssignedUsers","response","getChannelAssignedUsers","assigned_users","loadMessages","silent","get","params","per_page","fetchedMessages","hasNewMessages","length","replace","setInterval","clearInterval","handleFileChange","e","target","files","Array","from","prev","removeFile","index","filter","_","i","clearAllFiles","value","handleSendMessage","preventDefault","trim","textToSend","filesToSend","file","formData","FormData","append","name","post","headers","Promise","resolve","success","message_text","message_type","message","handleTelegramSync","duration","handleClearMessages","window","confirm","id","delete","deleted_count","renderFileIcon","type","size","className","fileName","_jsxFileName","lineNumber","columnNumber","children","onClick","member_count","brand_name","is_active","permissions","includes","title","role","map","first_name","last_name","is_sent","is_sending","media_url","src","alt","file_name","open","controls","href","rel","Date","timestamp","ref","split","onSubmit","multiple","accept","onChange","_fileInputRef$current","click","disabled","onKeyDown","key","shiftKey","placeholder","rows","channelName","brandId","brand_id","currentAssignedUserIds","assigned_user_ids","currentUserId","onClose","onSuccess","_c","$RefreshReg$"],"sources":["C:/Users/ilker/Desktop/aibrands/frontend/src/pages/admin/ChannelDetailOptimized.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { useAuth } from '../../hooks/useAuth';\nimport { socialMediaChannelsAPI, SocialMediaChannel } from '../../api/socialMediaChannels';\nimport { \n  ArrowLeft, RefreshCw, Users, MessageSquare, Send, \n  Paperclip, X, Image as ImageIcon, Video, FileText, \n  CheckCircle, XCircle, Trash2, Download, UserPlus, \n  Building2, BarChart3, TrendingUp, Bot\n} from 'lucide-react';\nimport toast from 'react-hot-toast';\nimport api from '../../utils/api';\nimport { format } from 'date-fns';\nimport { AssignUsersModal } from '../../components/channels/AssignUsersModal';\n\ninterface Message {\n  id: number;\n  message_text: string;\n  is_sent: boolean;\n  timestamp: string;\n  media_url?: string | null;\n  message_type?: string | null;\n  file_name?: string | null;\n  is_sending?: boolean;\n  temp_id?: number;\n}\n\ninterface ChannelStatistics {\n  total_messages: number;\n  sent_posts: number;\n  total_members: number;\n  assigned_users_count: number;\n}\n\ninterface BotInfo {\n  id: number;\n  name: string;\n  username: string;\n  is_active: boolean;\n  is_verified: boolean;\n}\n\ninterface AssignedUserStats {\n  id: number;\n  name: string;\n  email: string;\n  sent_messages: number;\n}\n\nconst ChannelDetailOptimized: React.FC = () => {\n  const { channelId } = useParams<{ channelId: string }>();\n  const navigate = useNavigate();\n  const { user, loading: authLoading } = useAuth();\n  \n  // State\n  const [channel, setChannel] = useState<SocialMediaChannel | null>(null);\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [showAssignUsersModal, setShowAssignUsersModal] = useState(false);\n  const [assignedUsers, setAssignedUsers] = useState<any[]>([]);\n  const [statistics, setStatistics] = useState<ChannelStatistics | null>(null);\n  const [botInfo, setBotInfo] = useState<BotInfo | null>(null);\n  const [assignedUsersStats, setAssignedUsersStats] = useState<AssignedUserStats[]>([]);\n  const [showStats, setShowStats] = useState(true);\n  \n  // Message input\n  const [messageText, setMessageText] = useState('');\n  const [mediaFiles, setMediaFiles] = useState<File[]>([]);\n  const [isSending, setIsSending] = useState(false);\n  \n  // Refs\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  const pollIntervalRef = useRef<NodeJS.Timeout | null>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const lastMessageCountRef = useRef<number>(0);\n\n  // Scroll to bottom\n  const scrollToBottom = useCallback(() => {\n    setTimeout(() => {\n      messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n    }, 100);\n  }, []);\n\n  // Load channel\n  const loadChannel = useCallback(async () => {\n    if (!channelId) return;\n    \n    try {\n      const data = await socialMediaChannelsAPI.getChannel(Number(channelId));\n      setChannel(data);\n    } catch (error: any) {\n      toast.error('Kanal bilgileri yüklenemedi');\n      navigate('/admin/social-media/channels');\n    }\n  }, [channelId, navigate]);\n\n  // Load assigned users\n  const loadAssignedUsers = useCallback(async () => {\n    if (!channelId) return;\n    \n    try {\n      const response = await socialMediaChannelsAPI.getChannelAssignedUsers(Number(channelId));\n      setAssignedUsers(response.assigned_users || []);\n    } catch (error) {\n      // Silently handle error - assigned users are not critical\n    }\n  }, [channelId]);\n\n  // Load messages\n  const loadMessages = useCallback(async (silent = false) => {\n    if (!channelId) return;\n    \n    try {\n      if (!silent) setLoading(true);\n      \n      const response = await api.get(`/api/social-media/channels/${channelId}/messages`, {\n        params: { per_page: 500 }\n      });\n\n      const fetchedMessages: Message[] = response.data.messages || [];\n      \n      // Check for new messages\n      const hasNewMessages = fetchedMessages.length > lastMessageCountRef.current;\n      lastMessageCountRef.current = fetchedMessages.length;\n      \n      setMessages(fetchedMessages);\n      \n      // Auto-scroll on new messages\n      if (hasNewMessages) {\n        scrollToBottom();\n      }\n    } catch (error: any) {\n      if (!silent) toast.error('Mesajlar yüklenemedi');\n    } finally {\n      setLoading(false);\n    }\n  }, [channelId, scrollToBottom]);\n\n  // Initial load\n  useEffect(() => {\n    if (authLoading) return;\n    if (!user) {\n      navigate('/login', { replace: true });\n      return;\n    }\n    \n    loadChannel();\n    loadAssignedUsers();\n    loadMessages();\n  }, [authLoading, user, navigate, loadChannel, loadAssignedUsers, loadMessages]);\n\n  // Real-time polling (every 3 seconds)\n  useEffect(() => {\n    if (!channelId) return;\n    \n    pollIntervalRef.current = setInterval(() => {\n      loadMessages(true);\n    }, 3000);\n\n    return () => {\n      if (pollIntervalRef.current) {\n        clearInterval(pollIntervalRef.current);\n      }\n    };\n  }, [channelId, loadMessages]);\n\n  // File handling\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (!e.target.files) return;\n    \n    const files = Array.from(e.target.files);\n    if (files.length + mediaFiles.length > 50) {\n      toast.error('En fazla 50 dosya ekleyebilirsiniz');\n      return;\n    }\n\n    setMediaFiles(prev => [...prev, ...files]);\n  };\n\n  const removeFile = (index: number) => {\n    setMediaFiles(prev => prev.filter((_, i) => i !== index));\n  };\n\n  const clearAllFiles = () => {\n    setMediaFiles([]);\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n  };\n\n  // Send message\n  const handleSendMessage = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!channelId || (!messageText.trim() && mediaFiles.length === 0)) return;\n    if (isSending) return;\n\n    setIsSending(true);\n\n    try {\n      const textToSend = messageText.trim();\n      const filesToSend = [...mediaFiles];\n      \n      // Clear inputs immediately for better UX\n      setMessageText('');\n      clearAllFiles();\n\n      // Send messages\n      if (filesToSend.length > 0) {\n        // Multiple files - send directly with FormData\n        for (let i = 0; i < filesToSend.length; i++) {\n          const file = filesToSend[i];\n          \n          try {\n            // Direkt FormData ile dosya gönder\n            const formData = new FormData();\n            formData.append('file', file);\n            formData.append('message_text', textToSend || file.name);\n            \n            // Yeni upload endpoint'ini kullan\n            await api.post(\n              `/api/social-media/channels/${channelId}/messages/upload`,\n              formData,\n              {\n                headers: { 'Content-Type': 'multipart/form-data' }\n              }\n            );\n            \n            // Rate limiting için kısa bekleme\n            if (i < filesToSend.length - 1) {\n              await new Promise(resolve => setTimeout(resolve, 500));\n            }\n            \n          } catch (error: any) {\n            toast.error(`Dosya ${i+1} gönderilemedi: ${file.name}`);\n          }\n        }\n        \n        toast.success(`${filesToSend.length} dosya gönderildi!`);\n      } else {\n        // Text only\n        await api.post(`/api/social-media/channels/${channelId}/messages`, {\n          message_text: textToSend,\n          message_type: 'text'\n        });\n        \n        toast.success('Mesaj gönderildi!');\n      }\n\n      // Reload messages after 2 seconds\n      setTimeout(() => loadMessages(true), 2000);\n\n    } catch (error: any) {\n      toast.error(error.message || 'Mesaj gönderilemedi');\n    } finally {\n      setIsSending(false);\n    }\n  };\n\n  // Sync from Telegram\n  const handleTelegramSync = async () => {\n    try {\n      toast.loading('Telegram mesajları senkronize ediliyor...', { duration: 2000 });\n      await api.post(`/api/social-media/channels/${channelId}/sync-messages`);\n      toast.success('Mesajlar senkronize ediliyor');\n      setTimeout(() => loadMessages(true), 3000);\n    } catch (error) {\n      toast.error('Senkronizasyon başarısız');\n    }\n  };\n\n  // Clear all messages\n  const handleClearMessages = async () => {\n    if (!window.confirm('Tüm mesajları silmek istediğinizden emin misiniz?')) return;\n    \n    try {\n      toast.loading('Mesajlar temizleniyor...', { id: 'clear' });\n      const response = await api.delete(`/api/social-media/channels/${channelId}/messages/clear`);\n      setMessages([]);\n      lastMessageCountRef.current = 0;\n      toast.success(`✅ ${response.data.deleted_count} mesaj temizlendi!`, { id: 'clear' });\n    } catch (error: any) {\n      toast.error('Mesajlar temizlenemedi', { id: 'clear' });\n    }\n  };\n\n  // Render file icon\n  const renderFileIcon = (type?: string | null) => {\n    if (type === 'image') return <ImageIcon size={16} className=\"text-blue-500\" />;\n    if (type === 'video') return <Video size={16} className=\"text-purple-500\" />;\n    return <FileText size={16} className=\"text-gray-500\" />;\n  };\n\n  // Loading states\n  if (authLoading || loading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500\"></div>\n      </div>\n    );\n  }\n\n  if (!channel) return null;\n\n  return (\n    <div className=\"flex flex-col h-screen bg-gray-50\">\n      {/* Header - Compact with Full Info */}\n      <div className=\"bg-white border-b border-gray-200 px-4 py-3\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-3\">\n            <button\n              onClick={() => navigate('/admin/social-media/channels')}\n              className=\"p-2 hover:bg-gray-100 rounded-lg transition-colors\"\n            >\n              <ArrowLeft size={20} />\n            </button>\n            \n            <div>\n              <h1 className=\"text-lg font-semibold text-gray-900\">{channel.name}</h1>\n              <div className=\"flex items-center gap-3 text-xs text-gray-500\">\n                <span className=\"flex items-center gap-1\">\n                  <MessageSquare size={12} />\n                  {messages.length} mesaj\n                </span>\n                <span className=\"flex items-center gap-1\">\n                  <Users size={12} />\n                  {channel.member_count || 0} üye\n                </span>\n                <span className=\"flex items-center gap-1\">\n                  <Building2 size={12} />\n                  {channel.brand_name || 'Marka'}\n                </span>\n                {channel.is_active ? (\n                  <span className=\"flex items-center gap-1 text-green-600\">\n                    <CheckCircle size={12} />\n                    Aktif\n                  </span>\n                ) : (\n                  <span className=\"flex items-center gap-1 text-red-600\">\n                    <XCircle size={12} />\n                    Pasif\n                  </span>\n                )}\n              </div>\n            </div>\n          </div>\n\n          <div className=\"flex items-center gap-2\">\n            {(user?.permissions?.includes('social.manage') || user?.permissions?.includes('brands.manage')) && (\n              <button\n                onClick={() => setShowAssignUsersModal(true)}\n                className=\"flex items-center gap-2 px-3 py-1.5 text-sm bg-purple-50 text-purple-600 hover:bg-purple-100 rounded-lg transition-colors\"\n                title=\"Kullanıcı Yönet\"\n              >\n                <UserPlus size={14} />\n                Kullanıcı ({assignedUsers.length})\n              </button>\n            )}\n\n            <button\n              onClick={handleTelegramSync}\n              className=\"flex items-center gap-2 px-3 py-1.5 text-sm bg-blue-50 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors\"\n              title=\"Telegram'dan Mesajları Çek\"\n            >\n              <RefreshCw size={14} />\n              Sync\n            </button>\n\n            {(user?.role === 'Super Admin' || user?.role === 'Mağaza Yöneticisi') && messages.length > 0 && (\n              <button\n                onClick={handleClearMessages}\n                className=\"flex items-center gap-2 px-3 py-1.5 text-sm bg-red-50 text-red-600 hover:bg-red-100 rounded-lg transition-colors\"\n                title=\"Tüm mesajları temizle\"\n              >\n                <Trash2 size={14} />\n                Temizle\n              </button>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* Assigned Users Display */}\n      {assignedUsers.length > 0 && (\n        <div className=\"bg-gray-50 border-b border-gray-200 px-4 py-2\">\n          <div className=\"flex items-center gap-2\">\n            <span className=\"text-xs text-gray-600\">Atanan Kullanıcılar:</span>\n            <div className=\"flex flex-wrap gap-1\">\n              {assignedUsers.map((user: any) => (\n                <span\n                  key={user.id}\n                  className=\"inline-flex items-center gap-1 px-2 py-0.5 bg-white rounded-full border border-gray-200 text-xs text-gray-700\"\n                >\n                  <Users size={10} />\n                  {user.first_name} {user.last_name}\n                </span>\n              ))}\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Messages Area - Minimal Design */}\n      <div className=\"flex-1 overflow-y-auto px-4 py-4 space-y-2\">\n        {messages.length === 0 ? (\n          <div className=\"flex flex-col items-center justify-center h-full text-gray-400\">\n            <MessageSquare size={48} className=\"mb-3\" />\n            <p className=\"text-sm\">Henüz mesaj yok</p>\n            <p className=\"text-xs\">Aşağıdan mesaj gönderin</p>\n          </div>\n        ) : (\n          messages.map((message) => (\n            <div\n              key={message.id}\n              className={`flex ${message.is_sent ? 'justify-end' : 'justify-start'}`}\n            >\n              <div\n                className={`max-w-[70%] rounded-lg px-3 py-2 ${\n                  message.is_sent\n                    ? 'bg-blue-500 text-white'\n                    : 'bg-white border border-gray-200 text-gray-900'\n                } ${message.is_sending ? 'opacity-50' : ''}`}\n              >\n                {/* Media */}\n                {message.media_url && (\n                  <div className=\"mb-2\">\n                    {message.message_type === 'image' && (\n                      <img\n                        src={message.media_url}\n                        alt={message.file_name || 'Image'}\n                        className=\"max-w-full max-h-48 rounded cursor-pointer\"\n                        onClick={() => window.open(message.media_url!, '_blank')}\n                      />\n                    )}\n                    {message.message_type === 'video' && (\n                      <video\n                        src={message.media_url}\n                        controls\n                        className=\"max-w-full max-h-48 rounded\"\n                      />\n                    )}\n                    {message.message_type === 'document' && (\n                      <a\n                        href={message.media_url}\n                        target=\"_blank\"\n                        rel=\"noopener noreferrer\"\n                        className=\"flex items-center gap-2 text-sm hover:underline\"\n                      >\n                        <Download size={14} />\n                        {message.file_name || 'Dosya'}\n                      </a>\n                    )}\n                  </div>\n                )}\n\n                {/* Text */}\n                {message.message_text && (\n                  <p className=\"text-sm break-words\">{message.message_text}</p>\n                )}\n\n                {/* Timestamp */}\n                <div className={`text-xs mt-1 ${message.is_sent ? 'text-blue-100' : 'text-gray-400'}`}>\n                  {format(new Date(message.timestamp), 'HH:mm')}\n                </div>\n              </div>\n            </div>\n          ))\n        )}\n        <div ref={messagesEndRef} />\n      </div>\n\n      {/* File Previews - Minimal */}\n      {mediaFiles.length > 0 && (\n        <div className=\"px-4 py-2 bg-gray-100 border-t border-gray-200\">\n          <div className=\"flex items-center gap-2 flex-wrap\">\n            <span className=\"text-xs text-gray-600\">{mediaFiles.length} dosya:</span>\n            {mediaFiles.map((file, index) => (\n              <div\n                key={index}\n                className=\"flex items-center gap-1 px-2 py-1 bg-white rounded border border-gray-300 text-xs\"\n              >\n                {renderFileIcon(file.type.split('/')[0])}\n                <span className=\"max-w-[100px] truncate\">{file.name}</span>\n                <button\n                  onClick={() => removeFile(index)}\n                  className=\"ml-1 text-red-500 hover:text-red-700\"\n                >\n                  <X size={12} />\n                </button>\n              </div>\n            ))}\n            <button\n              onClick={clearAllFiles}\n              className=\"text-xs text-red-600 hover:text-red-700 underline\"\n            >\n              Tümünü Kaldır\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* Input Area - Compact */}\n      <div className=\"bg-white border-t border-gray-200 px-4 py-3\">\n        <form onSubmit={handleSendMessage} className=\"flex items-end gap-2\">\n          <input\n            ref={fileInputRef}\n            type=\"file\"\n            multiple\n            accept=\"image/*,video/*,.pdf,.doc,.docx,.txt\"\n            onChange={handleFileChange}\n            className=\"hidden\"\n          />\n\n          <button\n            type=\"button\"\n            onClick={() => fileInputRef.current?.click()}\n            className=\"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors\"\n            disabled={isSending}\n          >\n            <Paperclip size={20} />\n          </button>\n\n          <textarea\n            value={messageText}\n            onChange={(e) => setMessageText(e.target.value)}\n            onKeyDown={(e) => {\n              if (e.key === 'Enter' && !e.shiftKey) {\n                e.preventDefault();\n                handleSendMessage(e);\n              }\n            }}\n            placeholder=\"Mesajınızı yazın...\"\n            className=\"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none\"\n            rows={1}\n            disabled={isSending}\n          />\n\n          <button\n            type=\"submit\"\n            disabled={isSending || (!messageText.trim() && mediaFiles.length === 0)}\n            className=\"p-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n          >\n            <Send size={20} />\n          </button>\n        </form>\n      </div>\n\n      {/* Assign Users Modal */}\n      {showAssignUsersModal && channel && user && (\n        <AssignUsersModal\n          channelId={channel.id}\n          channelName={channel.name}\n          brandId={channel.brand_id}\n          currentAssignedUserIds={channel.assigned_user_ids || []}\n          currentUserId={user.id}\n          onClose={() => setShowAssignUsersModal(false)}\n          onSuccess={() => {\n            loadAssignedUsers();\n            loadChannel();\n          }}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default ChannelDetailOptimized;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}