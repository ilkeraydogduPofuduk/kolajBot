{"ast":null,"code":"import React,{useState,useEffect,useCallback,useRef}from'react';import{productsAPI}from'../../api/products';import{brandsAPI}from'../../api/brands';import{settingsAPI}from'../../api/settings';import{useUrlConfig}from'../../hooks/useUrlConfig';import MissingFieldsModal from'../../components/modals/MissingFieldsModal';import{Upload,Image as ImageIcon,Eye,Search,Filter,Grid,List,Plus,RefreshCw,CheckCircle,AlertCircle,X}from'lucide-react';import toast from'react-hot-toast';import{notificationService}from'../../services/notificationService';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MediaGallery=()=>{const{getImageURL}=useUrlConfig();const[products,setProducts]=useState([]);const[brands,setBrands]=useState([]);const[filterOptions,setFilterOptions]=useState({product_types:[],colors:[],size_ranges:[]});const[loading,setLoading]=useState(true);const[uploading,setUploading]=useState(false);const[uploadProgress,setUploadProgress]=useState(0);const[uploadStatus,setUploadStatus]=useState('');const[pollingActive,setPollingActive]=useState(false);const pollingActiveRef=useRef(false);// Upload recovery system\nconst[uploadJobId,setUploadJobId]=useState(null);const[uploadRecovery,setUploadRecovery]=useState({isRecovering:false,jobId:null,progress:0});const[uploadLimit,setUploadLimit]=useState(200);// Optimize edildi: 100 -> 200\nconst[maxFileSizeMB,setMaxFileSizeMB]=useState(20);// Optimize edildi: 10 -> 20 MB\nconst[totalUploadSizeMB,setTotalUploadSizeMB]=useState(1000);// Optimize edildi: 500 -> 1000 MB\n// State'leri sessionStorage'dan restore et\nconst[selectedBrand,setSelectedBrand]=useState(()=>{const saved=sessionStorage.getItem('mediaGallery_selectedBrand');return saved?parseInt(saved):null;});const[searchTerm,setSearchTerm]=useState(()=>sessionStorage.getItem('mediaGallery_searchTerm')||'');const[viewMode,setViewMode]=useState(()=>{const saved=sessionStorage.getItem('mediaGallery_viewMode');return saved||'grid';});const[page,setPage]=useState(()=>{const saved=sessionStorage.getItem('mediaGallery_page');return saved?parseInt(saved):1;});// Yeni filtreleme state'leri - çoklu seçim için array\nconst[filterProductType,setFilterProductType]=useState(()=>{const saved=sessionStorage.getItem('mediaGallery_filterProductType');return saved?JSON.parse(saved):[];});const[filterColor,setFilterColor]=useState(()=>{const saved=sessionStorage.getItem('mediaGallery_filterColor');return saved?JSON.parse(saved):[];});const[filterSizeRange,setFilterSizeRange]=useState(()=>{const saved=sessionStorage.getItem('mediaGallery_filterSizeRange');return saved?JSON.parse(saved):[];});// Price filters removed\nconst[filterIncomplete,setFilterIncomplete]=useState(()=>sessionStorage.getItem('mediaGallery_filterIncomplete')==='true');const[filterHasSecondProduct,setFilterHasSecondProduct]=useState(()=>sessionStorage.getItem('mediaGallery_filterHasSecondProduct')==='true');const[filterComplete,setFilterComplete]=useState(()=>sessionStorage.getItem('mediaGallery_filterComplete')==='true');const[showFilters,setShowFilters]=useState(false);const[selectedFiles,setSelectedFiles]=useState([]);const[showUploadModal,setShowUploadModal]=useState(false);const[totalPages,setTotalPages]=useState(1);const[incompleteProducts,setIncompleteProducts]=useState([]);const[showMissingFieldsModal,setShowMissingFieldsModal]=useState(false);const[saving,setSaving]=useState(false);const[apiError,setApiError]=useState(null);// Debounce için timer ref\nconst searchTimerRef=useRef(null);// State değişikliklerini sessionStorage'a kaydet\nuseEffect(()=>{if(selectedBrand)sessionStorage.setItem('mediaGallery_selectedBrand',selectedBrand.toString());sessionStorage.setItem('mediaGallery_searchTerm',searchTerm);sessionStorage.setItem('mediaGallery_viewMode',viewMode);sessionStorage.setItem('mediaGallery_page',page.toString());sessionStorage.setItem('mediaGallery_filterProductType',JSON.stringify(filterProductType));sessionStorage.setItem('mediaGallery_filterColor',JSON.stringify(filterColor));sessionStorage.setItem('mediaGallery_filterSizeRange',JSON.stringify(filterSizeRange));// Price filters removed\nsessionStorage.setItem('mediaGallery_filterIncomplete',filterIncomplete.toString());sessionStorage.setItem('mediaGallery_filterHasSecondProduct',filterHasSecondProduct.toString());sessionStorage.setItem('mediaGallery_filterComplete',filterComplete.toString());},[selectedBrand,searchTerm,viewMode,page,filterProductType,filterColor,filterSizeRange,filterIncomplete,filterHasSecondProduct,filterComplete]);// Upload settings yükle\nconst loadUploadSettings=useCallback(async()=>{try{const settings=await settingsAPI.getSettings();const maxFileCountSetting=settings.settings.find(s=>s.key==='max_file_count');if(maxFileCountSetting){setUploadLimit(parseInt(maxFileCountSetting.value)||100);}const maxFileSizeSetting=settings.settings.find(s=>s.key==='max_file_size_mb');if(maxFileSizeSetting){setMaxFileSizeMB(parseInt(maxFileSizeSetting.value)||10);}const totalUploadSizeSetting=settings.settings.find(s=>s.key==='total_upload_size_mb');if(totalUploadSizeSetting){setTotalUploadSizeMB(parseInt(totalUploadSizeSetting.value)||500);}}catch(error){console.error('Upload settings yüklenemedi:',error);}},[]);// Refresh fonksiyonu - manuel yenileme i�in\nconst refreshProducts=useCallback(async()=>{setLoading(true);try{const filters={};if(filterProductType.length>0)filters.product_type=filterProductType;if(filterColor.length>0)filters.color=filterColor;if(filterSizeRange.length>0)filters.size_range=filterSizeRange;if(filterIncomplete)filters.incomplete=true;if(filterComplete)filters.complete=true;if(filterHasSecondProduct)filters.has_second_product=true;const response=await productsAPI.getProducts(page,20,selectedBrand||undefined,searchTerm||undefined,Object.keys(filters).length>0?filters:undefined);setProducts(response.products);setTotalPages(response.total_pages);setApiError(null);}catch(error){var _error$response,_error$response$data;const detail=error===null||error===void 0?void 0:(_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.detail;const message=detail&&typeof detail==='string'&&detail.trim().length>0?detail:'Urun listesi sunucudan alinirken bir hata olustu (HTTP 500). Lutfen sistem yoneticinize haber verin.';setApiError(message);toast.error('Urunler yuklenirken hata olustu');console.error('Error loading products:',error);}finally{setLoading(false);}},[page,selectedBrand,searchTerm,filterProductType,filterColor,filterSizeRange,filterIncomplete,filterHasSecondProduct]);const loadBrands=useCallback(async()=>{try{// ✅ Sadece ürünü olan markaları getir\nconst response=await brandsAPI.getBrandsWithProducts();setBrands(response.brands);// ✅ Otomatik marka seçme - kullanıcı manuel seçsin\n// İlk yüklemede tüm ürünleri göster\n}catch(error){toast.error('Markalar yüklenirken hata oluştu');console.error('Error loading brands:',error);}},[]);const loadFilterOptions=useCallback(async()=>{try{const options=await productsAPI.getFilterOptions();setFilterOptions(options);}catch(error){console.error('Error loading filter options:',error);setApiError(prev=>prev!==null&&prev!==void 0?prev:'Filtre se�enekleri sunucudan alinamadi. Lutfen sistem yoneticinize haber verin.');}},[]);const handleRetry=useCallback(()=>{setApiError(null);loadBrands();loadFilterOptions();refreshProducts();},[loadBrands,loadFilterOptions,refreshProducts]);// Upload settings yükle\nuseEffect(()=>{loadUploadSettings();checkForUploadRecovery();},[loadUploadSettings]);// Upload recovery system\nconst checkForUploadRecovery=useCallback(()=>{const savedUploadJob=localStorage.getItem('uploadJobId');const savedUploadProgress=localStorage.getItem('uploadProgress');if(savedUploadJob&&savedUploadProgress){setUploadRecovery({isRecovering:true,jobId:savedUploadJob,progress:parseInt(savedUploadProgress)});// Resume upload monitoring\nresumeUploadMonitoring(savedUploadJob);}},[]);const resumeUploadMonitoring=useCallback(async jobId=>{try{setUploading(true);setUploadProgress(parseInt(localStorage.getItem('uploadProgress')||'0'));setUploadStatus('Yükleme devam ediyor...');// Start polling for upload status\nconst interval=setInterval(async()=>{try{const response=await fetch(\"/api/upload/status/\".concat(jobId));const data=await response.json();if(data.status==='completed'){clearInterval(interval);setUploading(false);setUploadProgress(100);setUploadStatus('Yükleme tamamlandı!');// Clear recovery data\nlocalStorage.removeItem('uploadJobId');localStorage.removeItem('uploadProgress');setUploadRecovery({isRecovering:false,jobId:null,progress:0});// Reload products\nwindow.location.reload();// Simple reload for now\ntoast.success('Yükleme başarıyla tamamlandı!');}else if(data.status==='failed'){clearInterval(interval);setUploading(false);setUploadStatus('Yükleme başarısız!');// Clear recovery data\nlocalStorage.removeItem('uploadJobId');localStorage.removeItem('uploadProgress');setUploadRecovery({isRecovering:false,jobId:null,progress:0});toast.error('Yükleme başarısız oldu!');}else if(data.progress){setUploadProgress(data.progress);localStorage.setItem('uploadProgress',data.progress.toString());}}catch(error){console.error('Upload status check error:',error);}},2000);}catch(error){console.error('Upload recovery error:',error);setUploadRecovery({isRecovering:false,jobId:null,progress:0});}},[]);const cancelUploadRecovery=useCallback(()=>{localStorage.removeItem('uploadJobId');localStorage.removeItem('uploadProgress');setUploadRecovery({isRecovering:false,jobId:null,progress:0});setUploading(false);setUploadProgress(0);setUploadStatus('');},[]);// Cleanup polling on unmount\nuseEffect(()=>{return()=>{setPollingActive(false);pollingActiveRef.current=false;};},[]);useEffect(()=>{const fetchProducts=async()=>{try{setLoading(true);// Filtreleri backend'e g�nder (sadece dolu olanlar�)\nconst filters={};if(filterProductType.length>0)filters.product_type=filterProductType;if(filterColor.length>0)filters.color=filterColor;if(filterSizeRange.length>0)filters.size_range=filterSizeRange;// Price filters removed\nif(filterIncomplete)filters.incomplete=true;if(filterComplete)filters.complete=true;if(filterHasSecondProduct)filters.has_second_product=true;// Backend'den filtrelenmi� �r�nleri al\nconst response=await productsAPI.getProducts(page,20,selectedBrand||undefined,searchTerm||undefined,Object.keys(filters).length>0?filters:undefined);// UNKNOWN ve DEFAULT de�erlerini frontend'de de filtrele\nconst filteredProducts=response.products.filter(product=>product.code!=='UNKNOWN'&&product.code!=='DEFAULT_CODE'&&product.color!=='UNKNOWN'&&product.color!=='DEFAULT');setProducts(filteredProducts);setTotalPages(response.total_pages);setApiError(null);}catch(error){var _error$response2,_error$response2$data;const detail=error===null||error===void 0?void 0:(_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.detail;const message=detail&&typeof detail==='string'?detail:'Urun listesi sunucudan alinirken bir hata olustu (HTTP 500). Lutfen sistem yoneticinize haber verin.';setApiError(message);toast.error('Urunler yuklenirken hata olustu');console.error('Error loading products:',error);}finally{setLoading(false);}};// Sayfa değişikliklerinde direkt yükle\nif(page!==1){fetchProducts();return;}// Arama veya filtreler için debounce uygula\nif(searchTimerRef.current){clearTimeout(searchTimerRef.current);}searchTimerRef.current=setTimeout(()=>{fetchProducts();},500);// 500ms delay - kullanıcı yazmayı bitirince arama yap\nreturn()=>{if(searchTimerRef.current){clearTimeout(searchTimerRef.current);}};},[page,searchTerm,filterProductType,filterColor,filterSizeRange,filterIncomplete,filterHasSecondProduct,selectedBrand]);useEffect(()=>{loadBrands();loadFilterOptions();},[loadBrands,loadFilterOptions]);const validateFiles=files=>{// Dosya sayısı kontrolü\nif(files.length>uploadLimit){return{valid:false,message:\"Maksimum \".concat(uploadLimit,\" dosya se\\xE7ebilirsiniz. \").concat(files.length,\" dosya se\\xE7tiniz. \\u0130lk \").concat(uploadLimit,\" dosya kabul edilecek.\"),validFiles:files.slice(0,uploadLimit)};}// Dosya boyutu kontrolü\nconst oversizedFiles=[];const validFiles=[];let totalSizeMB=0;for(const file of files){const fileSizeMB=file.size/(1024*1024);if(fileSizeMB>maxFileSizeMB){oversizedFiles.push(\"\".concat(file.name,\" (\").concat(fileSizeMB.toFixed(2),\" MB)\"));}else{validFiles.push(file);totalSizeMB+=fileSizeMB;}}if(oversizedFiles.length>0){return{valid:false,message:\"Baz\\u0131 dosyalar \\xE7ok b\\xFCy\\xFCk (maksimum \".concat(maxFileSizeMB,\" MB):\\n\").concat(oversizedFiles.join('\\n'),\"\\n\\nBu dosyalar y\\xFCklenmeyecek.\"),validFiles};}// Toplam boyut kontrolü\nif(totalSizeMB>totalUploadSizeMB){return{valid:false,message:\"Toplam dosya boyutu \\xE7ok b\\xFCy\\xFCk: \".concat(totalSizeMB.toFixed(2),\" MB. Maksimum: \").concat(totalUploadSizeMB,\" MB. L\\xFCtfen daha az dosya se\\xE7in.\"),validFiles:[]};}return{valid:true,validFiles};};const handleFileSelect=event=>{const files=Array.from(event.target.files||[]);const validation=validateFiles(files);if(!validation.valid){toast.error(validation.message||'Dosya seçimi geçersiz');if(validation.validFiles.length>0){setSelectedFiles(validation.validFiles);setShowUploadModal(true);}return;}setSelectedFiles(validation.validFiles);setShowUploadModal(true);};const handleUpload=async()=>{if(!selectedFiles.length){notificationService.error('Lütfen yüklenecek dosyaları seçin');return;}try{setUploading(true);setUploadProgress(0);setUploadStatus(\"\".concat(selectedFiles.length,\" dosya y\\xFCkleniyor...\"));// Start upload and get job ID\nconst response=await productsAPI.uploadProductImages(selectedFiles);if(response.job_id){// Save job ID for recovery\nlocalStorage.setItem('uploadJobId',response.job_id.toString());localStorage.setItem('uploadProgress','0');setUploadJobId(response.job_id.toString());setPollingActive(true);pollingActiveRef.current=true;// Poll for progress using job ID\nconst pollProgress=async()=>{// Check polling state at the start of each poll\nif(!pollingActiveRef.current)return;// Stop polling if flag is false\ntry{const statusResponse=await productsAPI.getUploadJobStatus(response.job_id);const{status,processed_files,total_files,failed_files}=statusResponse;// Calculate progress percentage\nconst progressPercent=total_files>0?Math.round(processed_files/total_files*100):0;setUploadProgress(progressPercent);if(status==='completed'){setUploadStatus(\"Y\\xFCkleme tamamland\\u0131! \".concat(processed_files,\" dosya i\\u015Flendi\"));setPollingActive(false);// Stop polling\npollingActiveRef.current=false;// Clear recovery data\nlocalStorage.removeItem('uploadJobId');localStorage.removeItem('uploadProgress');setUploadJobId(null);// Handle results\nif(response.incomplete_products&&response.incomplete_products.length>0){setIncompleteProducts(response.incomplete_products);setShowMissingFieldsModal(true);setShowUploadModal(false);notificationService.warning(\"K\\u0131smi ba\\u015Far\\u0131: \".concat(response.products_created,\" \\xFCr\\xFCn olu\\u015Fturuldu, \").concat(response.incomplete_products.length,\" \\xFCr\\xFCn eksik bilgi nedeniyle olu\\u015Fturulamad\\u0131\"));}else{notificationService.success(\"\".concat(response.products_created,\" \\xFCr\\xFCn ba\\u015Far\\u0131yla olu\\u015Fturuldu\"));setSelectedFiles([]);setShowUploadModal(false);refreshProducts();// Listeyi yenile\n}setUploading(false);}else if(status==='failed'){setUploadStatus('Yükleme başarısız oldu');setPollingActive(false);// Stop polling\npollingActiveRef.current=false;// Clear recovery data\nlocalStorage.removeItem('uploadJobId');localStorage.removeItem('uploadProgress');setUploadJobId(null);notificationService.error('Yükleme işlemi başarısız oldu');setUploading(false);}else{// Still processing, update status and continue polling\nsetUploadStatus(\"\".concat(processed_files,\"/\").concat(total_files,\" dosya i\\u015Flendi (\").concat(failed_files,\" hata)\"));if(pollingActiveRef.current){setTimeout(pollProgress,2000);// Poll every 2 seconds\n}}}catch(error){console.error('Progress polling error:',error);setUploadStatus('Yükleme durumu kontrol edilemiyor');if(pollingActiveRef.current){setTimeout(pollProgress,5000);// Retry after 5 seconds\n}}};// Start polling\npollProgress();}else{// Fallback for immediate response (no job ID)\nsetUploadProgress(100);setUploadStatus('Yükleme tamamlandı!');if(response.success){if(response.incomplete_products&&response.incomplete_products.length>0){setIncompleteProducts(response.incomplete_products);setShowMissingFieldsModal(true);setShowUploadModal(false);notificationService.warning(\"K\\u0131smi ba\\u015Far\\u0131: \".concat(response.products_created,\" \\xFCr\\xFCn olu\\u015Fturuldu, \").concat(response.incomplete_products.length,\" \\xFCr\\xFCn eksik bilgi nedeniyle olu\\u015Fturulamad\\u0131\"));}else{notificationService.success(\"\".concat(response.products_created,\" \\xFCr\\xFCn ba\\u015Far\\u0131yla olu\\u015Fturuldu\"));setSelectedFiles([]);setShowUploadModal(false);refreshProducts();}}else{notificationService.error('Bilinmeyen hata oluştu');}setUploading(false);}}catch(error){var _error$response3,_error$response3$data;const errorMsg=((_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.detail)||'Bilinmeyen hata';notificationService.custom(errorMsg,'error',5000);console.error('Upload error:',error);setUploading(false);setUploadProgress(0);setUploadStatus('');setPollingActive(false);// Stop polling on error\npollingActiveRef.current=false;}};const clearAllFilters=()=>{setFilterProductType([]);setFilterColor([]);setFilterSizeRange([]);setFilterIncomplete(false);setFilterComplete(false);setFilterHasSecondProduct(false);setSearchTerm('');setPage(1);};const handleCompleteMissingFields=async completionData=>{try{const response=await productsAPI.completeProductsBulk(completionData);if(response.success){toast.success(\"\".concat(response.updated_count,\" \\xFCr\\xFCn bilgileri tamamland\\u0131\"));setShowMissingFieldsModal(false);setIncompleteProducts([]);refreshProducts();// Listeyi yenile\n}else{toast.error('Bilgi tamamlama başarısız');}}catch(error){toast.error('Bilgi tamamlama sırasında hata oluştu');console.error('Complete error:',error);}};const getProductStatusIcon=product=>{if(product.is_processed){return/*#__PURE__*/_jsx(CheckCircle,{className:\"w-4 h-4 text-green-500\"});}else{return null;// No icon for unprocessed products\n}};const getProductStatusText=product=>{if(product.is_processed){return'Hazır';}else{return'İşleniyor';}};const getCoverImage=product=>{const images=product.images||[];// SADECE ETİKET OLMAYAN GÖRSELLERİ AL\nconst nonTagImages=images.filter(img=>{// Etiket görsellerini kesinlikle hariç tut\nif(img.image_type==='tag'||img.image_type==='collage')return false;const filename=img.filename||img.original_filename||'';// Dosya adında 'tag' veya 'etiket' varsa hariç tut\nif(/tag|etiket/i.test(filename))return false;// Dosya adında sayı OLMAYAN dosyalar etiket olabilir - hariç tut\nif(!/\\d+\\.(jpg|jpeg|png)$/i.test(filename))return false;return true;});if(nonTagImages.length===0){return null;}// EN KÜÇÜK SAYILI GÖRSELİ BUL (COVER OLSUN OLMASIN)\nconst sortedByNumber=[...nonTagImages].sort((a,b)=>{const filenameA=a.filename||a.original_filename||'';const filenameB=b.filename||b.original_filename||'';// Dosya adından sayıyı çıkar\nconst matchA=filenameA.match(/(\\d+)\\.(jpg|jpeg|png)$/i);const matchB=filenameB.match(/(\\d+)\\.(jpg|jpeg|png)$/i);const numberA=matchA?parseInt(matchA[1]):999999;const numberB=matchB?parseInt(matchB[1]):999999;return numberA-numberB;});// EN KÜÇÜK SAYILI OLANINI DÖN\nreturn sortedByNumber[0]||null;};if(apiError){return/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center justify-center min-h-screen px-6 text-center space-y-4\",children:[/*#__PURE__*/_jsx(AlertCircle,{className:\"w-12 h-12 text-red-500\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold text-gray-800\",children:\"Veriler yuklenemedi\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 max-w-xl\",children:apiError})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleRetry,className:\"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors\",children:\"Tekrar dene\"})]});}if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center min-h-screen\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Medya galerisi y\\xFCkleniyor...\"})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[uploadRecovery.isRecovering&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-2 bg-blue-100 rounded-full\",children:/*#__PURE__*/_jsx(RefreshCw,{className:\"w-5 h-5 text-blue-600 animate-spin\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-blue-800 mb-1\",children:\"Y\\xFCkleme Devam Ediyor\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-blue-700 text-sm mb-3\",children:\"\\xD6nceki y\\xFCkleme i\\u015Flemi devam ediyor. \\u0130\\u015Flem tamamlanana kadar bekleyin.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 bg-blue-200 rounded-full h-2\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-blue-600 h-2 rounded-full transition-all duration-300\",style:{width:\"\".concat(uploadRecovery.progress,\"%\")}})}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm font-medium text-blue-800\",children:[uploadRecovery.progress,\"%\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:cancelUploadRecovery,className:\"btn btn-sm btn-ghost text-blue-600 hover:text-blue-800\",children:\"\\u0130ptal Et\"})]})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-gradient-to-r from-slate-50 to-blue-50 border border-slate-200 rounded-lg p-5\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start gap-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0 pt-0.5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center\",children:/*#__PURE__*/_jsx(AlertCircle,{className:\"w-5 h-5 text-blue-600\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-sm font-semibold text-gray-900 mb-1\",children:\"Depolama Bilgisi\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600 leading-relaxed\",children:[\"\\xDCr\\xFCn g\\xF6rselleri ve kolajlar \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-900\",children:\"24 saat\"}),\" boyunca \\xFCcretsiz olarak saklanmaktad\\u0131r. Daha uzun s\\xFCre depolama i\\xE7in premium paketlerimizi inceleyebilirsiniz.\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0\",children:/*#__PURE__*/_jsx(\"button\",{className:\"px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white text-xs font-medium rounded transition-colors duration-200\",children:\"Premium\"})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-gray-900\",children:\"\\xDCr\\xFCnler\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"\\xDCr\\xFCn g\\xF6rsellerini y\\xF6netin ve AI ile i\\u015Fleyin\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{var _document$getElementB;return(_document$getElementB=document.getElementById('file-upload'))===null||_document$getElementB===void 0?void 0:_document$getElementB.click();},className:\"btn btn-primary flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Upload,{size:18}),\"G\\xF6rsel Y\\xFCkle\"]}),/*#__PURE__*/_jsx(\"input\",{id:\"file-upload\",type:\"file\",multiple:true,accept:\"image/*\",onChange:handleFileSelect,className:\"hidden\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm border border-gray-200 p-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-sm font-semibold text-gray-700\",children:\"Arama & Filtreleme\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowFilters(!showFilters),className:\"flex items-center gap-2 px-3 py-1.5 text-sm rounded-lg transition-colors \".concat(showFilters?'bg-blue-100 text-blue-700':'bg-gray-100 text-gray-700 hover:bg-gray-200'),children:[/*#__PURE__*/_jsx(Filter,{size:16}),showFilters?'Filtreleri Gizle':'Gelişmiş Filtreler']}),(filterProductType.length>0||filterColor.length>0||filterSizeRange.length>0||filterIncomplete||filterComplete||filterHasSecondProduct)&&/*#__PURE__*/_jsxs(\"button\",{onClick:clearAllFilters,className:\"flex items-center gap-2 px-3 py-1.5 text-sm bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors\",children:[/*#__PURE__*/_jsx(X,{size:16}),\"T\\xFCm\\xFCn\\xFC Temizle\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-5 gap-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative md:col-span-2\",children:[/*#__PURE__*/_jsx(Search,{className:\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400\",size:16}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\xDCr\\xFCn ara...\",value:searchTerm,onChange:e=>{setSearchTerm(e.target.value);setPage(1);},className:\"w-full pl-9 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"})]}),/*#__PURE__*/_jsxs(\"select\",{value:selectedBrand||'',onChange:e=>{setSelectedBrand(Number(e.target.value)||null);setPage(1);},className:\"px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"T\\xFCm Markalar\"}),brands.map(brand=>/*#__PURE__*/_jsx(\"option\",{value:brand.id,children:brand.name},brand.id))]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setViewMode('grid'),className:\"p-2 rounded-lg \".concat(viewMode==='grid'?'bg-blue-100 text-blue-600':'text-gray-400 hover:text-gray-600'),title:\"Grid g\\xF6r\\xFCn\\xFCm\",children:/*#__PURE__*/_jsx(Grid,{size:16})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setViewMode('list'),className:\"p-2 rounded-lg \".concat(viewMode==='list'?'bg-blue-100 text-blue-600':'text-gray-400 hover:text-gray-600'),title:\"Liste g\\xF6r\\xFCn\\xFCm\",children:/*#__PURE__*/_jsx(List,{size:16})}),/*#__PURE__*/_jsx(\"button\",{onClick:refreshProducts,className:\"p-2 rounded-lg text-gray-600 hover:bg-gray-100\",title:\"Yenile\",children:/*#__PURE__*/_jsx(RefreshCw,{size:16})})]})]}),showFilters&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 pt-4 border-t border-gray-200\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-4 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs font-medium text-gray-700 mb-1\",children:\"\\xDCr\\xFCn Tipi\"}),/*#__PURE__*/_jsx(\"div\",{className:\"max-h-32 overflow-y-auto border border-gray-300 rounded-lg p-2 space-y-1\",children:filterOptions.product_types.map(type=>/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center space-x-2 text-sm\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:filterProductType.includes(type),onChange:e=>{if(e.target.checked){setFilterProductType([...filterProductType,type]);}else{setFilterProductType(filterProductType.filter(t=>t!==type));}setPage(1);},className:\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"}),/*#__PURE__*/_jsx(\"span\",{children:type})]},type))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs font-medium text-gray-700 mb-1\",children:\"Renk\"}),/*#__PURE__*/_jsx(\"div\",{className:\"max-h-32 overflow-y-auto border border-gray-300 rounded-lg p-2 space-y-1\",children:filterOptions.colors.map(color=>/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center space-x-2 text-sm\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:filterColor.includes(color),onChange:e=>{if(e.target.checked){setFilterColor([...filterColor,color]);}else{setFilterColor(filterColor.filter(c=>c!==color));}setPage(1);},className:\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"}),/*#__PURE__*/_jsx(\"span\",{children:color})]},color))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs font-medium text-gray-700 mb-1\",children:\"Beden\"}),/*#__PURE__*/_jsx(\"div\",{className:\"max-h-32 overflow-y-auto border border-gray-300 rounded-lg p-2 space-y-1\",children:filterOptions.size_ranges.map(size=>/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center space-x-2 text-sm\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:filterSizeRange.includes(size),onChange:e=>{if(e.target.checked){setFilterSizeRange([...filterSizeRange,size]);}else{setFilterSizeRange(filterSizeRange.filter(s=>s!==size));}setPage(1);},className:\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"}),/*#__PURE__*/_jsx(\"span\",{children:size})]},size))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col gap-2\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center gap-2 text-sm text-gray-700 cursor-pointer\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:filterIncomplete,onChange:e=>{setFilterIncomplete(e.target.checked);setPage(1);},className:\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Eksik Bilgiler\"})]}),/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center gap-2 text-sm text-gray-700 cursor-pointer\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:filterComplete,onChange:e=>{setFilterComplete(e.target.checked);setPage(1);},className:\"rounded border-gray-300 text-green-600 focus:ring-green-500\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Tam Bilgiler\"})]}),/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center gap-2 text-sm text-gray-700 cursor-pointer\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:filterHasSecondProduct,onChange:e=>{setFilterHasSecondProduct(e.target.checked);setPage(1);},className:\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\xC7ift \\xDCr\\xFCn\"})]})]})]})})]}),products.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-12\",children:[/*#__PURE__*/_jsx(ImageIcon,{className:\"w-16 h-16 text-gray-300 mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900 mb-2\",children:\"Hen\\xFCz \\xFCr\\xFCn yok\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-4\",children:\"\\u0130lk \\xFCr\\xFCn g\\xF6rsellerinizi y\\xFCkleyerek ba\\u015Flay\\u0131n\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{var _document$getElementB2;return(_document$getElementB2=document.getElementById('file-upload'))===null||_document$getElementB2===void 0?void 0:_document$getElementB2.click();},className:\"btn btn-primary\",children:[/*#__PURE__*/_jsx(Plus,{size:18,className:\"mr-2\"}),\"G\\xF6rsel Y\\xFCkle\"]})]}):/*#__PURE__*/_jsx(\"div\",{className:viewMode==='grid'?'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 2xl:grid-cols-4 gap-6':'space-y-4',children:products.map(product=>{var _product$brand,_product$brand2;const coverImage=getCoverImage(product);return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow \".concat(viewMode==='list'?'flex':''),children:[/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(viewMode==='list'?'w-48 h-48 flex-shrink-0':'h-64',\" bg-gray-100 relative overflow-hidden\"),children:coverImage?/*#__PURE__*/_jsx(\"img\",{src:getImageURL(coverImage.file_path),alt:product.name,className:\"w-full h-full object-contain bg-white\",loading:\"lazy\",onError:e=>{e.target.src='data:image/svg+xml,%3Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"100\" height=\"100\"%3E%3Crect fill=\"%23f3f4f6\" width=\"100\" height=\"100\"/%3E%3Ctext x=\"50%25\" y=\"50%25\" text-anchor=\"middle\" dy=\".3em\" fill=\"%239ca3af\"%3ENo Image%3C/text%3E%3C/svg%3E';}}):/*#__PURE__*/_jsx(\"div\",{className:\"w-full h-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(ImageIcon,{className:\"w-8 h-8 text-gray-400\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 \".concat(viewMode==='list'?'flex-1':''),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between mb-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-semibold text-blue-600 mb-1 truncate\",title:product.brand_name||((_product$brand=product.brand)===null||_product$brand===void 0?void 0:_product$brand.name),children:product.brand_name||((_product$brand2=product.brand)===null||_product$brand2===void 0?void 0:_product$brand2.name)||'Marka Yok'}),/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium text-gray-900 truncate\",title:product.code,children:product.code.length>20?\"\".concat(product.code.substring(0,20),\"...\"):product.code}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 truncate\",title:product.color,children:product.color&&product.color.length>15?\"\".concat(product.color.substring(0,15),\"...\"):product.color})]}),getProductStatusIcon(product)]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between text-sm text-gray-500 mb-3\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[(product.images||[]).length,\" g\\xF6rsel\"]}),/*#__PURE__*/_jsx(\"span\",{children:getProductStatusText(product)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-1.5 mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm \".concat(!product.product_type?'text-red-500 font-medium':'text-gray-600'),children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-700\",children:\"Tip:\"}),\" \",product.product_type||'❌ Eksik']}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm \".concat(!product.size_range?'text-red-500 font-medium':'text-gray-600'),children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-700\",children:\"Beden:\"}),\" \",product.size_range||'❌ Eksik']}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm \".concat(!product.price?'text-red-500 font-medium':'text-gray-600'),children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-700\",children:\"Fiyat:\"}),\" \",product.price?\"$\".concat(product.price):'❌ Eksik']})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center gap-2\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:()=>window.location.href=\"/admin/products/\".concat(product.id),className:\"btn btn-sm btn-secondary flex items-center gap-1\",children:[/*#__PURE__*/_jsx(Eye,{size:14}),\"Detay\"]})})]})]},product.id);})}),totalPages>1&&/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setPage(Math.max(1,page-1)),disabled:page===1,className:\"btn btn-sm btn-secondary\",children:\"\\xD6nceki\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-gray-600\",children:[\"Sayfa \",page,\" / \",totalPages]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setPage(Math.min(totalPages,page+1)),disabled:page===totalPages,className:\"btn btn-sm btn-secondary\",children:\"Sonraki\"})]})}),showUploadModal&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg p-6 w-full max-w-md\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900 mb-4\",children:\"G\\xF6rsel Y\\xFCkle\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 p-3 bg-blue-50 rounded-lg\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-medium text-blue-900 mb-2\",children:\"Y\\xFCkleme Limitleri:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-blue-700 space-y-1\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"\\u2022 Maksimum dosya say\\u0131s\\u0131: \",uploadLimit,\" \",/*#__PURE__*/_jsx(\"span\",{className:\"text-green-600\",children:\"\\u26A1\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"\\u2022 Maksimum dosya boyutu: \",maxFileSizeMB,\" MB \",/*#__PURE__*/_jsx(\"span\",{className:\"text-green-600\",children:\"\\u26A1\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"\\u2022 Toplam y\\xFCkleme boyutu: \",totalUploadSizeMB,\" MB \",/*#__PURE__*/_jsx(\"span\",{className:\"text-green-600\",children:\"\\u26A1\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-green-600 font-medium mt-2\",children:\"\\uD83D\\uDE80 Optimize edilmi\\u015F performans!\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 p-3 bg-green-50 rounded-lg\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start gap-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-green-600\",children:\"\\u2139\\uFE0F\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-green-800\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-medium\",children:\"Otomatik Marka Tespiti\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-1\",children:\"Marka bilgisi etiketlerden otomatik olarak tespit edilecek. Sadece yetkili oldu\\u011Funuz markalar y\\xFCklenecek.\"})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600 mb-2\",children:[selectedFiles.length,\" dosya se\\xE7ildi\",(()=>{const totalSizeMB=selectedFiles.reduce((sum,file)=>sum+file.size/(1024*1024),0);return/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-500\",children:[' ',\"(Toplam: \",totalSizeMB.toFixed(2),\" MB)\"]});})()]}),/*#__PURE__*/_jsxs(\"div\",{className:\"max-h-32 overflow-y-auto border border-gray-200 rounded-lg p-2\",children:[selectedFiles.slice(0,10).map((file,index)=>{const fileSizeMB=file.size/(1024*1024);const isOversized=fileSizeMB>maxFileSizeMB;return/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs truncate \".concat(isOversized?'text-red-600':'text-gray-500'),children:[file.name,\" (\",fileSizeMB.toFixed(2),\" MB)\",isOversized&&/*#__PURE__*/_jsx(\"span\",{className:\"text-red-600 font-medium\",children:\" - \\xC7OK B\\xDCY\\xDCK!\"})]},index);}),selectedFiles.length>10&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-400 italic\",children:[\"... ve \",selectedFiles.length-10,\" dosya daha\"]})]})]}),uploading&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-600\",children:uploadStatus}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm font-medium text-blue-600\",children:[uploadProgress,\"%\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full bg-gray-200 rounded-full h-2.5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-blue-600 h-2.5 rounded-full transition-all duration-300\",style:{width:\"\".concat(uploadProgress,\"%\")}})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end gap-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowUploadModal(false),className:\"btn btn-secondary\",disabled:uploading,children:\"\\u0130ptal\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleUpload,className:\"btn btn-primary\",disabled:uploading||selectedFiles.length>uploadLimit,children:uploading?'Yükleniyor...':'Yükle'})]})]})}),showMissingFieldsModal&&/*#__PURE__*/_jsx(MissingFieldsModal,{incompleteProducts:incompleteProducts,onComplete:handleCompleteMissingFields,onCancel:()=>{setShowMissingFieldsModal(false);setIncompleteProducts([]);}})]});};export default MediaGallery;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useRef","productsAPI","brandsAPI","settingsAPI","useUrlConfig","MissingFieldsModal","Upload","Image","ImageIcon","Eye","Search","Filter","Grid","List","Plus","RefreshCw","CheckCircle","AlertCircle","X","toast","notificationService","jsx","_jsx","jsxs","_jsxs","MediaGallery","getImageURL","products","setProducts","brands","setBrands","filterOptions","setFilterOptions","product_types","colors","size_ranges","loading","setLoading","uploading","setUploading","uploadProgress","setUploadProgress","uploadStatus","setUploadStatus","pollingActive","setPollingActive","pollingActiveRef","uploadJobId","setUploadJobId","uploadRecovery","setUploadRecovery","isRecovering","jobId","progress","uploadLimit","setUploadLimit","maxFileSizeMB","setMaxFileSizeMB","totalUploadSizeMB","setTotalUploadSizeMB","selectedBrand","setSelectedBrand","saved","sessionStorage","getItem","parseInt","searchTerm","setSearchTerm","viewMode","setViewMode","page","setPage","filterProductType","setFilterProductType","JSON","parse","filterColor","setFilterColor","filterSizeRange","setFilterSizeRange","filterIncomplete","setFilterIncomplete","filterHasSecondProduct","setFilterHasSecondProduct","filterComplete","setFilterComplete","showFilters","setShowFilters","selectedFiles","setSelectedFiles","showUploadModal","setShowUploadModal","totalPages","setTotalPages","incompleteProducts","setIncompleteProducts","showMissingFieldsModal","setShowMissingFieldsModal","saving","setSaving","apiError","setApiError","searchTimerRef","setItem","toString","stringify","loadUploadSettings","settings","getSettings","maxFileCountSetting","find","s","key","value","maxFileSizeSetting","totalUploadSizeSetting","error","console","refreshProducts","filters","length","product_type","color","size_range","incomplete","complete","has_second_product","response","getProducts","undefined","Object","keys","total_pages","_error$response","_error$response$data","detail","data","message","trim","loadBrands","getBrandsWithProducts","loadFilterOptions","options","getFilterOptions","prev","handleRetry","checkForUploadRecovery","savedUploadJob","localStorage","savedUploadProgress","resumeUploadMonitoring","interval","setInterval","fetch","concat","json","status","clearInterval","removeItem","window","location","reload","success","cancelUploadRecovery","current","fetchProducts","filteredProducts","filter","product","code","_error$response2","_error$response2$data","clearTimeout","setTimeout","validateFiles","files","valid","validFiles","slice","oversizedFiles","totalSizeMB","file","fileSizeMB","size","push","name","toFixed","join","handleFileSelect","event","Array","from","target","validation","handleUpload","uploadProductImages","job_id","pollProgress","statusResponse","getUploadJobStatus","processed_files","total_files","failed_files","progressPercent","Math","round","incomplete_products","warning","products_created","_error$response3","_error$response3$data","errorMsg","custom","clearAllFilters","handleCompleteMissingFields","completionData","completeProductsBulk","updated_count","getProductStatusIcon","is_processed","className","getProductStatusText","getCoverImage","images","nonTagImages","img","image_type","filename","original_filename","test","sortedByNumber","sort","a","b","filenameA","filenameB","matchA","match","matchB","numberA","numberB","children","onClick","style","width","_document$getElementB","document","getElementById","click","id","type","multiple","accept","onChange","placeholder","e","Number","map","brand","title","checked","includes","t","c","_document$getElementB2","_product$brand","_product$brand2","coverImage","src","file_path","alt","onError","brand_name","substring","price","href","max","disabled","min","reduce","sum","index","isOversized","onComplete","onCancel"],"sources":["C:/Users/ilker/Desktop/aibrands/frontend/src/pages/admin/MediaGallery.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { productsAPI, Product, ProductImage, IncompleteProduct } from '../../api/products';\nimport { brandsAPI, Brand } from '../../api/brands';\nimport { settingsAPI } from '../../api/settings';\nimport { useUrlConfig } from '../../hooks/useUrlConfig';\nimport MissingFieldsModal from '../../components/modals/MissingFieldsModal';\nimport { \n  Upload, \n  Image as ImageIcon, \n  Eye, \n  Search,\n  Filter,\n  Grid,\n  List,\n  Plus,\n  RefreshCw,\n  CheckCircle,\n  AlertCircle,\n  DollarSign,\n  X\n} from 'lucide-react';\nimport toast from 'react-hot-toast';\nimport { notificationService } from '../../services/notificationService';\n\nconst MediaGallery: React.FC = () => {\n  const { getImageURL } = useUrlConfig();\n  const [products, setProducts] = useState<Product[]>([]);\n  const [brands, setBrands] = useState<Brand[]>([]);\n  const [filterOptions, setFilterOptions] = useState<{\n    product_types: string[];\n    colors: string[];\n    size_ranges: string[];\n  }>({ product_types: [], colors: [], size_ranges: [] });\n  const [loading, setLoading] = useState(true);\n  const [uploading, setUploading] = useState(false);\n  const [uploadProgress, setUploadProgress] = useState(0);\n  const [uploadStatus, setUploadStatus] = useState('');\n  const [pollingActive, setPollingActive] = useState(false);\n  const pollingActiveRef = useRef(false);\n  \n  // Upload recovery system\n  const [uploadJobId, setUploadJobId] = useState<string | null>(null);\n  const [uploadRecovery, setUploadRecovery] = useState<{\n    isRecovering: boolean;\n    jobId: string | null;\n    progress: number;\n  }>({ isRecovering: false, jobId: null, progress: 0 });\n  const [uploadLimit, setUploadLimit] = useState<number>(200); // Optimize edildi: 100 -> 200\n  const [maxFileSizeMB, setMaxFileSizeMB] = useState<number>(20); // Optimize edildi: 10 -> 20 MB\n  const [totalUploadSizeMB, setTotalUploadSizeMB] = useState<number>(1000); // Optimize edildi: 500 -> 1000 MB\n  \n  \n  // State'leri sessionStorage'dan restore et\n  const [selectedBrand, setSelectedBrand] = useState<number | null>(() => {\n    const saved = sessionStorage.getItem('mediaGallery_selectedBrand');\n    return saved ? parseInt(saved) : null;\n  });\n  const [searchTerm, setSearchTerm] = useState(() => sessionStorage.getItem('mediaGallery_searchTerm') || '');\n  const [viewMode, setViewMode] = useState<'grid' | 'list'>(() => {\n    const saved = sessionStorage.getItem('mediaGallery_viewMode');\n    return (saved as 'grid' | 'list') || 'grid';\n  });\n  const [page, setPage] = useState(() => {\n    const saved = sessionStorage.getItem('mediaGallery_page');\n    return saved ? parseInt(saved) : 1;\n  });\n  \n  // Yeni filtreleme state'leri - çoklu seçim için array\n  const [filterProductType, setFilterProductType] = useState<string[]>(() => {\n    const saved = sessionStorage.getItem('mediaGallery_filterProductType');\n    return saved ? JSON.parse(saved) : [];\n  });\n  const [filterColor, setFilterColor] = useState<string[]>(() => {\n    const saved = sessionStorage.getItem('mediaGallery_filterColor');\n    return saved ? JSON.parse(saved) : [];\n  });\n  const [filterSizeRange, setFilterSizeRange] = useState<string[]>(() => {\n    const saved = sessionStorage.getItem('mediaGallery_filterSizeRange');\n    return saved ? JSON.parse(saved) : [];\n  });\n  // Price filters removed\n  const [filterIncomplete, setFilterIncomplete] = useState(() => sessionStorage.getItem('mediaGallery_filterIncomplete') === 'true');\n  const [filterHasSecondProduct, setFilterHasSecondProduct] = useState(() => sessionStorage.getItem('mediaGallery_filterHasSecondProduct') === 'true');\n  const [filterComplete, setFilterComplete] = useState(() => sessionStorage.getItem('mediaGallery_filterComplete') === 'true');\n  const [showFilters, setShowFilters] = useState(false);\n  \n  const [selectedFiles, setSelectedFiles] = useState<File[]>([]);\n  const [showUploadModal, setShowUploadModal] = useState(false);\n  const [totalPages, setTotalPages] = useState(1);\n  const [incompleteProducts, setIncompleteProducts] = useState<IncompleteProduct[]>([]);\n  const [showMissingFieldsModal, setShowMissingFieldsModal] = useState(false);\n  \n  const [saving, setSaving] = useState(false);\n  const [apiError, setApiError] = useState<string | null>(null);\n\n  // Debounce için timer ref\n  const searchTimerRef = useRef<NodeJS.Timeout | null>(null);\n  \n  // State değişikliklerini sessionStorage'a kaydet\n  useEffect(() => {\n    if (selectedBrand) sessionStorage.setItem('mediaGallery_selectedBrand', selectedBrand.toString());\n    sessionStorage.setItem('mediaGallery_searchTerm', searchTerm);\n    sessionStorage.setItem('mediaGallery_viewMode', viewMode);\n    sessionStorage.setItem('mediaGallery_page', page.toString());\n    sessionStorage.setItem('mediaGallery_filterProductType', JSON.stringify(filterProductType));\n    sessionStorage.setItem('mediaGallery_filterColor', JSON.stringify(filterColor));\n    sessionStorage.setItem('mediaGallery_filterSizeRange', JSON.stringify(filterSizeRange));\n    // Price filters removed\n    sessionStorage.setItem('mediaGallery_filterIncomplete', filterIncomplete.toString());\n    sessionStorage.setItem('mediaGallery_filterHasSecondProduct', filterHasSecondProduct.toString());\n    sessionStorage.setItem('mediaGallery_filterComplete', filterComplete.toString());\n  }, [selectedBrand, searchTerm, viewMode, page, filterProductType, filterColor, filterSizeRange, filterIncomplete, filterHasSecondProduct, filterComplete]);\n\n  // Upload settings yükle\n  const loadUploadSettings = useCallback(async () => {\n    try {\n      const settings = await settingsAPI.getSettings();\n      \n      const maxFileCountSetting = settings.settings.find(s => s.key === 'max_file_count');\n      if (maxFileCountSetting) {\n        setUploadLimit(parseInt(maxFileCountSetting.value) || 100);\n      }\n      \n      const maxFileSizeSetting = settings.settings.find(s => s.key === 'max_file_size_mb');\n      if (maxFileSizeSetting) {\n        setMaxFileSizeMB(parseInt(maxFileSizeSetting.value) || 10);\n      }\n      \n      const totalUploadSizeSetting = settings.settings.find(s => s.key === 'total_upload_size_mb');\n      if (totalUploadSizeSetting) {\n        setTotalUploadSizeMB(parseInt(totalUploadSizeSetting.value) || 500);\n      }\n    } catch (error) {\n      console.error('Upload settings yüklenemedi:', error);\n    }\n  }, []);\n\n  // Refresh fonksiyonu - manuel yenileme i�in\n  const refreshProducts = useCallback(async () => {\n    setLoading(true);\n    try {\n      const filters: any = {};\n      if (filterProductType.length > 0) filters.product_type = filterProductType;\n      if (filterColor.length > 0) filters.color = filterColor;\n      if (filterSizeRange.length > 0) filters.size_range = filterSizeRange;\n      if (filterIncomplete) filters.incomplete = true;\n      if (filterComplete) filters.complete = true;\n      if (filterHasSecondProduct) filters.has_second_product = true;\n\n      const response = await productsAPI.getProducts(\n        page,\n        20,\n        selectedBrand || undefined,\n        searchTerm || undefined,\n        Object.keys(filters).length > 0 ? filters : undefined\n      );\n\n      setProducts(response.products);\n      setTotalPages(response.total_pages);\n      setApiError(null);\n    } catch (error: any) {\n      const detail = error?.response?.data?.detail;\n      const message = detail && typeof detail === 'string' && detail.trim().length > 0\n        ? detail\n        : 'Urun listesi sunucudan alinirken bir hata olustu (HTTP 500). Lutfen sistem yoneticinize haber verin.';\n      setApiError(message);\n      toast.error('Urunler yuklenirken hata olustu');\n      console.error('Error loading products:', error);\n    } finally {\n      setLoading(false);\n    }\n  }, [page, selectedBrand, searchTerm, filterProductType, filterColor, filterSizeRange, filterIncomplete, filterHasSecondProduct]);\n\n  const loadBrands = useCallback(async () => {\n    try {\n      // ✅ Sadece ürünü olan markaları getir\n      const response = await brandsAPI.getBrandsWithProducts();\n      setBrands(response.brands);\n      \n      // ✅ Otomatik marka seçme - kullanıcı manuel seçsin\n      // İlk yüklemede tüm ürünleri göster\n    } catch (error: any) {\n      toast.error('Markalar yüklenirken hata oluştu');\n      console.error('Error loading brands:', error);\n    }\n  }, []);\n\n  const loadFilterOptions = useCallback(async () => {\n    try {\n      const options = await productsAPI.getFilterOptions();\n      setFilterOptions(options);\n    } catch (error: any) {\n      console.error('Error loading filter options:', error);\n      setApiError(prev => prev ?? 'Filtre se�enekleri sunucudan alinamadi. Lutfen sistem yoneticinize haber verin.');\n    }\n  }, []);\n\n  const handleRetry = useCallback(() => {\n    setApiError(null);\n    loadBrands();\n    loadFilterOptions();\n    refreshProducts();\n  }, [loadBrands, loadFilterOptions, refreshProducts]);\n\n  // Upload settings yükle\n  useEffect(() => {\n    loadUploadSettings();\n    checkForUploadRecovery();\n  }, [loadUploadSettings]);\n\n  // Upload recovery system\n  const checkForUploadRecovery = useCallback(() => {\n    const savedUploadJob = localStorage.getItem('uploadJobId');\n    const savedUploadProgress = localStorage.getItem('uploadProgress');\n    \n    if (savedUploadJob && savedUploadProgress) {\n      setUploadRecovery({\n        isRecovering: true,\n        jobId: savedUploadJob,\n        progress: parseInt(savedUploadProgress)\n      });\n      \n      // Resume upload monitoring\n      resumeUploadMonitoring(savedUploadJob);\n    }\n  }, []);\n\n  const resumeUploadMonitoring = useCallback(async (jobId: string) => {\n    try {\n      setUploading(true);\n      setUploadProgress(parseInt(localStorage.getItem('uploadProgress') || '0'));\n      setUploadStatus('Yükleme devam ediyor...');\n      \n      // Start polling for upload status\n      const interval = setInterval(async () => {\n        try {\n          const response = await fetch(`/api/upload/status/${jobId}`);\n          const data = await response.json();\n          \n          if (data.status === 'completed') {\n            clearInterval(interval);\n            setUploading(false);\n            setUploadProgress(100);\n            setUploadStatus('Yükleme tamamlandı!');\n            \n            // Clear recovery data\n            localStorage.removeItem('uploadJobId');\n            localStorage.removeItem('uploadProgress');\n            setUploadRecovery({ isRecovering: false, jobId: null, progress: 0 });\n            \n            // Reload products\n            window.location.reload(); // Simple reload for now\n            toast.success('Yükleme başarıyla tamamlandı!');\n          } else if (data.status === 'failed') {\n            clearInterval(interval);\n            setUploading(false);\n            setUploadStatus('Yükleme başarısız!');\n            \n            // Clear recovery data\n            localStorage.removeItem('uploadJobId');\n            localStorage.removeItem('uploadProgress');\n            setUploadRecovery({ isRecovering: false, jobId: null, progress: 0 });\n            \n            toast.error('Yükleme başarısız oldu!');\n          } else if (data.progress) {\n            setUploadProgress(data.progress);\n            localStorage.setItem('uploadProgress', data.progress.toString());\n          }\n        } catch (error) {\n          console.error('Upload status check error:', error);\n        }\n      }, 2000);\n      \n    } catch (error) {\n      console.error('Upload recovery error:', error);\n      setUploadRecovery({ isRecovering: false, jobId: null, progress: 0 });\n    }\n  }, []);\n\n  const cancelUploadRecovery = useCallback(() => {\n    localStorage.removeItem('uploadJobId');\n    localStorage.removeItem('uploadProgress');\n    setUploadRecovery({ isRecovering: false, jobId: null, progress: 0 });\n    setUploading(false);\n    setUploadProgress(0);\n    setUploadStatus('');\n  }, []);\n\n  // Cleanup polling on unmount\n  useEffect(() => {\n    return () => {\n      setPollingActive(false);\n      pollingActiveRef.current = false;\n    };\n  }, []);\n\n  useEffect(() => {\n    const fetchProducts = async () => {\n      try {\n        setLoading(true);\n\n        // Filtreleri backend'e g�nder (sadece dolu olanlar�)\n        const filters: any = {};\n        if (filterProductType.length > 0) filters.product_type = filterProductType;\n        if (filterColor.length > 0) filters.color = filterColor;\n        if (filterSizeRange.length > 0) filters.size_range = filterSizeRange;\n        // Price filters removed\n        if (filterIncomplete) filters.incomplete = true;\n        if (filterComplete) filters.complete = true;\n        if (filterHasSecondProduct) filters.has_second_product = true;\n\n        // Backend'den filtrelenmi� �r�nleri al\n        const response = await productsAPI.getProducts(\n          page,\n          20,\n          selectedBrand || undefined,\n          searchTerm || undefined,\n          Object.keys(filters).length > 0 ? filters : undefined\n        );\n\n        // UNKNOWN ve DEFAULT de�erlerini frontend'de de filtrele\n        const filteredProducts = response.products.filter(product =>\n          product.code !== 'UNKNOWN' &&\n          product.code !== 'DEFAULT_CODE' &&\n          product.color !== 'UNKNOWN' &&\n          product.color !== 'DEFAULT'\n        );\n\n        setProducts(filteredProducts);\n        setTotalPages(response.total_pages);\n        setApiError(null);\n      } catch (error: any) {\n        const detail = error?.response?.data?.detail;\n        const message = detail && typeof detail === 'string'\n          ? detail\n          : 'Urun listesi sunucudan alinirken bir hata olustu (HTTP 500). Lutfen sistem yoneticinize haber verin.';\n        setApiError(message);\n        toast.error('Urunler yuklenirken hata olustu');\n        console.error('Error loading products:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n    \n    // Sayfa değişikliklerinde direkt yükle\n    if (page !== 1) {\n      fetchProducts();\n      return;\n    }\n    \n    // Arama veya filtreler için debounce uygula\n    if (searchTimerRef.current) {\n      clearTimeout(searchTimerRef.current);\n    }\n    searchTimerRef.current = setTimeout(() => {\n      fetchProducts();\n    }, 500); // 500ms delay - kullanıcı yazmayı bitirince arama yap\n    \n    return () => {\n      if (searchTimerRef.current) {\n        clearTimeout(searchTimerRef.current);\n      }\n    };\n  }, [page, searchTerm, filterProductType, filterColor, filterSizeRange, filterIncomplete, filterHasSecondProduct, selectedBrand]);\n\n  useEffect(() => {\n    loadBrands();\n    loadFilterOptions();\n  }, [loadBrands, loadFilterOptions]);\n\n  const validateFiles = (files: File[]): { valid: boolean; message?: string; validFiles: File[] } => {\n    // Dosya sayısı kontrolü\n    if (files.length > uploadLimit) {\n      return {\n        valid: false,\n        message: `Maksimum ${uploadLimit} dosya seçebilirsiniz. ${files.length} dosya seçtiniz. İlk ${uploadLimit} dosya kabul edilecek.`,\n        validFiles: files.slice(0, uploadLimit)\n      };\n    }\n\n    // Dosya boyutu kontrolü\n    const oversizedFiles: string[] = [];\n    const validFiles: File[] = [];\n    let totalSizeMB = 0;\n\n    for (const file of files) {\n      const fileSizeMB = file.size / (1024 * 1024);\n      \n      if (fileSizeMB > maxFileSizeMB) {\n        oversizedFiles.push(`${file.name} (${fileSizeMB.toFixed(2)} MB)`);\n      } else {\n        validFiles.push(file);\n        totalSizeMB += fileSizeMB;\n      }\n    }\n\n    if (oversizedFiles.length > 0) {\n      return {\n        valid: false,\n        message: `Bazı dosyalar çok büyük (maksimum ${maxFileSizeMB} MB):\\n${oversizedFiles.join('\\n')}\\n\\nBu dosyalar yüklenmeyecek.`,\n        validFiles\n      };\n    }\n\n    // Toplam boyut kontrolü\n    if (totalSizeMB > totalUploadSizeMB) {\n      return {\n        valid: false,\n        message: `Toplam dosya boyutu çok büyük: ${totalSizeMB.toFixed(2)} MB. Maksimum: ${totalUploadSizeMB} MB. Lütfen daha az dosya seçin.`,\n        validFiles: []\n      };\n    }\n\n    return { valid: true, validFiles };\n  };\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const files = Array.from(event.target.files || []);\n    \n    const validation = validateFiles(files);\n    \n    if (!validation.valid) {\n      toast.error(validation.message || 'Dosya seçimi geçersiz');\n      if (validation.validFiles.length > 0) {\n        setSelectedFiles(validation.validFiles);\n        setShowUploadModal(true);\n      }\n      return;\n    }\n    \n    setSelectedFiles(validation.validFiles);\n    setShowUploadModal(true);\n  };\n\n  const handleUpload = async () => {\n    if (!selectedFiles.length) {\n      notificationService.error('Lütfen yüklenecek dosyaları seçin');\n      return;\n    }\n\n    try {\n      setUploading(true);\n      setUploadProgress(0);\n      setUploadStatus(`${selectedFiles.length} dosya yükleniyor...`);\n      \n      // Start upload and get job ID\n      const response = await productsAPI.uploadProductImages(selectedFiles);\n      \n      if (response.job_id) {\n        // Save job ID for recovery\n        localStorage.setItem('uploadJobId', response.job_id.toString());\n        localStorage.setItem('uploadProgress', '0');\n        \n        setUploadJobId(response.job_id.toString());\n        setPollingActive(true);\n        pollingActiveRef.current = true;\n        // Poll for progress using job ID\n        const pollProgress = async () => {\n          // Check polling state at the start of each poll\n          if (!pollingActiveRef.current) return; // Stop polling if flag is false\n          \n          try {\n            const statusResponse = await productsAPI.getUploadJobStatus(response.job_id!);\n            const { status, processed_files, total_files, failed_files } = statusResponse;\n            \n            // Calculate progress percentage\n            const progressPercent = total_files > 0 ? Math.round((processed_files / total_files) * 100) : 0;\n            setUploadProgress(progressPercent);\n            \n            if (status === 'completed') {\n              setUploadStatus(`Yükleme tamamlandı! ${processed_files} dosya işlendi`);\n              setPollingActive(false); // Stop polling\n              pollingActiveRef.current = false;\n              \n              // Clear recovery data\n              localStorage.removeItem('uploadJobId');\n              localStorage.removeItem('uploadProgress');\n              setUploadJobId(null);\n              \n              // Handle results\n              if (response.incomplete_products && response.incomplete_products.length > 0) {\n                setIncompleteProducts(response.incomplete_products);\n                setShowMissingFieldsModal(true);\n                setShowUploadModal(false);\n                notificationService.warning(`Kısmi başarı: ${response.products_created} ürün oluşturuldu, ${response.incomplete_products.length} ürün eksik bilgi nedeniyle oluşturulamadı`);\n              } else {\n                notificationService.success(`${response.products_created} ürün başarıyla oluşturuldu`);\n                setSelectedFiles([]);\n                setShowUploadModal(false);\n                refreshProducts(); // Listeyi yenile\n              }\n              setUploading(false);\n            } else if (status === 'failed') {\n              setUploadStatus('Yükleme başarısız oldu');\n              setPollingActive(false); // Stop polling\n              pollingActiveRef.current = false;\n              \n              // Clear recovery data\n              localStorage.removeItem('uploadJobId');\n              localStorage.removeItem('uploadProgress');\n              setUploadJobId(null);\n              \n              notificationService.error('Yükleme işlemi başarısız oldu');\n              setUploading(false);\n            } else {\n              // Still processing, update status and continue polling\n              setUploadStatus(`${processed_files}/${total_files} dosya işlendi (${failed_files} hata)`);\n              if (pollingActiveRef.current) {\n                setTimeout(pollProgress, 2000); // Poll every 2 seconds\n              }\n            }\n          } catch (error) {\n            console.error('Progress polling error:', error);\n            setUploadStatus('Yükleme durumu kontrol edilemiyor');\n            if (pollingActiveRef.current) {\n              setTimeout(pollProgress, 5000); // Retry after 5 seconds\n            }\n          }\n        };\n        \n        // Start polling\n        pollProgress();\n      } else {\n        // Fallback for immediate response (no job ID)\n        setUploadProgress(100);\n        setUploadStatus('Yükleme tamamlandı!');\n        \n        if (response.success) {\n          if (response.incomplete_products && response.incomplete_products.length > 0) {\n            setIncompleteProducts(response.incomplete_products);\n            setShowMissingFieldsModal(true);\n            setShowUploadModal(false);\n            notificationService.warning(`Kısmi başarı: ${response.products_created} ürün oluşturuldu, ${response.incomplete_products.length} ürün eksik bilgi nedeniyle oluşturulamadı`);\n          } else {\n            notificationService.success(`${response.products_created} ürün başarıyla oluşturuldu`);\n            setSelectedFiles([]);\n            setShowUploadModal(false);\n            refreshProducts();\n          }\n        } else {\n          notificationService.error('Bilinmeyen hata oluştu');\n        }\n        setUploading(false);\n      }\n    } catch (error: any) {\n      const errorMsg = error.response?.data?.detail || 'Bilinmeyen hata';\n      notificationService.custom(errorMsg, 'error' as any, 5000);\n      console.error('Upload error:', error);\n      setUploading(false);\n      setUploadProgress(0);\n      setUploadStatus('');\n      setPollingActive(false); // Stop polling on error\n      pollingActiveRef.current = false;\n    }\n  };\n\n\n\n  const clearAllFilters = () => {\n    setFilterProductType([]);\n    setFilterColor([]);\n    setFilterSizeRange([]);\n    setFilterIncomplete(false);\n    setFilterComplete(false);\n    setFilterHasSecondProduct(false);\n    setSearchTerm('');\n    setPage(1);\n  };\n\n\n  const handleCompleteMissingFields = async (completionData: Array<{\n    product_id: number;\n    product_type?: string;\n    size_range?: string;\n    price?: number;\n  }>) => {\n    try {\n      const response = await productsAPI.completeProductsBulk(completionData);\n      if (response.success) {\n        toast.success(`${response.updated_count} ürün bilgileri tamamlandı`);\n        setShowMissingFieldsModal(false);\n        setIncompleteProducts([]);\n        refreshProducts(); // Listeyi yenile\n      } else {\n        toast.error('Bilgi tamamlama başarısız');\n      }\n    } catch (error: any) {\n      toast.error('Bilgi tamamlama sırasında hata oluştu');\n      console.error('Complete error:', error);\n    }\n  };\n\n  const getProductStatusIcon = (product: Product) => {\n    if (product.is_processed) {\n      return <CheckCircle className=\"w-4 h-4 text-green-500\" />;\n    } else {\n      return null; // No icon for unprocessed products\n    }\n  };\n\n  const getProductStatusText = (product: Product) => {\n    if (product.is_processed) {\n      return 'Hazır';\n    } else {\n      return 'İşleniyor';\n    }\n  };\n\n  const getCoverImage = (product: Product): ProductImage | null => {\n    const images = product.images || [];\n    \n    // SADECE ETİKET OLMAYAN GÖRSELLERİ AL\n    const nonTagImages = images.filter(img => {\n      // Etiket görsellerini kesinlikle hariç tut\n      if (img.image_type === 'tag' || img.image_type === 'collage') return false;\n      \n      const filename = img.filename || img.original_filename || '';\n      \n      // Dosya adında 'tag' veya 'etiket' varsa hariç tut\n      if (/tag|etiket/i.test(filename)) return false;\n      \n      // Dosya adında sayı OLMAYAN dosyalar etiket olabilir - hariç tut\n      if (!/\\d+\\.(jpg|jpeg|png)$/i.test(filename)) return false;\n      \n      return true;\n    });\n    \n    if (nonTagImages.length === 0) {\n      return null;\n    }\n    \n    // EN KÜÇÜK SAYILI GÖRSELİ BUL (COVER OLSUN OLMASIN)\n    const sortedByNumber = [...nonTagImages].sort((a, b) => {\n      const filenameA = a.filename || a.original_filename || '';\n      const filenameB = b.filename || b.original_filename || '';\n      \n      // Dosya adından sayıyı çıkar\n      const matchA = filenameA.match(/(\\d+)\\.(jpg|jpeg|png)$/i);\n      const matchB = filenameB.match(/(\\d+)\\.(jpg|jpeg|png)$/i);\n      \n      const numberA = matchA ? parseInt(matchA[1]) : 999999;\n      const numberB = matchB ? parseInt(matchB[1]) : 999999;\n      \n      return numberA - numberB;\n    });\n    \n    // EN KÜÇÜK SAYILI OLANINI DÖN\n    return sortedByNumber[0] || null;\n  };\n\n  if (apiError) {\n    return (\n      <div className=\"flex flex-col items-center justify-center min-h-screen px-6 text-center space-y-4\">\n        <AlertCircle className=\"w-12 h-12 text-red-500\" />\n        <div className=\"space-y-2\">\n          <h2 className=\"text-xl font-semibold text-gray-800\">Veriler yuklenemedi</h2>\n          <p className=\"text-gray-600 max-w-xl\">{apiError}</p>\n        </div>\n        <button\n          onClick={handleRetry}\n          className=\"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors\"\n        >\n          Tekrar dene\n        </button>\n      </div>\n    );\n  }\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"flex items-center gap-3\">\n          <div className=\"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin\"></div>\n          <span className=\"text-gray-600\">Medya galerisi yükleniyor...</span>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Upload Recovery Banner */}\n      {uploadRecovery.isRecovering && (\n        <div className=\"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4\">\n          <div className=\"flex items-start gap-3\">\n            <div className=\"p-2 bg-blue-100 rounded-full\">\n              <RefreshCw className=\"w-5 h-5 text-blue-600 animate-spin\" />\n            </div>\n            <div className=\"flex-1\">\n              <h3 className=\"font-semibold text-blue-800 mb-1\">Yükleme Devam Ediyor</h3>\n              <p className=\"text-blue-700 text-sm mb-3\">\n                Önceki yükleme işlemi devam ediyor. İşlem tamamlanana kadar bekleyin.\n              </p>\n              <div className=\"flex items-center gap-4\">\n                <div className=\"flex-1 bg-blue-200 rounded-full h-2\">\n                  <div \n                    className=\"bg-blue-600 h-2 rounded-full transition-all duration-300\"\n                    style={{ width: `${uploadRecovery.progress}%` }}\n                  ></div>\n                </div>\n                <span className=\"text-sm font-medium text-blue-800\">{uploadRecovery.progress}%</span>\n                <button\n                  onClick={cancelUploadRecovery}\n                  className=\"btn btn-sm btn-ghost text-blue-600 hover:text-blue-800\"\n                >\n                  İptal Et\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Bilgilendirme Mesajı - Temiz Modern Tasarım */}\n      <div className=\"bg-gradient-to-r from-slate-50 to-blue-50 border border-slate-200 rounded-lg p-5\">\n        <div className=\"flex items-start gap-4\">\n          {/* İkon */}\n          <div className=\"flex-shrink-0 pt-0.5\">\n            <div className=\"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center\">\n              <AlertCircle className=\"w-5 h-5 text-blue-600\" />\n            </div>\n          </div>\n          \n          {/* İçerik */}\n          <div className=\"flex-1\">\n            <h3 className=\"text-sm font-semibold text-gray-900 mb-1\">Depolama Bilgisi</h3>\n            <p className=\"text-sm text-gray-600 leading-relaxed\">\n              Ürün görselleri ve kolajlar <span className=\"font-medium text-gray-900\">24 saat</span> boyunca ücretsiz olarak saklanmaktadır. Daha uzun süre depolama için premium paketlerimizi inceleyebilirsiniz.\n            </p>\n          </div>\n          \n          {/* Buton */}\n          <div className=\"flex-shrink-0\">\n            <button className=\"px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white text-xs font-medium rounded transition-colors duration-200\">\n              Premium\n            </button>\n          </div>\n        </div>\n      </div>\n\n      {/* Header */}\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-gray-900\">Ürünler</h1>\n          <p className=\"text-gray-600\">Ürün görsellerini yönetin ve AI ile işleyin</p>\n        </div>\n        \n        <div className=\"flex items-center gap-3\">\n          <button\n            onClick={() => document.getElementById('file-upload')?.click()}\n            className=\"btn btn-primary flex items-center gap-2\"\n          >\n            <Upload size={18} />\n            Görsel Yükle\n          </button>\n          \n          <input\n            id=\"file-upload\"\n            type=\"file\"\n            multiple\n            accept=\"image/*\"\n            onChange={handleFileSelect}\n            className=\"hidden\"\n          />\n        </div>\n      </div>\n\n      {/* Filters */}\n      <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-4\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-sm font-semibold text-gray-700\">Arama & Filtreleme</h3>\n          <div className=\"flex items-center gap-2\">\n            <button\n              onClick={() => setShowFilters(!showFilters)}\n              className={`flex items-center gap-2 px-3 py-1.5 text-sm rounded-lg transition-colors ${\n                showFilters ? 'bg-blue-100 text-blue-700' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n              }`}\n            >\n              <Filter size={16} />\n              {showFilters ? 'Filtreleri Gizle' : 'Gelişmiş Filtreler'}\n            </button>\n            {(filterProductType.length > 0 || filterColor.length > 0 || filterSizeRange.length > 0 || filterIncomplete || filterComplete || filterHasSecondProduct) && (\n              <button\n                onClick={clearAllFilters}\n                className=\"flex items-center gap-2 px-3 py-1.5 text-sm bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors\"\n              >\n                <X size={16} />\n                Tümünü Temizle\n              </button>\n            )}\n          </div>\n        </div>\n        \n        <div className=\"grid grid-cols-1 md:grid-cols-5 gap-3\">\n          {/* Search - Ürün Kodu ve Ürün Adı */}\n          <div className=\"relative md:col-span-2\">\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400\" size={16} />\n            <input\n              type=\"text\"\n              placeholder=\"Ürün ara...\"\n              value={searchTerm}\n              onChange={(e) => { setSearchTerm(e.target.value); setPage(1); }}\n              className=\"w-full pl-9 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            />\n          </div>\n\n          {/* Brand Filter */}\n          <select\n            value={selectedBrand || ''}\n            onChange={(e) => { setSelectedBrand(Number(e.target.value) || null); setPage(1); }}\n            className=\"px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n          >\n            <option value=\"\">Tüm Markalar</option>\n            {brands.map(brand => (\n              <option key={brand.id} value={brand.id}>\n                {brand.name}\n              </option>\n            ))}\n          </select>\n\n          {/* View Mode & Refresh Combined */}\n          <div className=\"flex items-center gap-2\">\n            <button\n              onClick={() => setViewMode('grid')}\n              className={`p-2 rounded-lg ${viewMode === 'grid' ? 'bg-blue-100 text-blue-600' : 'text-gray-400 hover:text-gray-600'}`}\n              title=\"Grid görünüm\"\n            >\n              <Grid size={16} />\n            </button>\n            <button\n              onClick={() => setViewMode('list')}\n              className={`p-2 rounded-lg ${viewMode === 'list' ? 'bg-blue-100 text-blue-600' : 'text-gray-400 hover:text-gray-600'}`}\n              title=\"Liste görünüm\"\n            >\n              <List size={16} />\n            </button>\n            <button\n              onClick={refreshProducts}\n              className=\"p-2 rounded-lg text-gray-600 hover:bg-gray-100\"\n              title=\"Yenile\"\n            >\n              <RefreshCw size={16} />\n            </button>\n          </div>\n        </div>\n        \n        {/* Gelişmiş Filtreler */}\n        {showFilters && (\n          <div className=\"mt-4 pt-4 border-t border-gray-200\">\n            <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n              {/* Ürün Tipi */}\n              <div>\n                <label className=\"block text-xs font-medium text-gray-700 mb-1\">Ürün Tipi</label>\n                <div className=\"max-h-32 overflow-y-auto border border-gray-300 rounded-lg p-2 space-y-1\">\n                  {filterOptions.product_types.map(type => (\n                    <label key={type} className=\"flex items-center space-x-2 text-sm\">\n                      <input\n                        type=\"checkbox\"\n                        checked={filterProductType.includes(type)}\n                        onChange={(e) => {\n                          if (e.target.checked) {\n                            setFilterProductType([...filterProductType, type]);\n                          } else {\n                            setFilterProductType(filterProductType.filter(t => t !== type));\n                          }\n                          setPage(1);\n                        }}\n                        className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                      />\n                      <span>{type}</span>\n                    </label>\n                  ))}\n                </div>\n              </div>\n              \n              {/* Renk */}\n              <div>\n                <label className=\"block text-xs font-medium text-gray-700 mb-1\">Renk</label>\n                <div className=\"max-h-32 overflow-y-auto border border-gray-300 rounded-lg p-2 space-y-1\">\n                  {filterOptions.colors.map(color => (\n                    <label key={color} className=\"flex items-center space-x-2 text-sm\">\n                      <input\n                        type=\"checkbox\"\n                        checked={filterColor.includes(color)}\n                        onChange={(e) => {\n                          if (e.target.checked) {\n                            setFilterColor([...filterColor, color]);\n                          } else {\n                            setFilterColor(filterColor.filter(c => c !== color));\n                          }\n                          setPage(1);\n                        }}\n                        className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                      />\n                      <span>{color}</span>\n                    </label>\n                  ))}\n                </div>\n              </div>\n              \n              {/* Beden */}\n              <div>\n                <label className=\"block text-xs font-medium text-gray-700 mb-1\">Beden</label>\n                <div className=\"max-h-32 overflow-y-auto border border-gray-300 rounded-lg p-2 space-y-1\">\n                  {filterOptions.size_ranges.map(size => (\n                    <label key={size} className=\"flex items-center space-x-2 text-sm\">\n                      <input\n                        type=\"checkbox\"\n                        checked={filterSizeRange.includes(size)}\n                        onChange={(e) => {\n                          if (e.target.checked) {\n                            setFilterSizeRange([...filterSizeRange, size]);\n                          } else {\n                            setFilterSizeRange(filterSizeRange.filter(s => s !== size));\n                          }\n                          setPage(1);\n                        }}\n                        className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                      />\n                      <span>{size}</span>\n                    </label>\n                  ))}\n                </div>\n              </div>\n              \n              {/* Price filters removed */}\n              \n              {/* Özel Filtreler */}\n              <div className=\"flex flex-col gap-2\">\n                <label className=\"flex items-center gap-2 text-sm text-gray-700 cursor-pointer\">\n                  <input\n                    type=\"checkbox\"\n                    checked={filterIncomplete}\n                    onChange={(e) => { setFilterIncomplete(e.target.checked); setPage(1); }}\n                    className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                  />\n                  <span>Eksik Bilgiler</span>\n                </label>\n                <label className=\"flex items-center gap-2 text-sm text-gray-700 cursor-pointer\">\n                  <input\n                    type=\"checkbox\"\n                    checked={filterComplete}\n                    onChange={(e) => { setFilterComplete(e.target.checked); setPage(1); }}\n                    className=\"rounded border-gray-300 text-green-600 focus:ring-green-500\"\n                  />\n                  <span>Tam Bilgiler</span>\n                </label>\n                <label className=\"flex items-center gap-2 text-sm text-gray-700 cursor-pointer\">\n                  <input\n                    type=\"checkbox\"\n                    checked={filterHasSecondProduct}\n                    onChange={(e) => { setFilterHasSecondProduct(e.target.checked); setPage(1); }}\n                    className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                  />\n                  <span>Çift Ürün</span>\n                </label>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Products Grid/List */}\n      {products.length === 0 ? (\n        <div className=\"text-center py-12\">\n          <ImageIcon className=\"w-16 h-16 text-gray-300 mx-auto mb-4\" />\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">Henüz ürün yok</h3>\n          <p className=\"text-gray-600 mb-4\">İlk ürün görsellerinizi yükleyerek başlayın</p>\n          <button\n            onClick={() => document.getElementById('file-upload')?.click()}\n            className=\"btn btn-primary\"\n          >\n            <Plus size={18} className=\"mr-2\" />\n            Görsel Yükle\n          </button>\n        </div>\n      ) : (\n        <div className={viewMode === 'grid' ? 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 2xl:grid-cols-4 gap-6' : 'space-y-4'}>\n          {products.map((product) => {\n            const coverImage = getCoverImage(product);\n            \n            return (\n              <div\n                key={product.id}\n                className={`bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow ${\n                  viewMode === 'list' ? 'flex' : ''\n                }`}\n              >\n                {/* Product Image */}\n                <div className={`${viewMode === 'list' ? 'w-48 h-48 flex-shrink-0' : 'h-64'} bg-gray-100 relative overflow-hidden`}>\n                  {coverImage ? (\n                    <img\n                      src={getImageURL(coverImage.file_path)}\n                      alt={product.name}\n                      className=\"w-full h-full object-contain bg-white\"\n                      loading=\"lazy\"\n                      onError={(e) => {\n                        (e.target as HTMLImageElement).src = 'data:image/svg+xml,%3Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"100\" height=\"100\"%3E%3Crect fill=\"%23f3f4f6\" width=\"100\" height=\"100\"/%3E%3Ctext x=\"50%25\" y=\"50%25\" text-anchor=\"middle\" dy=\".3em\" fill=\"%239ca3af\"%3ENo Image%3C/text%3E%3C/svg%3E';\n                      }}\n                    />\n                  ) : (\n                    <div className=\"w-full h-full flex items-center justify-center\">\n                      <ImageIcon className=\"w-8 h-8 text-gray-400\" />\n                    </div>\n                  )}\n                </div>\n\n                {/* Product Info */}\n                <div className={`p-4 ${viewMode === 'list' ? 'flex-1' : ''}`}>\n                  <div className=\"flex items-start justify-between mb-2\">\n                    <div className=\"flex-1 min-w-0\">\n                      {/* Marka Adı */}\n                      <p className=\"text-xs font-semibold text-blue-600 mb-1 truncate\" title={product.brand_name || product.brand?.name}>\n                        {product.brand_name || product.brand?.name || 'Marka Yok'}\n                      </p>\n                      {/* Ürün Kodu */}\n                      <h3 className=\"font-medium text-gray-900 truncate\" title={product.code}>\n                        {product.code.length > 20 ? `${product.code.substring(0, 20)}...` : product.code}\n                      </h3>\n                      {/* Renk */}\n                      <p className=\"text-sm text-gray-600 truncate\" title={product.color}>\n                        {product.color && product.color.length > 15 ? `${product.color.substring(0, 15)}...` : product.color}\n                      </p>\n                    </div>\n                    {getProductStatusIcon(product)}\n                  </div>\n\n                  <div className=\"flex items-center justify-between text-sm text-gray-500 mb-3\">\n                    <span>{(product.images || []).length} görsel</span>\n                    <span>{getProductStatusText(product)}</span>\n                  </div>\n\n                  {/* VIEW MODE */}\n                  <div className=\"space-y-1.5 mb-3\">\n                    <div className={`text-sm ${!product.product_type ? 'text-red-500 font-medium' : 'text-gray-600'}`}>\n                      <span className=\"font-medium text-gray-700\">Tip:</span> {product.product_type || '❌ Eksik'}\n                    </div>\n                    <div className={`text-sm ${!product.size_range ? 'text-red-500 font-medium' : 'text-gray-600'}`}>\n                      <span className=\"font-medium text-gray-700\">Beden:</span> {product.size_range || '❌ Eksik'}\n                    </div>\n                    <div className={`text-sm ${!product.price ? 'text-red-500 font-medium' : 'text-gray-600'}`}>\n                      <span className=\"font-medium text-gray-700\">Fiyat:</span> {product.price ? `$${product.price}` : '❌ Eksik'}\n                    </div>\n                  </div>\n\n                  {/* Actions */}\n                  <div className=\"flex items-center gap-2\">\n                    <button\n                      onClick={() => window.location.href = `/admin/products/${product.id}`}\n                      className=\"btn btn-sm btn-secondary flex items-center gap-1\"\n                    >\n                      <Eye size={14} />\n                      Detay\n                    </button>\n                  </div>\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      )}\n\n      {/* Pagination */}\n      {totalPages > 1 && (\n        <div className=\"flex justify-center\">\n          <div className=\"flex items-center gap-2\">\n            <button\n              onClick={() => setPage(Math.max(1, page - 1))}\n              disabled={page === 1}\n              className=\"btn btn-sm btn-secondary\"\n            >\n              Önceki\n            </button>\n            \n            <span className=\"text-sm text-gray-600\">\n              Sayfa {page} / {totalPages}\n            </span>\n            \n            <button\n              onClick={() => setPage(Math.min(totalPages, page + 1))}\n              disabled={page === totalPages}\n              className=\"btn btn-sm btn-secondary\"\n            >\n              Sonraki\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* Upload Modal */}\n      {showUploadModal && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white rounded-lg p-6 w-full max-w-md\">\n            <h3 className=\"text-lg font-medium text-gray-900 mb-4\">Görsel Yükle</h3>\n            \n            {/* Limit Bilgileri */}\n            <div className=\"mb-4 p-3 bg-blue-50 rounded-lg\">\n              <h4 className=\"text-sm font-medium text-blue-900 mb-2\">Yükleme Limitleri:</h4>\n              <div className=\"text-xs text-blue-700 space-y-1\">\n                <div>• Maksimum dosya sayısı: {uploadLimit} <span className=\"text-green-600\">⚡</span></div>\n                <div>• Maksimum dosya boyutu: {maxFileSizeMB} MB <span className=\"text-green-600\">⚡</span></div>\n                <div>• Toplam yükleme boyutu: {totalUploadSizeMB} MB <span className=\"text-green-600\">⚡</span></div>\n                <div className=\"text-green-600 font-medium mt-2\">🚀 Optimize edilmiş performans!</div>\n              </div>\n            </div>\n            \n            {/* Marka seçimi kaldırıldı - otomatik tespit edilecek */}\n            <div className=\"mb-4 p-3 bg-green-50 rounded-lg\">\n              <div className=\"flex items-start gap-2\">\n                <div className=\"text-green-600\">ℹ️</div>\n                <div className=\"text-sm text-green-800\">\n                  <p className=\"font-medium\">Otomatik Marka Tespiti</p>\n                  <p className=\"mt-1\">\n                    Marka bilgisi etiketlerden otomatik olarak tespit edilecek. \n                    Sadece yetkili olduğunuz markalar yüklenecek.\n                  </p>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"mb-4\">\n              <p className=\"text-sm text-gray-600 mb-2\">\n                {selectedFiles.length} dosya seçildi\n                {(() => {\n                  const totalSizeMB = selectedFiles.reduce((sum, file) => sum + file.size / (1024 * 1024), 0);\n                  return (\n                    <span className=\"text-gray-500\">\n                      {' '}(Toplam: {totalSizeMB.toFixed(2)} MB)\n                    </span>\n                  );\n                })()}\n              </p>\n              <div className=\"max-h-32 overflow-y-auto border border-gray-200 rounded-lg p-2\">\n                {selectedFiles.slice(0, 10).map((file, index) => {\n                  const fileSizeMB = file.size / (1024 * 1024);\n                  const isOversized = fileSizeMB > maxFileSizeMB;\n                  return (\n                    <div key={index} className={`text-xs truncate ${isOversized ? 'text-red-600' : 'text-gray-500'}`}>\n                      {file.name} ({fileSizeMB.toFixed(2)} MB)\n                      {isOversized && <span className=\"text-red-600 font-medium\"> - ÇOK BÜYÜK!</span>}\n                    </div>\n                  );\n                })}\n                {selectedFiles.length > 10 && (\n                  <div className=\"text-xs text-gray-400 italic\">\n                    ... ve {selectedFiles.length - 10} dosya daha\n                  </div>\n                )}\n              </div>\n            </div>\n\n            {/* Progress Bar */}\n            {uploading && (\n              <div className=\"mb-4\">\n                <div className=\"flex items-center justify-between mb-2\">\n                  <span className=\"text-sm text-gray-600\">{uploadStatus}</span>\n                  <span className=\"text-sm font-medium text-blue-600\">{uploadProgress}%</span>\n                </div>\n                <div className=\"w-full bg-gray-200 rounded-full h-2.5\">\n                  <div\n                    className=\"bg-blue-600 h-2.5 rounded-full transition-all duration-300\"\n                    style={{ width: `${uploadProgress}%` }}\n                  ></div>\n                </div>\n              </div>\n            )}\n\n            <div className=\"flex justify-end gap-3\">\n              <button\n                onClick={() => setShowUploadModal(false)}\n                className=\"btn btn-secondary\"\n                disabled={uploading}\n              >\n                İptal\n              </button>\n              <button\n                onClick={handleUpload}\n                className=\"btn btn-primary\"\n                disabled={uploading || selectedFiles.length > uploadLimit}\n              >\n                {uploading ? 'Yükleniyor...' : 'Yükle'}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Missing Fields Modal */}\n      {showMissingFieldsModal && (\n        <MissingFieldsModal\n          incompleteProducts={incompleteProducts}\n          onComplete={handleCompleteMissingFields}\n          onCancel={() => {\n            setShowMissingFieldsModal(false);\n            setIncompleteProducts([]);\n          }}\n        />\n      )}\n\n    </div>\n  );\n};\n\nexport default MediaGallery;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}